<html>
<head>
<title>Machine Learning Model Visualization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习模型可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-model-visualization-cc3b46136647?source=collection_archive---------24-----------------------#2021-04-04">https://towardsdatascience.com/machine-learning-model-visualization-cc3b46136647?source=collection_archive---------24-----------------------#2021-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f208" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Shapash使ML模型可解释</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/19465e8f8d4441494f40d13d58a05559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GqnogDpQ_5X1qpCm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卢克·切瑟在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8d89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建机器学习模型是ml工程师的日常任务，他们可以很容易地理解它们并解释它们以获得有用的信息，但对于不属于数据科学领域的人来说，很难理解机器学习模型及其试图表达的内容？</p><p id="2722" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据科学家可以理解模型是关于什么的，但是与其他团队成员或管理层分享结果是困难的。Shapash是一个开源python库，用于创建不同类型的可视化，绕过显式标签，即使是非技术人员也能理解。它用于与最终用户共享模型的结果，最终用户可以通过可视化的方式轻松地解释和理解它们。</p><p id="94a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将通过使用给定的数据集创建一个仪表板来探索Shapash及其特性。</p><p id="1b42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧…</p><h1 id="7047" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装所需的库</h1><p id="4aea" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将从使用pip安装shapash开始，您可以运行下面给出的命令来安装shapash。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="df54" class="mx lw it mt b gy my mz l na nb">pip install shapash</span></pre><h1 id="7729" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">导入所需的库</h1><p id="1d0a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">接下来，我们将导入所有需要的库。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d459" class="mx lw it mt b gy my mz l na nb">import pandas as pd<br/>from category_encoders import OrdinalEncoder<br/>from lightgbm import LGBMClassifier<br/>from sklearn.model_selection import train_test_split</span></pre><h1 id="7d82" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">加载数据和预处理</h1><p id="23d7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将在本文中使用的数据集是著名的Titanic数据集，我们将使用shapash加载它，之后，我们将对数据执行一些预处理。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="af7b" class="mx lw it mt b gy my mz l na nb">from shapash.data.data_loader import data_loading<br/>titanic_df, titanic_dict = data_loading('titanic')<br/>titanic_df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/d8e181cccd541439ed1fb6efe2db37d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tnmY4484TxB6gPnubdyYKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集(来源:作者)</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="dbf4" class="mx lw it mt b gy my mz l na nb">y_df=titanic_df['Survived'].to_frame()<br/>X_df=titanic_df[titanic_df.columns.difference(['Survived'])]</span><span id="c529" class="mx lw it mt b gy nd mz l na nb"># Converting categorical columns to numerical<br/>categorical_features = [col for col in X_df.columns if X_df[col].dtype == 'object']</span><span id="926c" class="mx lw it mt b gy nd mz l na nb">encoder = OrdinalEncoder(<br/>    cols=categorical_features,<br/>    handle_unknown='ignore',<br/>    return_df=True).fit(X_df)</span><span id="8945" class="mx lw it mt b gy nd mz l na nb">X_df=encoder.transform(X_df)</span><span id="e851" class="mx lw it mt b gy nd mz l na nb">#Splitting data into training and testing<br/>Xtrain, Xtest, ytrain, ytest = train_test_split(X_df, y_df, train_size=0.8, random_state=1)</span></pre><h1 id="99b8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建模型</h1><p id="f3fd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对数据进行预处理后，我们将使用LightGBM分类器创建分类模型。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="53f9" class="mx lw it mt b gy my mz l na nb">classifier = LGBMClassifier(n_estimators=200).fit(Xtrain,ytrain)</span></pre><h1 id="1460" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建仪表板应用程序</h1><p id="675e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">下一步也是最后一步是为我们使用的模型和数据集创建应用程序。Shapash使用dash.js创建一个仪表板，并将其用作flask应用程序。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c06b" class="mx lw it mt b gy my mz l na nb">from shapash.explainer.smart_explainer import SmartExplainer<br/>xpl = SmartExplainer(features_dict=titanic_dict)</span><span id="1cb4" class="mx lw it mt b gy nd mz l na nb">xpl.compile(<br/>    x=Xtest,<br/>    model=classifier,<br/>    preprocessing=encoder # Optional: compile step can use inverse_transform method<br/>)</span><span id="9b8a" class="mx lw it mt b gy nd mz l na nb">#Creating Application<br/>app = xpl.run_app(title_story='Titanic Dataset')</span></pre><p id="c2f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这些命令将创建一个仪表板，并显示应用程序运行的URL。复制URL并在你的浏览器中打开它，它将看起来像下面给出的图片。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/8751fd67b908b6417ba489ceede1e6c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2z3Ig7ejhEwDEe7vfa4Tpg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Shapash仪表板(来源:作者)</p></figure><p id="2c37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以看到我们使用shapash创建仪表板是多么容易，在这里我们可以看到不同的可视化效果，我们可以使用它来清楚地解释和理解我们正在使用的机器学习模型。</p><p id="bfb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过展开并全屏观看来浏览所有的可视化效果，以便清楚地理解它们。在这里，您还可以看到我们可以分析两个类，即“0”和“1”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/1cade6389eff5cadf50ab2e82ac7117c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gxo3aULdVEJ4zjBLSW0a_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">专题供稿(来源:作者)</p></figure><p id="2f08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们如何使用shapash来创建机器学习模型的仪表板。继续尝试这个，如果你遇到任何困难，请在回复部分告诉我。</p><p id="91f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">本文与</strong> <a class="ng nh ep" href="https://medium.com/u/40808d551f5a?source=post_page-----cc3b46136647--------------------------------" rel="noopener" target="_blank"> <strong class="lb iu">皮尤什·英格尔</strong> </a> <strong class="lb iu">合作。</strong></p><h1 id="23c0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="5ee3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> <em class="ni">感谢</em> </strong> <em class="ni">的阅读！如果您想与我取得联系，请随时通过hmix13@gmail.com联系我或我的</em> <a class="ae ky" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="ni"> LinkedIn个人资料</em> </strong> </a> <em class="ni">。可以查看我的</em><a class="ae ky" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="ni">Github</em></strong><em class="ni"/></a><em class="ni">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ky" href="https://medium.com/@hmix13" rel="noopener"> <strong class="lb iu"> <em class="ni">我的简介</em> </strong> </a> <em class="ni">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>