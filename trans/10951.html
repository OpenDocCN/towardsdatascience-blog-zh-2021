<html>
<head>
<title>How Baidu Apollo builds HD (High-Definition) maps for autonomous vehicles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">百度Apollo如何为自动驾驶汽车构建高清地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-baidu-apollo-builds-hd-high-definition-maps-for-autonomous-vehicles-167af3a3fea3?source=collection_archive---------17-----------------------#2021-10-25">https://towardsdatascience.com/how-baidu-apollo-builds-hd-high-definition-maps-for-autonomous-vehicles-167af3a3fea3?source=collection_archive---------17-----------------------#2021-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1350" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">5步构建流程，高清地图元素，OpenDRIVE格式</h2></div><p id="4c43" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">高清地图(HD map)是自动驾驶中使用的高度精确的地图。高清地图在包括感知、模拟、定位和路径规划在内的自动驾驶模块中发挥着重要作用。作为地图制作者，百度Apollo是中国领先的自动驾驶平台。在这篇博客中，我们将介绍百度Apollo如何为自动驾驶构建高清地图。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/30d6ae3fda2298215741ea96532b3d6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-p77n23Z7RSKHbgqDruNQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">高清地图[1]</p></figure><ol class=""><li id="a263" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld lz ma mb mc bi translated"><strong class="kk iu">百度Apollo是什么？</strong></li></ol><p id="4df5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">百度Apollo是一个自动驾驶的开放平台。代码可以在<a class="ae md" href="https://github.com/apolloauto" rel="noopener ugc nofollow" target="_blank"> github </a>上公开获得。最初在2017年公布，从v1.0，v1.5，v2.0，…，一直迭代到今天的v6.0。作为一个完整的自动驾驶平台，它包含以下模块:</p><ul class=""><li id="cc4b" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld me ma mb mc bi translated"><a class="ae md" href="https://apollo.auto/platform/perception.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">精准感知</strong> </a>:利用激光雷达、雷达、摄像头探测障碍物和红绿灯。</li><li id="a63b" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated"><a class="ae md" href="https://apollo.auto/platform/simulation.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">模拟</strong> </a>:用真实世界交通和自动驾驶数据虚拟驾驶数百万公里。</li><li id="ed3a" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated"><strong class="kk iu">高清地图</strong>:将传感器和深度学习应用于地图制作。</li><li id="e312" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated"><strong class="kk iu">定位</strong>:利用包括GPS、IMU、高清地图和各种传感器输入在内的全面解决方案，实现厘米级精度。</li><li id="bb84" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated"><strong class="kk iu">规划</strong>:适应实时交通状况，产生既安全又舒适的精确轨迹。</li><li id="650c" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated"><strong class="kk iu">智能控制</strong>:处理不同路况、速度、车型和canbus协议，控制精度约10 cm。</li><li id="65e0" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated"><a class="ae md" href="https://apollo.auto/southbay.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">阿波罗数据集</strong> </a>:包含时间戳激光雷达扫描、相机图像和后处理GPS轨迹。</li></ul><p id="553f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2。百度Apollo如何搭建高清地图？</strong></p><p id="5f9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.1构建流程</strong></p><p id="ec4e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">阿波罗通过5个步骤构建高清地图。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mk"><img src="../Images/52b08fffa9e37f1bb8aaeb5e230fb8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKXMdyrRkZLKl_YKRofHNw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">阿波罗高清地图的构建过程(图片由作者提供)</p></figure><p id="5ba6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">数据来源:</strong>百度Apollo有一支勘测车队行驶在道路上。调查车使用不同的传感器，包括激光雷达、GPS、IMU、天线和相机来收集数据。阿波罗定义了一个硬件框架，将这些传感器集成到一个单一的自治系统中。调查车以正常速度(~60 km/h)行驶在道路上。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ml"><img src="../Images/b3b85f90373be5870696b570bc668d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-SEUzXww8mfSzipNgY2TQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">百度阿波罗Survery汽车(图片来源[2])</p></figure><p id="da86" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">数据处理</strong>:采集的数据包括点云数据和图像数据。Apollo对收集到的数据进行整理、分类、清洗，得到一个没有语义信息和标注的初始地图模板。</p><p id="2250" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">物体检测</strong> : Apollo将深度学习和计算机视觉技术应用于点云和图像，例如，点云分割和分类，以及交通标志/灯、车道线/标志和电线杆的物体检测。</p><p id="5649" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">手动验证</strong>:该步骤是手动纠正之前自动过程中出现的错误标注。例如，车道标志、车道边界、交通灯/标志可能在之前的步骤中被错误地检测到。此外，一些逻辑关系需要手动识别。例如，在交叉路口，可能有多个交通灯。每条车道都需要与正确的交通灯手动关联。</p><p id="fd72" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">地图制作</strong>:高清地图准备在这一步发布。除了高清地图，Apollo还发布了相应的俯视图本地化地图、3D点云地图、路径规划地图、仿真地图。</p><p id="dd5e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于施工、交通事故等原因，道路状况每天都在发生变化。因此，地图发布后需要经常更新。Apollo使用众包和云技术来实现它。<strong class="kk iu">首先</strong>，Apollo按照上面的5个步骤，由测量船队建立一个所谓的“底图”。<strong class="kk iu">然后</strong>，Apollo向公众发布其数据源工具，让公众可以参与高清地图的制作任务。<strong class="kk iu">第三个</strong>，关于道路的更新通过智能手机、普通汽车中的车载智能设备、智能互联汽车，甚至智能自主汽车，传回云端的阿波罗地图制作平台。</p><p id="f9ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">阿波罗地图中的2.2元素</strong></p><p id="e3e3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">道路要素</strong>:道路边界、车道左右边界、车道限速、车道类型、车道拓扑、车道线型、车道方向信息、车道转向类型、车道长度</p><p id="0a4a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">交叉口要素</strong>:交叉口边界、交叉口虚拟车道</p><p id="739f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">交通信号要素</strong>:交通灯、其他道路标志</p><p id="3ced" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">逻辑关系元素</strong>:映射逻辑关系</p><p id="3f98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">其他元素</strong>:人行横道、禁止停车区、停止线、路面箭头、路面文字、围栏、路灯、龙门架、建筑物、减速带</p><p id="0274" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.3阿波罗OpenDRIVE地图格式</strong></p><p id="2e05" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">OpenDRIVE代表车辆环境的开放式动态道路信息。这是一种为描述道路网络提供通用语法的格式，文件扩展名为xodr或xodrz。它将逻辑道路描述标准化，以促进开发和验证adAS和AD功能的不同驾驶模拟器之间的数据交换。</p><p id="9534" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">百度Apollo用的是OpenDRIVE格式的修改版。区别如下。</p><ul class=""><li id="622c" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld me ma mb mc bi translated">Apollo OpenDRIVE使用纬度经度点的简单列表来定义道路边界，而在标准OpenDRIVE中，道路边界是使用五种不同类型的函数通过参考线和偏差来定义的。</li><li id="8d08" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated">阿波罗OpenDRIVE扩展了元素，包括禁止停车区、人行横道和减速区。</li><li id="6b86" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated">Apollo OpenDRIVE增加了车道中心线到道路边界的距离，以及车道和红绿灯之间的逻辑关系。</li><li id="39cc" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated">车道:标准的OpenDRIVE只允许指定车道的宽度。然而，Apollo OpenDRIVE需要点来描述车道边界。此外，Apollo OpenDRIVE需要每个车道的中心点和道路的边界。</li><li id="fe6f" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated">交叉点:Apollo OpenDRIVE使用交叉点的简化版本，忽略了交叉点组、交叉点优先级和交叉点控制器等概念。</li><li id="2fcb" class="lu lv it kk b kl mf ko mg kr mh kv mi kz mj ld me ma mb mc bi translated">对象和信号:Apollo OpenDRIVE使用数量减少的属性，并且只支持有限数量的对象类型。</li></ul><p id="5c51" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2.4坐标系</strong></p><p id="bb2f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">百度Apollo使用两种坐标系:通用横轴墨卡托(UTM)系统和世界大地测量系统(WGS84)。</p><p id="09d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">UTM是一种地图投影系统，用于指定地球表面位置的坐标。它把地球分成60个区域，每个区域的宽度为6经度。要引用一个位置，您需要一个<em class="mm"> x </em>和<em class="mm"> y </em>坐标以及它们所在的区域。</p><p id="25bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">WGS是用于制图、大地测量和卫星导航(包括GPS)的标准。WGS84的坐标原点应该位于地球的质心。它基于描述地球大小、形状、重力和地磁场的一组一致的常数和模型参数。</p><p id="9d1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">参考文献:</strong></p><p id="168e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">【1】uda city免费课程:<a class="ae md" href="https://classroom.udacity.com/courses/ud0419" rel="noopener ugc nofollow" target="_blank">自动驾驶汽车基础:特色阿波罗</a></p><p id="3191" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">【2】<a class="ae md" href="https://www.bilibili.com/video/BV1wq4y1W7mZ?spm_id_from=333.999.0.0" rel="noopener ugc nofollow" target="_blank">百度阿波罗免费课程</a></p><p id="22e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[3]<a class="ae md" href="https://apollo.auto/developer.html" rel="noopener ugc nofollow" target="_blank">https://apollo.auto/developer.html</a></p><p id="d46b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[4] <a class="ae md" href="https://www.ntnu.edu/documents/1284037699/1285579906/Gran-ChristofferWilhelm_2019_Master_NAP_HDMaps.pdf/79ef2eec-c9e2-454b-bf14-08d585cf8826" rel="noopener ugc nofollow" target="_blank">硕士论文:自动驾驶中的高清地图</a></p><p id="ef0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[5] <a class="ae md" href="https://on-demand.gputechconf.com/gtc/2018/presentation/s8902-the-latest-of-project-apollo-and-centralized-in-car-computing-platform-for-autonomous-driving.pdf" rel="noopener ugc nofollow" target="_blank">将自动驾驶商业化</a></p></div></div>    
</body>
</html>