<html>
<head>
<title>Introducing FugueSQL — SQL for Pandas, Spark, and Dask DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍 FugueSQL —用于 Pandas、Spark 和 Dask 数据帧的 SQL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introducing-fuguesql-sql-for-pandas-spark-and-dask-dataframes-63d461a16b27?source=collection_archive---------1-----------------------#2021-12-03">https://towardsdatascience.com/introducing-fuguesql-sql-for-pandas-spark-and-dask-dataframes-63d461a16b27?source=collection_archive---------1-----------------------#2021-12-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="248e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用于数据科学和分析的端到端 SQL 界面</h2></div><h1 id="d342" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">动机</h1><p id="d906" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">作为一名数据科学家，您可能对 Pandas 和 SQL 都很熟悉。然而，可能有一些查询和转换，您会觉得用 SQL 而不是 Python 来做比较舒服。</p><p id="cdb7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果你能像下面这样查询熊猫的数据帧，那不是很好吗？</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/014bae6302e84d72375f3a4a37a66dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:198/format:webp/1*SOzPPt2gt6tzxNuEbmCjmg.png"/></div></figure><p id="e8b3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">…使用 SQL？</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/4897cebcc756d555958996eb00a66c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8AZmZeltjXfW5s6KU633A.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/2114e4afbd0dc4547e36671cd9ec087b.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/1*s8SQ100V-ZzIaUcwgKTqYQ.png"/></div></figure><p id="f764" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">或者在 SQL 查询中使用 Python 函数？</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/358dd653a482a4ceea455a6708c7bb53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-6e2BoG38z-sgVfDJ_RLg.png"/></div></div></figure><p id="31f4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这时，FugueSQL 就派上用场了。</p><h1 id="3dad" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">什么是 FugueSQL？</h1><p id="ce8e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae mv" href="https://fugue-tutorials.readthedocs.io/tutorials/fugue_sql/index.html" rel="noopener ugc nofollow" target="_blank"> FugueSQL </a>是一个 Python 库，允许用户组合 Python 代码和 SQL 命令。这使得用户可以在 Jupyter 笔记本或 Python 脚本中灵活地切换 Python 和 SQL。</p><p id="06e6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">要安装 FugueSQL，请键入:</p><pre class="mb mc md me gt mw mx my mz aw na bi"><span id="bdcc" class="nb kj it mx b gy nc nd l ne nf">pip install fugue[sql]</span></pre><p id="d8aa" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">要在 Spark 或 Dask 执行引擎上运行，请键入:</p><pre class="mb mc md me gt mw mx my mz aw na bi"><span id="e4df" class="nb kj it mx b gy nc nd l ne nf">pip install fugue[sql, spark] <br/>pip install fugue[sql, dask]<br/>pip install fugue[all]</span></pre><p id="a2eb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在本文中，我们将探索 FugueSQL 的一些实用程序，并将 FugueSQL 与 pandasql 等其他工具进行比较。</p><h1 id="d015" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">笔记本中的 FugueSQL</h1><p id="d4ec" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">FugueSQL 附带了一个 Jupyter notebook 扩展，允许用户交互式地查询带有语法高亮显示的数据帧。</p><p id="f527" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">要使用它，从<code class="fe ng nh ni mx b">fugue_notebook</code>导入<code class="fe ng nh ni mx b">setup</code>函数来注册<code class="fe ng nh ni mx b">%%fsql</code>细胞魔法。这目前只在经典笔记本上可用(JupyterLab 上不可用)。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/801296ed3e40eede7179b4e7775accca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IlVnXUNsU65mAxbr4mcqyQ.png"/></div></figure><p id="c72c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为了理解<code class="fe ng nh ni mx b">%%fsql</code>细胞是如何变魔术的，让我们从创建一个熊猫数据框架开始:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/014bae6302e84d72375f3a4a37a66dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:198/format:webp/1*SOzPPt2gt6tzxNuEbmCjmg.png"/></div></figure><p id="2f28" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，您可以像在 SQL 中一样通过在单元格的开头添加<code class="fe ng nh ni mx b">%%fsql</code>来进行查询。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/6187328eb40c234552dd32f771025d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*SXdSZ0Z0ZKJ_BcSn_myHsQ.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/63492c0e52a31358772b6e54c3aacbbe" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><p id="7532" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">上面的代码中，只有<code class="fe ng nh ni mx b">PRINT</code>没有遵循标准 SQL。这类似于 pandas <code class="fe ng nh ni mx b">head()</code>和 Spark <code class="fe ng nh ni mx b">show()</code>操作来显示许多行。</p><p id="13ca" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">像<code class="fe ng nh ni mx b">GROUP BY</code>这样的操作类似于标准的 SQL 语法。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/a0fbe3171708deb74ef80924f6279d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*ot4DLbbAdxK1MeXTkb7K7Q.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/daf5ebc94036a4ad6c0b5b1cf3fd16de" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><h1 id="a21a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">增强的 SQL 界面</h1><p id="aa27" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对于 SQL 用户来说，除了<code class="fe ng nh ni mx b">PRINT</code>语句之外，上面显示的没有什么不寻常的。然而，Fugue 也为标准 SQL 添加了一些增强，允许它优雅地处理端到端的数据工作流。</p><h2 id="ac1f" class="nb kj it bd kk nm nn dn ko no np dp ks lj nq nr ku ln ns nt kw lr nu nv ky nw bi translated">处理临时表</h2><p id="6cf1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">SQL 用户经常不得不使用临时表或公用表表达式(CTE)来保存中间转换。幸运的是，<strong class="lc iu"> FugueSQL 支持通过变量赋值来创建中间表。</strong></p><p id="3379" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">例如，在转换<code class="fe ng nh ni mx b">df</code>之后，我们可以将其赋给另一个名为<code class="fe ng nh ni mx b">df2</code>的变量，并使用<code class="fe ng nh ni mx b">SAVE variable OVERWRITE file_name</code>将<code class="fe ng nh ni mx b">df2</code>保存到一个文件中。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/30c5a3002bacf0997052859b8d4d08f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*ktPEjxb9OU-1QVcNKzVLqw.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/7246f3796d7a8523441f4d7ba253c851" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><p id="9b0c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，如果我们想对<code class="fe ng nh ni mx b">df2</code>应用更多的变换，只需从我们之前保存的文件中加载它。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/0262c3d1e6b7908056724b33295ea92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*RQGAR-RdEGiNrlc6Cv7ydg.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/21d89008b985f5970ca021a8b1d956a6" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><p id="b6c6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">很酷，不是吗？</p><h1 id="c21e" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">添加的关键字</h1><p id="ec48" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">SQL 的语法是为了查询，这意味着它缺少操纵数据的关键字。FugueSQL 为常见的 DataFrame 操作添加了一些关键字。例如:</p><ul class=""><li id="455e" class="ny nz it lc b ld lw lg lx lj oa ln ob lr oc lv od oe of og bi translated">滴</li></ul><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3cac0c564ae63be38ccef09d3716b900.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*z79ybJvoFpdzW6N-HDv4mg.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/4467e4234b3bf3b9167f6b2c8559e787" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><ul class=""><li id="864c" class="ny nz it lc b ld lw lg lx lj oa ln ob lr oc lv od oe of og bi translated">填充空参数</li></ul><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi oi"><img src="../Images/d6ef28c15f1570fc1e9ba307154e1955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r3igR-y2w8tWJ1BxCYVIxQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/8aafb8ddea3deac79fbdf110776836ea" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><ul class=""><li id="388c" class="ny nz it lc b ld lw lg lx lj oa ln ob lr oc lv od oe of og bi translated">样品</li></ul><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/72ec5c4067cae630ebdd4c7062f467b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*TZ6ixAsSItyXSyfX9rPmhQ.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/23df00ab3bc09a1651ca08660194275b" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><p id="233d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">有关操作员的完整列表，请查看<a class="ae mv" href="https://fugue-tutorials.readthedocs.io/tutorials/fugue_sql/operators.html" rel="noopener ugc nofollow" target="_blank"> FugueSQL 操作员文档</a>。</p><h1 id="78e1" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">与 Python 集成</h1><p id="ba95" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">通过使用<code class="fe ng nh ni mx b">TRANSFORM</code>，FugueSQL 还允许您在 SQL 查询中使用 Python 函数。</p><p id="2143" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">例如，要在 SQL 查询中使用函数<code class="fe ng nh ni mx b">str_concat</code>:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="9b09" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">…只需将以下组件添加到功能中:</p><ul class=""><li id="ff96" class="ny nz it lc b ld lw lg lx lj oa ln ob lr oc lv od oe of og bi translated">输出模式提示(作为注释)</li><li id="c0b2" class="ny nz it lc b ld ok lg ol lj om ln on lr oo lv od oe of og bi translated">键入注释(<code class="fe ng nh ni mx b">pd.DataFrame</code>)</li></ul><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="ac69" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">酷！现在我们准备将它添加到 SQL 查询中:</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi op"><img src="../Images/9a31f9cbed2b13e9101ca2c7b30514b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*B4G0qGGgCunTHKsvv1NF5A.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">图片由作者提供—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/74593d3e48f08bfa664ab9c68f12c85a" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><h1 id="478a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">向大数据扩展</h1><h2 id="fb89" class="nb kj it bd kk nm nn dn ko no np dp ks lj nq nr ku ln ns nt kw lr nu nv ky nw bi translated">富格斯基火花</h2><p id="fb5a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">SQL 的一个美丽特性是它不知道数据的大小。该逻辑以一种与规模无关的方式表达，即使在 Pandas、Spark 或 Dask 上运行也将保持不变。</p><p id="2161" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">使用 FugueSQL，我们可以通过指定<code class="fe ng nh ni mx b">%%fsql spark</code>在 Spark 执行引擎上应用相同的逻辑。我们甚至不需要编辑<code class="fe ng nh ni mx b">str_concat</code>函数来将它带到 Spark，因为 Fugue 会负责移植它。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/b6b38bc97f50188d54ddcbb215e11e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*sF-Ac6Hzl4w80Fy7hP-SrA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/eac24a252b583f9956bf70d60958bdfd" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><h2 id="37b6" class="nb kj it bd kk nm nn dn ko no np dp ks lj nq nr ku ln ns nt kw lr nu nv ky nw bi translated"><code class="fe ng nh ni mx b">PREPARTITION BY</code></h2><p id="f6ea" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">分布式计算的一个重要部分是分区。例如，要获得每个逻辑组中的中值，需要对数据进行分区，使每个逻辑组都位于同一个工作线程上。</p><p id="0635" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为了描述这一点，FugueSQL 有了<code class="fe ng nh ni mx b">PREPARTITION BY</code>关键字。神游的<code class="fe ng nh ni mx b">prepartition-transform</code>语义相当于熊猫的<code class="fe ng nh ni mx b">groupby-apply</code>。唯一的区别是<code class="fe ng nh ni mx b">prepartition-transform</code>扩展到分布式设置，因为它规定了数据的位置。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi or"><img src="../Images/507c07fcd99513dc69f26c226c208d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKY8_oFbwccJbkyNmo6cCw.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片—将代码<a class="ae mv" href="https://gist.github.com/khuyentran1401/091f7439eadbbecdb9b3ad875b30f17a" rel="noopener ugc nofollow" target="_blank">复制到此处</a></p></figure><p id="6ff5" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">注意，对于列<code class="fe ng nh ni mx b">col2</code>中的每个不同值，上面的<code class="fe ng nh ni mx b">get_median</code>函数都会被调用一次。因为数据是预先划分好的，所以我们只需取出第一个值<code class="fe ng nh ni mx b">col2</code>就可以知道我们正在与哪个组一起工作。</p><h1 id="a544" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">生产中的 FugueSQL</h1><p id="d6d0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">要将 FugueSQL 从 Jupyter 笔记本中取出并放入 Python 脚本中，我们需要做的就是将 FugueSQL 查询包装在一个<code class="fe ng nh ni mx b">fsql</code>类中。然后我们可以调用<code class="fe ng nh ni mx b">.run()</code>方法并选择一个执行引擎。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d29718aa68ffd2832ec867e4d3694ef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*int1g5uQzhGP1EpLgSSTAQ.png"/></div></figure><h1 id="4d6d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">FugueSQL 和 pandasql 有什么区别？</h1><p id="9511" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你了解 pandassql，你可能会想:如果 pandasql 已经允许你用 panda 运行 sql 了，为什么还要用 FugueSQL 呢？</p><p id="5bf6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">pandasql 只有一个后端 SQLite。在 pandas 和 SQLite 之间传输数据会带来很大的开销。另一方面，FugueSQL 支持多个本地后端:pandas、DuckDB 和 SQLite。</p><p id="9e63" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">当使用 pandas 后端时，Fugue 直接将 SQL 翻译成 pandas 操作，所以根本没有数据传输。DuckDB 有极好的 pandas 支持，所以数据传输的开销也可以忽略不计。Pandas 和 DuckDB 都是本地数据处理的首选 FugueSQL 后端。</p><p id="3ed3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">Fugue 还支持 Spark、Dask 和 cuDF(通过 blazingSQL)作为后端。</p><h1 id="2c21" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="729f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">恭喜你！您刚刚学习了如何使用 FugueSQL 作为 SQL 接口来操作 Python 数据帧。使用 FugueSQL，您现在可以使用 SQL 语法来表达端到端的数据工作流，并无缝地扩展到分布式计算！</p><p id="e3ec" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">本文并没有详尽地介绍 FugueSQL 的特性。有关 Fugue 或 FugueSQL 的更多信息，请查看下面的参考资料。</p><ul class=""><li id="ad3b" class="ny nz it lc b ld lw lg lx lj oa ln ob lr oc lv od oe of og bi translated"><a class="ae mv" href="https://github.com/fugue-project/fugue" rel="noopener ugc nofollow" target="_blank"> Github 回购</a></li><li id="eaf1" class="ny nz it lc b ld ok lg ol lj om ln on lr oo lv od oe of og bi translated"><a class="ae mv" href="https://fugue-tutorials.readthedocs.io/tutorials/fugue_sql/index.html" rel="noopener ugc nofollow" target="_blank"> FugueSQL 文档</a></li><li id="24a8" class="ny nz it lc b ld ok lg ol lj om ln on lr oo lv od oe of og bi translated"><a class="ae mv" href="https://join.slack.com/t/fugue-project/shared_invite/zt-jl0pcahu-KdlSOgi~fP50TZWmNxdWYQ" rel="noopener ugc nofollow" target="_blank">赋格懈怠</a></li></ul><p id="6cb3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">随意发挥，并在这里叉这篇文章的源代码:</p><div class="ot ou gp gr ov ow"><a href="https://github.com/khuyentran1401/Data-science/blob/master/data_science_tools/fugueSQL.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">数据科学/fuguesql . ipynb at master khuyentran 1401/数据科学</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">master 上有用的数据科学主题以及代码和文章的集合-Data-science/fuguesql . ipynb…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">github.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk mj ow"/></div></div></a></div></div><div class="ab cl pl pm hx pn" role="separator"><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq"/></div><div class="im in io ip iq"><p id="92ee" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的数据科学工具。你可以在<a class="ae mv" href="https://www.linkedin.com/in/khuyen-tran-1401/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae mv" href="https://twitter.com/KhuyenTran16" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上和我联系。</p><p id="ef90" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在 Medium 上关注我，了解我的最新数据科学文章，例如:</p><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/write-clean-python-code-using-pipes-1239a0f3abf5"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">使用管道编写干净的 Python 代码</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">一种简洁明了的处理迭代的方法</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="ps l ph pi pj pf pk mj ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/3-tools-to-track-and-visualize-the-execution-of-your-python-code-666a153e435e"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">3 个跟踪和可视化 Python 代码执行的工具</h2><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pt l ph pi pj pf pk mj ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/how-to-create-mathematical-animations-like-3blue1brown-using-python-f571fb9da3d1"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">如何使用 Python 创建类似 3Blue1Brown 的数学动画</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">利用您的 Python 技能创建美丽的数学动画</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pu l ph pi pj pf pk mj ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/how-to-detect-seasonality-outliers-and-changepoints-in-your-time-series-5d0901498cff"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">如何检测时间序列中的季节性、异常值和变化点</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">只需要 Kats 和几行代码</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pv l ph pi pj pf pk mj ow"/></div></div></a></div></div></div>    
</body>
</html>