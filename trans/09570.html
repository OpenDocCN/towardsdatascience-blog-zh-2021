<html>
<head>
<title>Matrix calculus for data scientists</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学家的矩阵演算</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/matrix-calculus-for-data-scientists-6f0990b9c222?source=collection_archive---------5-----------------------#2021-09-06">https://towardsdatascience.com/matrix-calculus-for-data-scientists-6f0990b9c222?source=collection_archive---------5-----------------------#2021-09-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5343" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">吃红色药丸，学习矩阵微积分！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1769bfcc264af4ae1c6c9049171d0448.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6874cjfkBnIXnqMM"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="4139" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">序言</h1><blockquote class="lr ls lt"><p id="cf9a" class="lu lv lw lx b ly lz ju ma mb mc jx md me mf mg mh mi mj mk ml mm mn mo mp mq im bi translated">你吃了<strong class="lx iu">蓝色药丸</strong>……故事结束，你在床上醒来，相信你想相信的一切。你服用红色药丸…你待在仙境，我让你看看兔子洞有多深。</p></blockquote><p id="b023" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">这是《黑客帝国》三部曲中墨菲斯对尼奥说的名言。你必须做出同样的选择，你想继续使用pytorch和tensorflow这样的签名框架而不知道它们是做什么的吗？或者你想更深入地挖掘矩阵运算的世界，理解像<a class="ae ky" rel="noopener" target="_blank" href="/backpropagation-in-neural-networks-6561e1268da8">反向传播如何工作</a>这样的事情？</p><h1 id="eb90" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">线性代数基础</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/73a51ed863d942b9166f2a1f2834badd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yX-f0HESXpSvSeXH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@soberanes?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乌列尔·索伯兰斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="bfe3" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">向量和矩阵</h2><p id="0a00" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">我用一个小而细的字母写标量(单个数字)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/5bda6f99b6dbb331d0833b7200bd5cd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:148/format:webp/1*q1bvFlhgcEb2kxbLfc7yMw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f24f" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">而向量将由小粗体字母表示。默认情况下，它们是列向量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/2b9b92fe0924d83b2a03597b1177a90a.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*JTyDPoFJbZ8M0UegyE101A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="1620" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">行向量也用小粗体字母表示，但是它们有一个T上标。T上标代表转置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/59af15dabc81ee470ce769111a4d384b.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*B3iLECuw8iCsxxGZaSA4jQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="8a56" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">代表矩阵的符号将是粗体大写字母。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/7ae997e8cd203b50fa786582ee24cdf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*xmhMAxcTowADMJ2ddaq1Ag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="57dd" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">我们也可以转置一个矩阵。执行此操作时，第一列成为第一行，反之亦然。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9edcf6fd75bff1cbd891c241e1b8d5d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*XCMjRya4rVGw0yygwfmnag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="10d7" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">向量或矩阵的维数是一个元组:</p><p id="3faf" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">(行数、列数)</p><p id="78d1" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">让我们考虑以下情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/85047af8f56771a1e3f3a78ca4b796b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*eo4gscaWlCFgUgdVmgDyuw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="572e" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">点积</h2><p id="1b9e" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">向量和矩阵也定义了点积。但是顺序很重要，并且左向量/矩阵的列数必须与右向量/矩阵的行数相匹配。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/c0aed267f39ca0431132633f82bd85c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtELFbAf4CStRjEB-jQ9Pg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="d1e6" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">结果的维数是:(左侧输入的行数，右侧输入的列数)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/8b95768fbc385710c7c2d6ee19aaaf2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*1cMq40lR7-lWQoTFp2aAnA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="c8e4" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">如果你感兴趣，你可以在这里更详细地看到点积是如何执行的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/759c32100ffd7e625a94b1766c68fb26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJ4InlMGNx_FtkwPOEUMJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="6fa8" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">为了得到输出的一个元素，我们将向量/矩阵的左边的一行和右边的一列相乘并求和。</p><p id="d90b" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">点积的重要性在于它可以在许多不同的环境中使用。在力学中，它可以用来表示物体的旋转和拉伸。它也可以用来改变坐标系。</p><h1 id="4890" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分析基础</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/3c206cea63ec3535bc57a7ffa1ebb9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fgkISJ-8opPyKvHi"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@soonsam?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> SOON SANTOS </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h2 id="2d47" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">和的导数</h2><p id="02c1" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">当我们想对一个和求导时，就相当于对每个加数求导。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/dc01963b55db6399e96dd9d83bfa1996.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*cbewGPPhbTJ9L95p-EQR5w.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/77d859d798bab1ddcb46b26f7c597513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*FIIGuFP7YPkUBePV1Hu_NA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="6bec" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">乘积规则</h2><p id="ba1f" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">如果我们想对两个函数的乘积求导，这两个函数都取决于我们要求微分的变量，我们可以使用以下规则:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/04acb63bc5e4a8bf6693a1c98876c69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*oOp035GkB3144zjJEiRlHQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="3b22" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">让我们考虑下面的例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/670e49e323738d61ea857d318bfcb205.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*ap27GyxRrVIwJT5gDP11pg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/04eecef58f7336b46fe9ddb274f72fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*VnsQ_NsTBBNGTbT8fpQ3_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="fe3c" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">那么𝑦对𝑥的导数就是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/c7505d51a1b4d6bf8b841ba488c82331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*0gKgr57F-Zc4ui4nKIO3uQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="c01f" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">链式法则</h2><p id="2fd6" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">我们想对函数𝑦.进行微分这个功能取决于𝑢，𝑢取决于𝑥.然后我们可以应用链式法则。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/36113a7921b95c834db11ab0c9fb30e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*FhieFX7Sc5gpQjSDk51djw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="4d90" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">这里简单举个例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/1024f8052cf568ae1f0cb4543b5dafc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*VS0ZSJPBBMRXwezcfM8dMg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/a9150eba1242d887bbda82c61b751059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nEh0jAzrkm5nXraSGWK7w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h1 id="e8ac" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">矩阵计算</h1><p id="381f" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">在把这些东西下载到你的大脑之后，我希望你已经准备好学习矩阵微积分了！</p><p id="3bc5" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">有两种我们可以写矩阵演算的惯例，所谓的“<strong class="lx iu">分子布局</strong>和“<strong class="lx iu">分母布局</strong>”。在这篇博文中，我将使用分子布局。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/47dd5db6876b29ce779ac666c79f69c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Ld18oWODAvXDtkZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@charleingracia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">查理恩·细川玉子</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="134d" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">向量导数标量</h2><p id="7c68" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">标量值函数相对于变量向量的导数是一个行向量。这个行向量对于我们想要区分的每个变量都有一列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/b8a095e34c9a550016cae215a38f2c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ovmkW-eQIZkVbqVrdTk7CA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="ba36" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">这些点只是表明，我们不一定要用3个变量来区分，而是一个变量。</p><p id="f90b" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">我们来举个例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7f82ee204b053c612cb4aefc032eebfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*IPjBmTWSCe_XM5it8Muupg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/6d800670e3c06e9e1efafb7745023c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pMH-cGS85Ff3_Nv4qyi33Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="3e26" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">然后我们可以应用“和的导数”规则:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/54415a8bf83ed38dd072dc6c0b3e01fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9tqwpx-VeOq2ZGuOn5fwg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="56ff" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">因为一个变量对另一个变量的导数是0，我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/519dffb3831e302b3da6886f82115b5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*L3w5NuQBGtV2nG5jpCWFCw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="93ee" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">标量导数向量</h2><p id="4c34" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">如果我们有一个𝑓函数，它输出一个向量，想要对一个变量求导，我们得到一个列向量作为结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/6bcfc4ece29f1a4373ebe435bdba972c.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*GfvNxwrHLVudM-fRxQSp_Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="9f8d" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">让我们考虑下面这个我们想要求导的向量值函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/fd135bf223d62eee546d405dc084abd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*LiS9wGw3XnxuzuXn8mInJQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="fcf6" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">逐矢量导数</h2><p id="a091" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">当一个向量值函数对一个变量向量求导时，我们得到一个矩阵。我使用一个有2个输出值和3个输入变量的函数作为例子。但是您可以使用任意数量的输出值和输入变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/56dc6aeea4c3f6d83949165270f9c4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WAgZSbd95r2LvSWacdxng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="735f" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">你可以把它想象成“标量乘向量”和“向量乘标量导数”的组合。我们沿着行改变函数输出的元素，沿着列改变变量的元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/b7f605732dd357d5b83243c8ca8df56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7vRkVfLKkqUN3JLhVU-wg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="81f6" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">得到的矩阵具有维度:<strong class="lx iu">(输出大小，输入大小)</strong></p><p id="b6da" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">现在我们快速看一个例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/fcf7ed46504457739a3130d9f9906d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vj20EOLURxLdXUyD7XWpSA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="ebbe" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">摘要</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/783b12e42a09b9088608bd29594bda64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8L9KU2Gc3rkVBIsZA6cL8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h1 id="862f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">向量链规则</h1><p id="3bc0" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">让我们考虑下面的场景。矢量<strong class="lx iu"> 𝑓 </strong>是矢量<strong class="lx iu"> 𝑔 </strong>的函数。<strong class="lx iu"> </strong>向量<strong class="lx iu"> 𝑔 </strong>本身就是向量<strong class="lx iu"> 𝑥 </strong>的函数。所以<strong class="lx iu">𝑓</strong>(<strong class="lx iu">𝑔</strong>(<strong class="lx iu">𝑥</strong>))相对于<strong class="lx iu"> 𝑥 </strong>的导数计算如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/e016bc6e82a7d3e2286a505aadabe7d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*azz1MIoGp7ROfd5nGFi0nQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="5b64" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">我们可以看到，矢量链规则看起来和标量链规则几乎一样。点积仍保留在公式中，我们必须构建“逐向量”的导数矩阵。</p><p id="0db4" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">这里有一个小例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/2665ba1b4e40ac6ffd972695d37fe0e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KhglX-MZjJtKHZHC0mO_kg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="ad33" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">我们计算偏导数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/f293b9f811ae1e4d071edfbc78f696f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*wClrKgxzpkjJuoUw1PI2yg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="a1b7" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">现在我们扩展点积。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/4e8b8e7621426ddaac77408033ba60e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4sompWEALw45hCJEb1ruqQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="4d38" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">最后一次简化，我们得到了结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/cee16295fd96d72aab975e16238e8f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srnibWwKu_lrG7_e0S_vuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h1 id="5a41" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">常数的点积</h1><p id="eeab" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">我们可以像对待标量常数一样对待常数矩阵和向量。允许将它们分解出来。但是请记住，顺序对于两个非标量之间的点积很重要。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2bfbfaa73a8ed57d6a4571c56c93519a.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/format:webp/1*obtPKfLiNFdp8HWEl8IC8g.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/7f039b53a101ac3b129d1d8788cdffb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*ra05XJn4CP3MOB3Cu3sURA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="b7c3" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">我们现在可以分解出矩阵<strong class="lx iu"> 𝑋，</strong>如果它是常数并且不依赖于<strong class="lx iu"> 𝑤 </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/4fa36aa7db7953e9390cbc1ae7cef018.png" data-original-src="https://miro.medium.com/v2/resize:fit:258/format:webp/1*Ie-ICmHqan6z9f2HN5tLzQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="249e" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">知道我们通过向量导数矩阵来构造向量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c0272860e5187be104ecb40ac8f587a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*TjTCBNcObt9lLLdKrJYLew.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="a7ef" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">对角线上为1，其他地方为0的矩阵称为单位矩阵。乘以它的一切都保持不变。因此我们得出最后的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/2177bf5b162b3093cfe2764a39590dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*L4USw_SUFv6i_lzK1ZQIgw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="b4e5" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">你可以得到同样的结果，如果你自己做点积，而不是依赖我告诉你单位矩阵。</p><p id="8378" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">有趣的是，虽然整个方程包含向量和矩阵，但我们得到了基于标量微积分的相同结果。然而，情况并非总是如此，因为并非标量微积分的所有规则也适用于多元微积分。举一个例子来说，没有矢量积规则。</p><h1 id="0a23" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">收场白</h1><p id="c68c" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">我很高兴你服用了红色药丸，和我一起踏上了深入矩阵微积分领域的旅程。如果这对你来说是新的，那么你应该多加练习，自己看几个例子。我希望你喜欢这篇博文，并祝你一切顺利。</p><p id="c275" class="pw-post-body-paragraph lu lv it lx b ly lz ju ma mb mc jx md mr mf mg mh ms mj mk ml mt mn mo mp mq im bi translated">文森特·米勒</p><h1 id="f3c1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">作者的相关文章</h1><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/backpropagation-in-neural-networks-6561e1268da8"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">神经网络中的反向传播</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">从零开始的神经网络，包括数学和python代码</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/einstein-index-notation-d62d48795378"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">爱因斯坦指数符号</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">爱因斯坦求和、指数符号和数值</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pr l pn po pp pl pq ks pc"/></div></div></a></div><h1 id="235f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">作者的其他文章</h1><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/deep-q-learning-is-no-rocket-science-e34912f1864"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">深度Q学习不是火箭科学</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">用pytorch解释和编码的深度Q和双Q学习</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="ps l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/how-you-can-use-gpt-j-9c4299dd8526"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">如何使用GPT J</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">GPT J解释了3种简单的方法，你可以如何访问它</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pt l pn po pp pl pq ks pc"/></div></div></a></div><h2 id="dde7" class="mv la it bd lb mw mx dn lf my mz dp lj mr na nb ll ms nc nd ln mt ne nf lp ng bi translated">想联系支持我？</h2><p id="50ea" class="pw-post-body-paragraph lu lv it lx b ly nh ju ma mb ni jx md mr nj mg mh ms nk mk ml mt nl mo mp mq im bi translated">领英<br/><a class="ae ky" href="https://www.linkedin.com/in/vincent-m%C3%BCller-6b3542214/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/vincent-m%C3%BCller-6b3542214/</a><br/>脸书<br/><a class="ae ky" href="https://www.facebook.com/profile.php?id=100072095823739" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/profile.php?id=100072095823739</a><br/>推特<br/><a class="ae ky" href="https://twitter.com/Vincent02770108" rel="noopener ugc nofollow" target="_blank">https://twitter.com/Vincent02770108</a><br/>中等<br/><a class="ae ky" href="https://medium.com/@Vincent.Mueller" rel="noopener">https://medium.com/@Vincent.Mueller</a><br/>成为中等会员并支持我(你的部分会员费直接归我)<br/><a class="ae ky" href="https://medium.com/@Vincent.Mueller/membership" rel="noopener">https://medium.com/@Vincent.Mueller/membership</a></p></div></div>    
</body>
</html>