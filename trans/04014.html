<html>
<head>
<title>Pandas III: value_counts(), duplicated(), min(), max()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫三:数值计数()，重复()，最小值()，最大值()</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-iii-value-counts-duplicated-min-max-d705cae54862?source=collection_archive---------23-----------------------#2021-04-04">https://towardsdatascience.com/pandas-iii-value-counts-duplicated-min-max-d705cae54862?source=collection_archive---------23-----------------------#2021-04-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="081d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在<a class="ae kf" href="https://christineegan42.medium.com/pandas-ii-drop-isna-cbbe16a15e70" rel="noopener">熊猫II </a>中，我们开始按国家清理<a class="ae kf" href="https://www.kaggle.com/mrpantherson/metal-by-nation" rel="noopener ugc nofollow" target="_blank">金属乐队的数据集。我们删除了一个不需要的列，并填充了一些缺失的值。现在，我们将检查其他列，评估它们的数据类型和值，并根据需要采取措施。</a></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8b8d08114f7e3a1613d5ad9236e5aebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXkbXZh_OCjPF1fAZil6jw.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图片由<a class="ae kf" href="https://pixabay.com/users/nick115-10240673/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3811734" rel="noopener ugc nofollow" target="_blank"> Nick115 </a>来自<a class="ae kf" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3811734" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><h1 id="6063" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">I .检查数据类型</h1><ol class=""><li id="343f" class="lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">打开你的项目笔记本，然后点击<strong class="lq ir">内核&gt;重启并运行所有</strong>重新执行我们之前的工作。</li></ol><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mg"><img src="../Images/d9ba414f0c63f9f439dfc063f2592e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJHgSPtATiABGaVkFJ1qvw.png"/></div></div></figure><p id="ca6b" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">2.这将是很好的，看看我们正在处理的其他类型的价值观。根据我们从输入信息中学到的，我们有五个对象(非数字)列和一个数字列。数字列是我们的目标变量——粉丝数量(稍后会详细介绍)。其余的数据是分类数据，告诉我们不同波段的质量。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mw"><img src="../Images/46619bc14a1983c4365e127c67961262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VvnBASw2r4lpdfUD2XlGDQ.png"/></div></div></figure><h1 id="accb" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">二。Python中熊猫的价值计算</h1><p id="5b24" class="pw-post-body-paragraph mh mi iq lq b lr ls jr mk lt lu ju mm lv mx mo mp lx my mr ms lz mz mu mv mb ij bi translated">4.我们要看的下一栏是“起源”。首先，我们将使用value_counts()检查唯一值，如下所示:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="a81f" class="nf kx iq nb b gy ng nh l ni nj">df[“origin”].value_counts()</span></pre><p id="2466" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">有许多值，Pandas只显示结果的头部和尾部。我们可以将上面的代码行包装在<strong class="lq ir"> len </strong>中，以准确找出我们有多少个独特的原产国。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="af8b" class="nf kx iq nb b gy ng nh l ni nj">len(df[“origin”].value_counts())</span></pre><h1 id="aa12" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">三。熊猫蟒蛇皮复制品</h1><p id="beec" class="pw-post-body-paragraph mh mi iq lq b lr ls jr mk lt lu ju mm lv mx mo mp lx my mr ms lz mz mu mv mb ij bi translated">3.5000个金属带看起来很多，所以也许我们可以检查重复的，以确保所有的行都是唯一的带。我们可以这样检查:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="10cd" class="nf kx iq nb b gy ng nh l ni nj">len(df[df[“band_name”].duplicated()])</span></pre><p id="d6b8" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">这将返回“band_name”值重复的行数。我们可以使用<a class="ae kf" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.duplicated.html?highlight=duplicated#pandas.Series.duplicated" rel="noopener ugc nofollow" target="_blank"> duplicated() </a>删除它们:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="d760" class="nf kx iq nb b gy ng nh l ni nj">df = df.drop(df[df[“band_name”].duplicated()].index)</span></pre><p id="22d6" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">您的笔记本应该是这样的:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nk"><img src="../Images/6f41036e00ae44f87356fd69e0695dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVK_0-oamYIJ23MBneZN4Q.png"/></div></div></figure><h1 id="54c8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">四。对Python和Pandas使用min()和max()</h1><p id="8cc3" class="pw-post-body-paragraph mh mi iq lq b lr ls jr mk lt lu ju mm lv mx mo mp lx my mr ms lz mz mu mv mb ij bi translated">5.接下来，我们有“形成”列。调用<a class="ae kf" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.value_counts.html?highlight=value_counts#pandas.Series.value_counts" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir">value _ counts()</strong></a>将返回所有唯一的年份及其出现的频率。然而，找出最早和最晚的年份可能更有帮助，这样我们可以得到一个范围。将此输入下一个单元格:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="d243" class="nf kx iq nb b gy ng nh l ni nj">df[“formed”].min() <br/>df[“formed”].max()</span></pre><p id="ce61" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">看着<a class="ae kf" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.min.html?highlight=min#pandas.Series.min" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir">【min()</strong></a><strong class="lq ir"/>和<a class="ae kf" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.max.html?highlight=max#pandas.Series.max" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir">【max()</strong></a><strong class="lq ir"/>揭示了另一个问题。一些行的值为<strong class="lq ir">-</strong>。现在，我们需要决定是删除那些行，还是替换那些值。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nl"><img src="../Images/14ce09316a64903a63d0a3d3833efcee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqXOKQfk_KYmeKtUxkECJw.png"/></div></div></figure><p id="57a7" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">尽管info()表明“formed”是一个对象列，但年份数据实际上是数字。因此，如果我们决定替换<strong class="lq ir"> "-" </strong>，使用“Missing”这样的替代词将会导致以后的问题。我们最好使用一个在数据中没有出现过的年份，比如“1900”。</p><h1 id="7ec5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">动词 （verb的缩写）使用replace()和astype()在Python和Pandas中转换数据</h1><p id="006e" class="pw-post-body-paragraph mh mi iq lq b lr ls jr mk lt lu ju mm lv mx mo mp lx my mr ms lz mz mu mv mb ij bi translated">7.您可以通过使用<a class="ae kf" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.replace.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> replace() </strong> </a>来进行替换。要将replace()应用于Pandas数据框中的列，可以使用以下方法:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="d6ca" class="nf kx iq nb b gy ng nh l ni nj">df[“formed”] = df[“formed”].replace(“-”, “1900”)</span></pre><p id="e031" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">现在，我们的最小值和最大值应该是1900–2016。如果您需要查看实际的最小值，只需输入以下内容:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="2504" class="nf kx iq nb b gy ng nh l ni nj">df[df[“formed”] != “1900”][‘formed’].min()</span></pre><p id="a3ff" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">这将显示df部分中“已形成”列的最小值，因此“已形成”列不会(`！= `)的值为1900。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/70e459c5d96c33a5c55616c0078d421a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWtoJajfuscLPckaOl2-ag.png"/></div></div></figure><p id="c366" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">8.既然我们已经从“formed”列中消除了非数字字符，我们可以用<a class="ae kf" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.astype.html" rel="noopener ugc nofollow" target="_blank"> astype() </a>将整个列转换成数字列:</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="6224" class="nf kx iq nb b gy ng nh l ni nj">df[“formed”] = df[“formed”].astype(int)</span></pre><p id="1c0f" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">9.现在，让我们对“split”列做同样的操作，因为它也是一年，是数字数据。也就是用value_counts()检查值，用replace()替换“-”，用astype()更改数据类型。我们还将检查min()和max()。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nn"><img src="../Images/74593b0639c709c450eb54ea465005cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2Ru1_KFcRpRRtnOnmVqOQ.png"/></div></div></figure><p id="efad" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">六。我们做了什么？</p><ol class=""><li id="89a1" class="lo lp iq lq b lr mj lt ml lv no lx np lz nq mb mc md me mf bi translated">使用<strong class="lq ir"> info() </strong>检查了列的数据类型。</li><li id="17c4" class="lo lp iq lq b lr nr lt ns lv nt lx nu lz nv mb mc md me mf bi translated">用<strong class="lq ir"> duplicated() </strong>解决了重复问题。</li><li id="b8d7" class="lo lp iq lq b lr nr lt ns lv nt lx nu lz nv mb mc md me mf bi translated">使用<strong class="lq ir"> isna() </strong>和<strong class="lq ir"> fillna() </strong>处理空值。</li><li id="58c2" class="lo lp iq lq b lr nr lt ns lv nt lx nu lz nv mb mc md me mf bi translated">使用<strong class="lq ir">最小()</strong>和<strong class="lq ir">最大()</strong>检查范围。</li><li id="8ecb" class="lo lp iq lq b lr nr lt ns lv nt lx nu lz nv mb mc md me mf bi translated">用<strong class="lq ir">替换()</strong>清除“已形成”和“已拆分”中的年份数据。</li><li id="2f05" class="lo lp iq lq b lr nr lt ns lv nt lx nu lz nv mb mc md me mf bi translated">使用<strong class="lq ir">更改了列的数据类型。astype() </strong>。</li></ol><p id="c5ea" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated"><strong class="lq ir">七。下一步是什么？</strong></p><p id="0bbe" class="pw-post-body-paragraph mh mi iq lq b lr mj jr mk lt ml ju mm lv mn mo mp lx mq mr ms lz mt mu mv mb ij bi translated">在Pandas IV中，我们通过分析和转换“风格”列来继续分析国家数据集中的金属乐队。</p></div></div>    
</body>
</html>