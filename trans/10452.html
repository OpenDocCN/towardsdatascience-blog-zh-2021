<html>
<head>
<title>Forecasting the COVID-19 trend using the SEIR model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用SEIR模型预测新冠肺炎趋势</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/forecasting-the-covid-19-trend-using-the-seir-model-90979abb9e64?source=collection_archive---------13-----------------------#2021-10-05">https://towardsdatascience.com/forecasting-the-covid-19-trend-using-the-seir-model-90979abb9e64?source=collection_archive---------13-----------------------#2021-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="577c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">编写一个Java程序来分析新冠肺炎数据并预测趋势。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d07c1a9d99711360e67b553f75f48516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3cjGFOejglXcl0MJfB9B2g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。泰国2021年4月1日至2021年10月2日每日新冠肺炎死亡人数和7天平均值图</p></figure><p id="1049" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">泰国在2020年非常好地应对了新冠肺炎。与其他国家相比，病例和死亡人数相对较低。自2021年4月左右开始的最新一波疫情以来，情况已经发生了变化。死亡人数迅速上升。虽然，最近几个月，这个数字有所下降。</p><p id="3837" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将讨论:</p><ul class=""><li id="2966" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">SEIR模式</li><li id="4df2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">用代码模拟SEIR</li><li id="a228" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">检索公共COVID数据</li><li id="b066" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">搜索模型参数</li><li id="e084" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">利用模型进行预测</li><li id="4251" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">可视化结果</li><li id="8838" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">将繁殖率的变化可视化</li></ul><h1 id="166a" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">SEIR模式</h1><p id="8b0e" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">SEIR模型是描述包括新冠肺炎在内的各种疾病的流行模型。一些文章已经讨论了SEIR模式。比如这里的<a class="ae nc" href="https://www.frontiersin.org/articles/10.3389/fpubh.2020.00230/full" rel="noopener ugc nofollow" target="_blank"/>和这里的<a class="ae nc" href="https://docs.idmod.org/projects/emod-hiv/en/latest/model-seir.html" rel="noopener ugc nofollow" target="_blank"/>。我们将简单介绍一下，以便快速进入主题。</p><p id="b5e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该模型将人群分为以下几组:</p><ul class=""><li id="39d5" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">易感者。这组人还没有被感染。</li><li id="b7de" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">暴露(E)。该组中的个体被感染但还没有传染性</li><li id="504c" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">传染性(一)。这个群体会传染给其他人。</li><li id="b034" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">已恢复。组里的人都康复了。</li></ul><p id="3781" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">五个微分方程描述了这些群体中的人数如何随时间变化。我们只考虑简化版本而不是严格版本，因为我们忽略了出生率和其他原因的死亡率。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/66e790658d1c5388f546a650bd93b390.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*iatBGk9xoItyjiL8gqVEfg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。由<a class="ae nc" href="https://latex.codecogs.com/legacy/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank">代码生成</a>。这些是SEIR微分方程。</p></figure><p id="0d88" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">SEIR模型参数是:</p><ul class=""><li id="206d" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">Alpha(𝛼)是由疾病引起的平均死亡率。</li><li id="e229" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Beta(𝜷)是每次接触传播疾病的概率乘以单位时间内的接触次数。</li><li id="d455" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Epsilon(𝜺)是从接触到传染性疾病的进展速度。它是潜伏期的倒数。</li><li id="ef3e" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Gamma(𝜸)是回收率。这是传染期的倒数。</li></ul><p id="9aaa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要使用模型进行预测，我们需要在开始时知道上述参数以及以下值:</p><ul class=""><li id="36e3" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">暴露计数</li><li id="7a13" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">传染性计数</li><li id="5d6d" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">恢复计数</li><li id="755f" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">死亡人数</li></ul><p id="3193" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还需要知道初始易感人数。然而，我们可以从总体和上面的初始值中计算出来。易感人数等于总人数减去暴露人数、感染人数、康复人数和死亡人数。这里我们将SEIR微分方程转化为差分方程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/313d8b224c12aeebe243fbd51d9bd4e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*lhpXlM_jeCkiOHHAtc249A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。由<a class="ae nc" href="https://latex.codecogs.com/legacy/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank"> CODECOGS </a>生成。这些是SEIR差分方程。</p></figure><p id="4f13" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这样更容易用代码实现。</p><p id="bb93" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有两个指标与新冠肺炎相关。繁殖率(R0)是由感染个体产生的继发性病例的平均数。如果我们忽略自然出生率和其他原因造成的死亡，下面的等式描述了繁殖率:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/2d9fe9db59bf1f6a1a0a905d86f50c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*hJv0xwY3GBe5C8oxYmLeqQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。由<a class="ae nc" href="https://latex.codecogs.com/legacy/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank">代码生成</a>。这是繁殖率方程式。</p></figure><p id="7f21" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果R0小于1，则疾病停止。如果R0大于1，疾病继续传播。<br/>另一个是感染和病死率(IFR)。以下等式描述了IFR:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/9f365cdc3cab619f45edc11e5695a7b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:244/format:webp/1*vqY8FKbTghMtWef2CV_OVQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。由<a class="ae nc" href="https://latex.codecogs.com/legacy/eqneditor/editor.php" rel="noopener ugc nofollow" target="_blank"> CODECOGS </a>生成。这是感染率和病死率的等式。</p></figure><h1 id="ba2a" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">用代码对SEIR建模</h1><p id="21c0" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">首先，我们在一个类中模拟SEIR参数。然后，我们用另一种方法表示微分方程。</p><h2 id="996f" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">模型参数类</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="4a2d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里我们封装了SEIR参数和初始条件。成员变量是α、β、ε、γ、初始暴露、传染性、恢复和死亡计数。</p><p id="1e3d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将人口存储在这个类中，因为我们用它来计算易感性。人口值是不变的。因此，在代码中，它是静态的，我们只能设置它一次。</p><h2 id="de44" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">SEIR模特班</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="1b8b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">SEIR模型类有一个将模型参数作为参数的构造函数。</p><p id="b7f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">run方法接受一个参数，即我们希望模型预测的天数。run方法通过计算来预测未来所有组中的个体数量。run方法有一个嵌套循环。外环处理一天。我们把每天分成小的时间间隔，在我们的例子中是10个时间间隔。内部for循环将计算每组中个体数量的增量。我们使用SEIR差分方程来进行计算。我们将结果放入SEIRResult对象中。</p><h1 id="5a10" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">检索公共COVID数据</h1><p id="2221" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">我们的COVID数据来自这个<a class="ae nc" href="https://github.com/djay/covidthailand" rel="noopener ugc nofollow" target="_blank">站点</a>。感谢迪伦杰伊和其他贡献者。</p><p id="8856" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们使用Tablesaw库来处理表和列数据。该库可以处理统计分析以及一些数据可视化。有关Tablesaw的更多详情，请点击查看<a class="ae nc" href="https://jtablesaw.github.io/tablesaw/userguide/toc" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="4c46" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">人口</h2><p id="7b8b" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">泰国人口数据来自excel文件<a class="ae nc" href="http://statbbi.nso.go.th/staticreport/Page/sector/EN/report/sector_01_11101_EN_.xlsx" rel="noopener ugc nofollow" target="_blank">这里</a>。尽管文件提供了更多的信息，我们只需要这个国家的总人口。下面是代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="7068" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">代码很简单。我们从excel文件创建一个表格。然后，我们获取Total列的第一行。就是人口值。最后，我们将其设置为模型参数对象。</p><h2 id="c95c" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">案例简报</h2><p id="9a81" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">每日新信息可在CSV格式<a class="ae nc" href="https://raw.githubusercontent.com/wiki/djay/covidthailand/cases_briefings.csv" rel="noopener ugc nofollow" target="_blank">这里</a>获得。以下是样本内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">案例简报CSV文件的样本内容</p></figure><p id="01d9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然我们只对这些列感兴趣，但是有很多数据:</p><ul class=""><li id="e137" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">案例</li><li id="e794" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">死亡</li><li id="cb38" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">恢复</li></ul><p id="f7c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><ul class=""><li id="56bd" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">首先，我们通过读取在线CSV文件来创建一个表。</li><li id="5ce5" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">这个表格有很多栏。我们删除了除日期、病例、恢复和死亡之外的所有列。</li><li id="ad01" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">我们计算死亡列的7天滚动平均值，并将其存储在一个新列中。我们不会在SEIR模型中使用新列。只是想象。</li><li id="a482" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">接下来，我们过滤表格。仅获取特定日期当天或之后的数据。该日期是该国最新一波COVID浪潮的开始。</li><li id="7b32" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">我们从“病例”列减去“已恢复”列，创建一个新的“传染性”列。</li><li id="dd72" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">每天都有感染、康复和死亡病例。对于每一个，我们创建一个累积值列。</li><li id="a21c" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">最后，我们绘制图表。</li></ul><p id="bb8d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是三张图表:</p><ul class=""><li id="49fb" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">死亡人数和7天平均死亡人数。这张图是本文的第一张图片。</li><li id="aec9" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">累积病例、感染和恢复计数</li><li id="0f72" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">每日病例、传染性和恢复计数</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3d59f74bc132e6f313522dc18117c98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5E4zSKYvojixZcqCCYTXuA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。泰国2021年4月1日至2021年10月2日累计病例数、感染数和痊愈数图表</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0dee8b2d4b33bb5364f63c62573ffd2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmcVvB79bc7IQWlX8kok9g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。泰国2021年4月1日至2021年10月2日每日病例数、感染数和痊愈数图表</p></figure><h1 id="2972" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">搜索模型参数</h1><p id="5d14" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">为了使用SEIR模型进行预测，我们需要SEIR参数和初始条件。以下是我们将要做的事情:</p><ul class=""><li id="918d" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">识别未知的独立模型参数和初始条件。</li><li id="abda" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">确定每个未知参数的可能值。</li><li id="fa94" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">实施通用网格搜索</li><li id="e4b8" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">实施SEIR参数网格搜索</li></ul><h2 id="7ac2" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">识别未知独立参数</h2><p id="e3e5" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">这些是:</p><ul class=""><li id="a76e" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">希腊字母的第一个字母</li><li id="5b87" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">贝塔</li><li id="8575" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">埃普西隆</li><li id="305b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">微克</li><li id="1fb6" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">初始暴露计数。不得而知。</li><li id="4fb1" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">初始感染计数。虽然有官方的数值，但可能太低了，因为权威机构可能没有足够的COVID测试。我们将视其为未知。</li><li id="f2a7" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">初始恢复计数。出于与上述相同的原因，来自数据的值可能太低。我们将视其为未知。</li></ul><p id="125d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最初的死亡人数可以从我们得到的数据中得到。应该够靠谱了。</p><p id="54d6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">总之，我们有七个未知的独立参数要寻找。</p><h2 id="b4d2" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">识别每个未知参数的可能值</h2><p id="b31f" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">对于每个模型参数，我们确定或列出可能的值。</p><ul class=""><li id="3fa4" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">Alpha的范围从0.000005到0.0001。</li><li id="2183" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">贝塔系数的范围从0.05到1.0。</li><li id="8bd2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">ε是潜伏期的倒数。平均潜伏期为5.2天。我们把它做成一个从1/5.6到1/4.8的值列表。</li><li id="374b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">γ是传染期的倒数。据信，这一时期是一个星期或更少。我们把它做成一个从1/9到1/4的值列表。</li><li id="5633" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">初始暴露计数。我们没有确切的数字。我们猜测它将从2倍官方感染开始到20倍官方感染计数。</li><li id="3645" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">初始感染计数。我们估计它会从官方最初的传染数上升到10倍的数值。</li><li id="0bf0" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">初始恢复计数。我们有官方的数字。然而，正确的数字可能更高。我们猜测它将从官方恢复的计数开始到官方恢复的计数的10倍。</li></ul><h2 id="99fa" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">GridSearch类</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="aa4c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">GridSearch类将run方法作为唯一的方法。请注意，它是一个泛型类，以便将来可以重用。在我们的例子中，类型参数是ModelParameter类。</p><p id="eeba" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">方法参数包括:</p><ul class=""><li id="4bce" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">参数网格。</li><li id="9cb0" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">ModelParameter对象的约束。</li><li id="33f7" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">一个我们需要最小化的目标函数。我们通常在模型输出和实际数据之间提供一个误差函数。</li><li id="e297" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">我们希望函数返回的结果集大小。</li></ul><p id="0e07" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该方法将使用网格中所有可能的值来评估目标函数。然后，返回一组排序后的ModelParameter对象，这些对象具有目标函数值最低的值。</p><p id="39d6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，我们使用生产者-消费者设计模式。我们有一个生产者来创建许多参数，并把它们放在一个绑定的队列中。我们有多个消费者来获取队列的参数并计算目标函数值。</p><p id="97a8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是代码的一些解释</p><ul class=""><li id="de6f" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">首先，该方法计算要创建的消费者任务的数量。它是可用处理器的数量减2。</li><li id="067a" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">接下来，它构造一个阻塞队列。Deque是一个队列，一个元素可以从前面或后面添加或删除。德克族是被束缚的。这意味着我们可以加入一定量的元素。如果达到限制，生产者任务将被阻止。</li><li id="1160" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">该方法创建并提交生产者任务。</li><li id="38b3" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">生成器任务测试网格中每个ModelParameter对象的约束，然后将其放入队列。</li><li id="403d" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">对于每个消费者来说，生产者任务就像一颗毒丸。消费者会知道何时停止。</li><li id="d562" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">run方法创建并提交消费者任务。</li><li id="0fda" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">每个消费者任务创建一个绑定树集。我们根据目标函数值对树集进行排序。此外，它只保留最低指定数量的元素。树集源代码这里是<a class="ae nc" href="https://gist.github.com/mananai/cd639294eabae6a5f009b2e64b9b1bb2" rel="noopener ugc nofollow" target="_blank">这里是</a>。</li><li id="56b1" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">每个消费者从队列中获取一个ModelParameter对象。如果不是毒丸，则评估目标函数，并将一对ModelParameter和函数值添加到集合中。当消费者任务发现毒丸时，它会停止。</li><li id="5f2c" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">一旦所有的使用者都完成了，run方法就组合所有使用者的结果，并将其返回给被调用者。</li></ul><h2 id="042f" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">SEIRParameterGridSearch类</h2><p id="e622" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">这个类使用案例简报中的数据表来搜索模型参数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><ul class=""><li id="f3cb" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">它使用表中的第一行作为初始条件的开始猜测。</li><li id="5fef" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">接下来，我们创建一个参数网格。它计算所有参数的笛卡尔乘积。对于每个组合，它都会构建一个模型参数对象，然后调用一个使用者。</li><li id="0b76" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">然后，我们定义一个目标函数，它是我们希望最小化的模型参数的函数。我们使用误差函数来比较模型输出和观察值。我们用来比较的数值是每日死亡数，因为它比传染数或恢复数更可靠。</li><li id="8bb7" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">最后，我们称之为网格搜索。</li></ul><h2 id="7424" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">网格搜索和结果</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="7fc4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上面的代码执行参数搜索。稍后，我们将结果转换成表格。然后，将表格保存为CSV文件，如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><ul class=""><li id="a7d5" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">我们使用61天的数据:从8月3日开始。2021年至2021年10月2日。</li><li id="f205" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">最低的RMSE值是29.9。考虑到数据是有噪声的，我们认为这个值是有意义的。</li><li id="88d1" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">繁殖率为1.6。</li><li id="a391" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">IFR为0.032%。好像太低了。但是根据这个<a class="ae nc" href="https://www.statista.com/statistics/1105914/coronavirus-death-rates-worldwide/" rel="noopener ugc nofollow" target="_blank">站点</a>，死亡率最低在0.07%左右。</li></ul><h2 id="554f" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">想象结果</h2><p id="2de3" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">让我们看看这个模型是如何在图表中拟合观察到的数据的。下面是代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><ul class=""><li id="09b6" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">第一张图是来自实际数据和我们的模型的每日死亡人数。我们可以看到模型与数据非常吻合。此外，所有模型结果都非常接近。</li><li id="3bff" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">第二张图与此类似，只是我们展望了未来60天。我们可以看到预测的死亡人数逐渐减少。然而，还不完全是零。</li><li id="744f" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">第三张图绘制了来自观察数据和SEIR模型的感染计数。在这里，我们看到模型值远远高于官方的感染计数。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/08a250a2264dbb75e88b19eb6fbe4562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P90sS-gtbc_82dS0q2mRew.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。泰国2021年4月1日至2021年10月2日每日观察死亡数和模型结果图</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/082ec5f0b852228477fcfa840d544e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C55oCL0-74uOcewrPGpcOg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。泰国2021年4月1日至2021年10月2日观察到的每日死亡数和模型结果的图表。此外，我们预测未来60天</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9e22ef71ce01b8295275e56d8a9ca1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xks_mO-MF6MqbUEdw_SOKw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。泰国2021年4月1日至2021年10月2日观察到的感染数和模型结果的图表。此外，我们预测未来60天</p></figure><p id="b258" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以看到形势似乎对国家更有利。</p><h2 id="3692" class="nh mg iq bd mh ni nj dn ml nk nl dp mp le nm nn mr li no np mt lm nq nr mv ns bi translated">将复制率的变化可视化</h2><p id="35f8" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">让我们看看繁殖率是如何逐月变化的。我们将这样做:</p><ul class=""><li id="3085" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">按月划分案例数据。</li><li id="bb3b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">使用月度数据运行参数网格搜索。</li><li id="2844" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">计算每月的复制率并绘制数据。</li></ul><p id="2c5f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="4cbf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">图表如下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5f4cfa0679fd535f172aaaff7e78fc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x9Fx_8ZOMtUUFiF0A3SRnQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。2021年4月至2021年9月的繁殖率变化</p></figure><ul class=""><li id="d0da" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">4月份，繁殖率小于1。</li><li id="1b65" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">然后，R0一直增加到7月。</li><li id="ca76" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">8月份，R0略有下降，但仍大于1。</li><li id="0700" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">9月份R0下降很多。现在这个值又小于1了。</li></ul><p id="720e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有了这种出生率的变化，我们更加相信疫情的情况正在好转。</p><h1 id="859b" class="mf mg iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">结论</h1><p id="fbc2" class="pw-post-body-paragraph kv kw iq kx b ky mx jr la lb my ju ld le mz lg lh li na lk ll lm nb lo lp lq ij bi translated">我们使用SEIR模型和公共在线每日数据来分析和预测新冠肺炎趋势。结果看起来很有希望。模型输出与观测数据非常吻合。</p><p id="c3ed" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以做一些事情来改进这个模型:</p><ul class=""><li id="e201" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">我们可以包括自然出生率和其他原因的死亡率。</li><li id="248e" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">我们本可以在方程式中加入移民工人的数量。</li></ul><p id="80a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所有的源代码文件都可以在GitHub <a class="ae nc" href="https://github.com/mananai/repository/tree/master/ForecastCovidTrend" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="fc42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">引用:</strong>迪伦杰伦。泰国新冠肺炎数据。从https://github.com/djay/covidthailand<a class="ae nc" href="https://github.com/djay/covidthailand" rel="noopener ugc nofollow" target="_blank">取回</a>。它是在<a class="ae nc" href="http://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">知识共享署名4.0国际许可</a>下授权的</p></div></div>    
</body>
</html>