<html>
<head>
<title>How to convert XML to a flat table (Python)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将XML转换为平面表(Python)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-convert-xml-to-a-flat-table-python-f51576f569ad?source=collection_archive---------18-----------------------#2021-09-21">https://towardsdatascience.com/how-to-convert-xml-to-a-flat-table-python-f51576f569ad?source=collection_archive---------18-----------------------#2021-09-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/785c0ae4ec9db4ec56ed2a3df64e6fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGoq-97VvTdiZ4mkorpliQ.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图片由Pixabay提供</p></figure><p id="1e05" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">*-这个故事描述了如何使用REST API将高度嵌套的XML转换为平面数据帧。-*</p><p id="2bf9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这个故事中，我们将探索如何使用这个免费的REST API将任何简单的嵌套XML转换成平面表。这个REST API利用一个作为概念验证开发的脚本，它推断任何嵌套XML的结构，组织数据，然后以清晰的结构化格式返回数据。</p><p id="2af1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">目前，API只能将XML数据作为Pandas数据帧返回，但是您可以将数据帧导出/保存为您希望的任何数据格式。</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="7682" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">它是如何工作的</h1><p id="7f6b" class="pw-post-body-paragraph kc kd iq ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">用户登录和注册由Amazon Cognito管理，它处理用户凭证的生成和验证。这允许我们在限制REST API访问的同时轻松管理用户。</p><p id="fbbd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">REST API结合了亚马逊的API网关、AWS Lambda和亚马逊S3。Lambda存放了我们的XML解释器代码，而API Gateway充当了我们调用Lambda的安全访问点。Lambda还跟踪我们的用户请求。这种情况每天都会被跟踪，并以定制的日志格式(与我们的CloudWatch日志分开)记录到S3，这样Lambda就可以验证任何用户每天调用XML解释器的次数都不能超过4次。</p><p id="9527" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">提供的Python脚本处理发送有效请求所需的REST API令牌的获取。由于REST API是受限制的，我们使用我们的Cognito登录凭证来生成我们的关联令牌，然后脚本自动将它传递给我们的REST API请求。然后，该脚本还处理XML编码、REST API请求/响应处理，并将响应解码成数据帧。</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="9efc" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">如何使用REST API</h1><h2 id="35b2" class="mk li iq bd lj ml mm dn ln mn mo dp lr kn mp mq lv kr mr ms lz kv mt mu md mv bi translated">第一步:注册</h2><p id="17d9" class="pw-post-body-paragraph kc kd iq ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">您需要注册REST API凭证。你可以在这里这样做<a class="ae mw" href="http://bitsyl.com/xml_converter.html" rel="noopener ugc nofollow" target="_blank">。滚动到页面底部，然后单击“注册”。</a></p><p id="548a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注册需要一个有效的电子邮件地址和您选择的密码。请务必点击您通过电子邮件收到的“验证”链接。</p><h2 id="4087" class="mk li iq bd lj ml mm dn ln mn mo dp lr kn mp mq lv kr mr ms lz kv mt mu md mv bi translated"><strong class="ak">第二步:警告和注意事项</strong></h2><p id="571b" class="pw-post-body-paragraph kc kd iq ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">REST API是免费提供的，因此随后受到限制。这意味着作为一个公共用户，我们每天只能发出4个请求，XML解释器将只接受遵循以下准则的XML:</p><ul class=""><li id="bffe" class="mx my iq ke b kf kg kj kk kn mz kr na kv nb kz nc nd ne nf bi translated">XML字符限制为4000个字符(大约是本文后面提供的示例XML的两倍)。</li><li id="887b" class="mx my iq ke b kf ng kj nh kn ni kr nj kv nk kz nc nd ne nf bi translated">XML文件必须<strong class="ke ir">而不是</strong>包含实体或其他XML<a class="ae mw" href="https://www.w3schools.com/xml/xml_dtd.asp" rel="noopener ugc nofollow" target="_blank">dtd</a>。</li><li id="d325" class="mx my iq ke b kf ng kj nh kn ni kr nj kv nk kz nc nd ne nf bi translated">建议您的XML只包含属性和文本，如下面提供的示例所示。嵌套元素和属性的数量没有限制。</li></ul><p id="a32a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">API/Lambda已配置为在处理通过请求接收的任何XML之前扫描上述要求。</p><h2 id="5675" class="mk li iq bd lj ml mm dn ln mn mo dp lr kn mp mq lv kr mr ms lz kv mt mu md mv bi translated"><strong class="ak">第三步:准备XML文件</strong></h2><p id="3867" class="pw-post-body-paragraph kc kd iq ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">请务必在上传之前检查您的XML文件，确保其格式正确并符合上面列出的要求。</p><p id="bc87" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果没有XML文件，但想测试XML解释器，可以使用下面提供的示例XML代码。样本来自<a class="ae mw" href="https://opensource.adobe.com/Spry/samples/data_region/NestedXMLDataSample.html" rel="noopener ugc nofollow" target="_blank"> Adobe开源</a>。随意编辑XML，添加额外的嵌套元素、属性等。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><h2 id="cdb6" class="mk li iq bd lj ml mm dn ln mn mo dp lr kn mp mq lv kr mr ms lz kv mt mu md mv bi translated">步骤4:创建您的REST API Python脚本</h2><p id="1c9b" class="pw-post-body-paragraph kc kd iq ke b kf mf kh ki kj mg kl km kn mh kp kq kr mi kt ku kv mj kx ky kz ij bi translated">为了使用REST API，我们需要使用我下面提供的脚本准备一个请求。只需将脚本复制并粘贴到Python文件或笔记本中，然后执行脚本:</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="a59b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">注意</strong>:一定要用你的XML文件路径的路径替换XML文件路径。</p><p id="9ccb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">该脚本将提示您输入之前创建的用户名和密码。如果登录凭证有效，它将自动编译REST API请求，编码您的XML数据，将其发送给解释器，然后返回您的平面熊猫数据帧。</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><p id="4b66" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">恭喜，您刚刚使用REST API将您的XML转换成一个漂亮的平面数据帧！现在，您可以在Pandas中进一步操作您的数据，或者导出到您选择的文件类型。</p></div></div>    
</body>
</html>