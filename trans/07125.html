<html>
<head>
<title>ETL Pipelines for Data Science Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学项目的ETL管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/etl-skills-you-will-need-for-data-science-project-ebc67f7c9277?source=collection_archive---------17-----------------------#2021-06-28">https://towardsdatascience.com/etl-skills-you-will-need-for-data-science-project-ebc67f7c9277?source=collection_archive---------17-----------------------#2021-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f1ba" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据工程师和数据科学家的重要技能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/36932606b92e76def1debb394be6dd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VWZP3iSw-78rvRnS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰克·安斯蒂在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="e9cc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">背景</h1><p id="f575" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在从事数据科学项目时，数据科学家最兴奋的是训练一个奇特的机器学习模型来解决一个商业问题。但是在我们深入模型开发之前，“我们使用什么数据来训练我们的ML模型？数据存储在哪里？”你可能会问。</p><p id="6857" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这就是ETL过程发挥作用的地方。ETL代表<em class="ms"> Extract-Transform-Load，</em>它包括一组程序，包括从各种来源收集数据，转换数据，然后将其存储到一个新的单一数据仓库中，数据分析师和数据科学家可以访问该数据仓库来执行数据科学任务，如数据可视化、统计分析、ML建模和前端应用程序开发。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/e418189ca7a8465abd1bb9151b1b0d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHSzARQPes6JhHe_jNGRdg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者创作)</p></figure><h1 id="5211" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">提取</h1><p id="08b1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在数据科学项目中，ML模型或统计分析需要来自不同来源的大量数据，这些数据可能以各种格式存储。这个“提取”步骤的目标是从正确的来源以正确的数量收集正确的数据。</p><p id="d982" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是数据源的示例，您可以从中收集原始数据。</p><ul class=""><li id="b051" class="mu mv it lt b lu mn lx mo ma mw me mx mi my mm mz na nb nc bi translated"><strong class="lt iu">文本文件</strong>:CSV、TXT、XLS、XLSX等文件还是很常见的存储数据的。导入起来相对简单。</li><li id="3c05" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu"> SQL RDBMS </strong>:关系型数据库，如MySQL、PostgreSQL、MS SQL Server、SQLite等也很常见。通常，这类数据库包含面板数据，这使它们成为数据科学项目的理想选择。</li><li id="f1ae" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu"> PDF </strong>:即使PDF不是存储数据的好格式，我们仍然可能会不时遇到它们，尤其是当我们处理历史数据时，这些数据只能在扫描文件中获得。熟悉处理PDF文件所需的工具可能会成为某些项目的救命稻草。</li><li id="e881" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">网页</strong>:当您需要的数据在您的组织内不可用时，您可能需要在线浏览和搜索数据。许多网页包含有用的数据，这些数据可能成为您分析的重要部分。例如，<a class="ae ky" href="https://medium.com/mlearning-ai/build-a-recommendation-system-using-amazon-review-data-11db1b2f912f" rel="noopener">我们可以抓取亚马逊商品评论数据来构建推荐系统</a>和<a class="ae ky" href="https://medium.com/mlearning-ai/create-a-home-price-prediction-app-with-plotly-dash-google-bigquery-and-machine-learning-c86b715f8f04" rel="noopener">抓取房屋销售数据来预测房屋价格</a>。</li><li id="d19d" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu"> API </strong>:一些数据提供者将他们的数据存储在他们的API中(比如Google API，FRED API，BLS API，RedFin API)，公众可以访问这些API。</li></ul><h1 id="bf91" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">改变</h1><p id="e65c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据科学专业人员应该熟悉“垃圾输入，垃圾输出”的概念。<strong class="lt iu">任何统计分析和机器学习模型都可以和你输入的数据质量一样好。</strong></p><p id="910d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">应用数据操作和转换来<strong class="lt iu">提高数据质量</strong>是任何数据科学项目的关键步骤。</p><p id="897a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是我们可以用来处理数据的转换步骤的例子。</p><ul class=""><li id="f304" class="mu mv it lt b lu mn lx mo ma mw me mx mi my mm mz na nb nc bi translated"><strong class="lt iu">基本清理</strong>:将变量转换成正确的数据格式。例如，如果适用，我们可以将字符串变量转换为日期或数字变量。我们可以删除转录错误并标准化列中的值。</li><li id="9ce7" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">特征提取</strong>:从现有变量中提取新变量。例如，我们可以从日期变量中提取日、月、季度和年。我们可以从包含产品描述的列中提取产品特征，如品牌、数量、风味、类型和任何相关特征。</li><li id="a941" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">重新格式化</strong>:将数据从long转换为wide，反之亦然。例如，我们希望改变数据的形状，并创建一个将单个列的值转换为多个列的数据透视表</li><li id="c479" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">连接表</strong>:通过一个或多个公共列合并多个数据表，创建一个主表。</li><li id="68c8" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">过滤</strong>:有时候，我们的项目只需要数据的一个子集。仅保留相关数据将加快我们的数据转换过程。</li><li id="4572" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">聚合</strong>:对一个或多个列定义的组中的行应用聚合函数，如average、min、max、median、percentile、sum。例如，我们可以按城市、产品或零售店计算总销售收入。我们可以按周和城市计算平均温度。</li></ul><p id="5bf8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是您在转换数据时可能会遇到的数据问题的示例。</p><ul class=""><li id="00b4" class="mu mv it lt b lu mn lx mo ma mw me mx mi my mm mz na nb nc bi translated"><strong class="lt iu">重复</strong>:有重复记录是常见问题。我们需要了解相同的记录是否实际上是错误创建的副本。相同的记录也可能是合法的。例如，给定的人可能在同一天在同一家商店购买了相同的产品。如果相同的记录确实是重复的，那么我们可以放心地删除它们。</li><li id="c9b7" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">离群值</strong>:如果手工输入数据，数据库容易出现数据错别字。例如，如果一个给定的价格是同一产品价格的10倍，那么这个价格很可能是一个异常值。识别异常值的一种常用方法是在给定的合计水平中使用百分点范围(10-90个百分点或5-95个百分点)。如果价格在同一产品的百分位数范围之外，这些价格可能是异常值，我们可以进一步调查。</li><li id="0ba0" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">缺失数据</strong>:数据点可能(1)随机缺失或(2)非随机缺失。(1)如果数据随机且少量丢失(例如，在一些列中有丢失值的行)，只要我们仍有足够的数据点来实施我们的分析，就可以安全地移除数据。(2)如果数据不是随机缺失的(例如，一些高薪人士不想在调查中透露他们的收入。所以你可能会得到一个不准确的收入分配)或者一个缺失的值取决于一些其他变量的值(例如，女性通常不想透露她们的年龄。所以年龄变量会受到性别变量的影响)，我们需要做的第一件事是回到数据提取步骤，看看我们是否有额外的数据集可以用来填充缺失的数据。如果没有可用的数据，我们可以考虑使用插补方法来填补缺失的数据，如均值插补、回归模型、多重插补和KNN。(请小心使用这些估算方法，因为它们可能会减少数据的差异。)</li><li id="6512" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">损坏的文本</strong>:这个问题可能是由上游数据收集程序引起的，它使数据看起来很乱。例如，我们可能有缺少州、邮政编码或拼写错误的街道名称的地址数据，这使得识别唯一的家庭地址变得困难。要解决这个问题，我们可能需要与数据管理部门讨论问题，看看他们能否解决这个问题。如果没有，我们需要想出一个变通办法。为了标准化地址数据，我们可以使用Google Geolocation API来提取格式良好的位置数据。</li></ul><h1 id="46cb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">负荷</h1><p id="d51b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据加载是ETL过程的最后一步。<strong class="lt iu">已处理数据的最终目的地可能会根据您的下游分析需求而有所不同。</strong></p><p id="91be" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是可以存储已处理数据的目标数据库或数据仓库的示例。</p><ul class=""><li id="55cb" class="mu mv it lt b lu mn lx mo ma mw me mx mi my mm mz na nb nc bi translated"><strong class="lt iu">平面文件</strong>:您可以将数据存储在文本文件中，如CSV、TXT和excel电子表格。这些类型的数据格式对于没有在计算机上安装数据科学软件的非技术用户来说很容易获得。</li><li id="4384" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu"> SQL RDBMS </strong> : SQL数据库是一种流行的数据存储，我们可以加载我们处理过的数据。</li><li id="fa31" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">其他数据格式</strong>:基于数据分析师和数据科学家使用的数据科学软件，其他流行的数据格式有。PICKLE (Python)，。DTA (Stata)和。RDS (R)。</li></ul><h1 id="0a69" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">ETL工具</h1><p id="b874" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果您使用Python已经有一段时间了，您可能知道Python有各种各样的数据科学库，这些库使ETL过程变得很容易。</p><p id="5150" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是一些用于ETL的Python库。</p><ul class=""><li id="6a2f" class="mu mv it lt b lu mn lx mo ma mw me mx mi my mm mz na nb nc bi translated"><strong class="lt iu"> SQLAlchemy </strong> : SQLAlchemy是一个模块，它允许完全通过Python定义模式、编写查询和操作SQL数据库。它可以与不同的SQL数据库系统交互，如MySQL、PostgreSQL、MS SQL Server、SQLite。对于希望在一个平台上实现所有任务的数据科学专业人员来说，这是一个巨大的优势。</li><li id="d8fa" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu"> Pandas </strong> : Pandas是一个流行的用于数据转换和操作的Python库。它使用<strong class="lt iu">数据帧</strong>将面板数据存储在本地存储器中。它相对易于使用，并具有大量的数据清理、操作和可视化功能。</li><li id="db02" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu"> PySpark </strong> : PySpark是Apache Spark的Python API，支持所有基本的数据操作功能，如映射、过滤、连接、排序和用户自定义功能。它在大型硬件集群上快速并行处理大量数据的能力是一个关键优势。</li><li id="11a4" class="mu mv it lt b lu nd lx ne ma nf me ng mi nh mm mz na nb nc bi translated"><strong class="lt iu">Swifter/Dask</strong>:Swifter和Dash都使您能够使用并行处理来处理大量数据，这可以最大限度地提高本地机器的计算能力。这两个软件包也能很好地处理Pandas DataFrame。</li></ul><h1 id="363b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">来源:</h1><div class="ni nj gp gr nk nl"><a rel="noopener follow" target="_blank" href="/python-etl-tools-best-8-options-5ef731e70b49"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">Python ETL工具:最佳8个选项</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">想用Python做ETL？这里有8个很棒的库和一个混合选项</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks nl"/></div></div></a></div><h1 id="05aa" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">感谢您的阅读！！！</h1><p id="fdf7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你喜欢这篇文章，并且想<strong class="lt iu">请我喝杯咖啡，</strong>请<a class="ae ky" href="https://ko-fi.com/aaronzhu" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p><p id="d7e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以注册一个<a class="ae ky" href="https://aaron-zhu.medium.com/membership" rel="noopener"> <strong class="lt iu">会员</strong> </a>来解锁我的文章的全部访问权限，并且可以无限制地访问介质上的所有内容。如果你想在我发表新文章时收到电子邮件通知，请<a class="ae ky" href="https://aaron-zhu.medium.com/subscribe" rel="noopener"> <strong class="lt iu">订阅。</strong></a></p></div></div>    
</body>
</html>