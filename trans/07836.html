<html>
<head>
<title>Mercari Price Suggestion Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Mercari价格建议挑战</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mercari-price-prediction-challenge-3a8ea00a7d33?source=collection_archive---------14-----------------------#2021-07-18">https://towardsdatascience.com/mercari-price-prediction-challenge-3a8ea00a7d33?source=collection_archive---------14-----------------------#2021-07-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8623" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">给定产品的细节，产品的价格应该是多少？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/10d62c6c263fa5130939ec8abb53167e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BoqcFowATqjqBlLA"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">迈克尔·朗米尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="4c02" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">目录:</h1><ol class=""><li id="b5dd" class="lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">介绍</li><li id="9e79" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">商业问题</li><li id="462e" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">先决条件</li><li id="bd8a" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">数据源</li><li id="8b49" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">现有方法</li><li id="a36d" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">理解数据</li><li id="4a08" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">电子设计自动化(Electronic Design Automation)</li><li id="8406" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">数据预处理</li><li id="35a5" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">基准解决方案</li><li id="155f" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">第一次切割溶液</li><li id="95ec" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">基于深度学习的解决方案</li><li id="8c85" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">结论</li><li id="ea80" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">部署和预测</li><li id="cc2f" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">未来的工作</li><li id="b98b" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">Github知识库和Linkedin</li><li id="ebe7" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">参考</li></ol><h1 id="e15d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">1.介绍</h1><p id="8397" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">Mercari是一家电子商务公司，目前在美国和日本开展业务。这提供了一个平台，顾客可以出售不再有用的物品。它试图通过提供上门取件、当天送达和许多其他优势，使所有流程变得无障碍。该公司的网站显示，每天有超过35万件商品在网站上列出，这反映了它在用户中的受欢迎程度。</p><h1 id="619b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">2.商业问题</h1><p id="7b50" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这个问题很容易理解，给定产品的细节和产量，产品的价格应该是多少。当我们将这作为机器学习问题时，我们称之为<strong class="lq ir">回归问题</strong>，因为输出是实数(价格)。</p><h2 id="83a2" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">绩效指标:</h2><p id="5018" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">性能指标是一个函数，用于了解我们的模型在其工作中所处的位置。根据问题的类型和业务需求，有不同类型的度量标准，例如准确性、roc曲线、均方误差等。我们这里使用的度量是<a class="ae kv" href="https://www.kaggle.com/wiki/RootMeanSquaredLogarithmicError" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir">均方根对数误差</strong> </a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ce9e46f705c992cea0498cb4a721dfaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*3b3xbp2eiue7l4ciOcSkSg.png"/></div></figure><h2 id="079b" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">目标:</h2><p id="20dd" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">显然，我们解决这个问题的主要目标是预测一个准确的价格。基于对产品的描述，必须向卖家建议一个<strong class="lq ir">真实价格</strong>，以维持卖家和买家之间的可信度。</p><p id="9ea2" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">b)由于机器学习模型将作为web应用程序运行，预测的时间延迟必须更短。卖家不喜欢等很久才知道结果。从毫秒到几秒的时间范围应该是向销售者显示输出的适当时间。</p><h1 id="c9d7" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> 3。先决条件</strong></h1><p id="966a" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在此，我假设读者知道经典机器学习和深度学习、数据预处理、探索性数据分析的基本概念。</p><h1 id="78ba" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> 4。数据来源</strong></h1><p id="1279" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">数据集是通过Kaggle获取的，其中包含两个文件，一个用于训练，另一个是测试文件。训练文件包含超过140万条记录，测试文件包含大约300万条记录。文件在里面。tsv格式，大小分别为74MB和280MB，经过压缩。</p><h1 id="7fdf" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">5.现有方法</h1><p id="0807" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">许多数据科学爱好者用各种方法解决了这个问题。比赛获胜者Paweł和Konstantin采用了非常简单的方法，并结合了一些令人惊叹的技巧。他们用稀疏的输入训练了一个简单的MLP。他们的技巧包括名称chargrams，用PorterStemmer做词干，文本特征的连接。他们使用单词包-1，2-grams(有/没有Tf-IDF)和一键编码作为分类特征(<a class="ae kv" href="https://gh.mltrainings.ru/presentations/LopuhinJankiewicz_KaggleMercari.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="nq"> link </em> </a>)。其他人也尝试了基于CNN的模式。</p><h1 id="7b1b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">6.理解数据</h1><p id="51b7" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">定型数据集的每一行都代表一个列出的产品，该产品包含有关它的某些信息。每列显示产品的具体细节。总共有以下七列:</p><p id="8f25" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 1。</em> <em class="nq">名称:</em> </strong>显示所列产品的标题</p><p id="0608" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 2。item_condition_id: </em> </strong>卖家提供的物品状况。这是一个有序的分类特征，分类范围从1到5，其中1比5好。</p><p id="ff15" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 3。类别名称:</em> </strong>该特性保存列表的类别名称。例如:“女人/运动服装/裤子，紧身衣，打底裤。</p><p id="9adb" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 4。</em>品牌名称:</strong>该功能给出品牌的名称。该要素还包含空值。</p><p id="f4aa" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 5。价格:</em> </strong>这是我们要预测的特征，也就是<strong class="lq ir">目标变量</strong>。单位为美元($)。</p><p id="c1dc" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 6。shipping: </em> </strong>这是一个分类特征，告诉谁支付运费。如果卖家付款，则为“1”，如果买家付款发货，则为“0”。</p><p id="4c4e" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq"> 7。item_description: </em> </strong>此功能包含物品的完整描述</p><h1 id="860f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">7.探索性数据分析</h1><p id="7d7c" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这一步是解决机器学习问题的关键步骤之一，因为它提供了探索和理解数据集的机会。这种对数据集的深入了解不仅对理解现有特征很重要，而且对开发新特征以输入到机器学习模型也很重要。现在我们知道为什么要做EDA了，让我们开始吧。</p><h2 id="0d07" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">基本统计</h2><p id="8e73" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在EDA的这一部分中，我们将尝试理解整个数据集，包括收集关于原始数据(如形状或数据类型)的初始统计数据。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="7b0c" class="my kx iq ns b gy nw nx l ny nz">df = pd.read_csv(“train.tsv”,delimiter=”\t”,index_col=[“train_id”])<br/>print(df.shape)<br/>df.info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a8fd1e32264a379ab50a5bbac6d417b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:208/format:webp/1*lb0-1Unm3PhZugUS5TfTIQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/282e8893d635f26b4c8eccd026fa965c.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*F4Bhjr_nm5ou0gNa6f6sfQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">的输出。信息()</p></figure><p id="c4c3" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">我们可以清楚地看到数据集有1482535行和7列。的。info()表示每列的数据类型，而“类别名称”、“品牌名称”和“项目描述”包含一些空值，我们将在数据处理部分处理这些值。</p><h2 id="3562" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1单变量分析:</h2><p id="daf2" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">简单地说，通过一次获取一个特征(列)来探索数据是单变量分析。这种方法有助于发展对所考虑的特定特征的理解。</p><h2 id="17e6" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1 .价格</h2><p id="5adc" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">我们知道这是我们的目标变量。这个特性的数据类型是float，因此我们可以检查这个变量的统计数据</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="449a" class="my kx iq ns b gy nw nx l ny nz">df.price.describe()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/548da990c9f894dee8199a38bafa7ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*3Fyl1i5SCCCcAf6ZBe6ygw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">的输出。德塞利贝()</p></figure><p id="cd51" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">我们可以看到的一件事是，平均值为26.7美元，最大值约为2000美元，这意味着数据中肯定存在一些偏差。为了证实这一点，我们可以简单地用下面的图表绘制分布图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/1e011058e946d820c9c831ad36c4eb10.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*wT6gke0agjXswWdhHIV86Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">价格分布图</p></figure><p id="654d" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">正如我们所料，情节严重扭曲。这看起来非常接近于<a class="ae kv" href="https://en.wikipedia.org/wiki/Log-normal_distribution" rel="noopener ugc nofollow" target="_blank">对数正态分布</a>。当分布是对数正态分布时，值的对数分布是高斯分布。这意味着，如果我们对价格取对数，其结果将接近高斯分布，如下所示:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="b0b8" class="my kx iq ns b gy nw nx l ny nz"># Note : We are adding 1 to aboid inf value for 0 price products<br/>df["log_price"] = df.price.apply(lambda x:np.log(x+1))<br/>plt.subplot(1,2,2)<br/>plt.hist(df.log_price,bins=30,color="teal")<br/>plt.title("Log(Price+1) Distribution")<br/>plt.xlabel("log(Price+1)")<br/>plt.ylabel("Count")<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/27dc2605ebe189e1efb81d88c2177c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*6NtQ9Ipv5QiWvUzt7b0qQg.png"/></div></figure><p id="19e2" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">这种分布接近高斯分布，高斯分布比原始价格有一定的优势。</p><ul class=""><li id="ed02" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">与对数正态分布不同，高斯分布中的值在所有范围内分布更加均匀，在对数正态分布中，很少有数据点可用于较高的价格值。</li><li id="4348" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">这有利于线性回归等模型，线性回归假设因变量呈正态分布。此外，对于其他模型，高斯分布的目标变量也提供了更好的性能。</li><li id="7a2a" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">无论如何，考虑到我们的性能指标，我们必须计算预测价格和实际价格的对数，因此最好将log(价格+1)视为我们的目标价值，并计算它的RMSE。</li></ul><p id="8adb" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">因此，我们将考虑log(价格+1)作为我们的目标变量。<br/>有些产品定价为0美元。我们稍后将对这些产品进行有趣的EDA。</p><h2 id="91f1" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1.b项目条件标识</h2><p id="a920" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated"><a class="ae kv" href="https://www.mercari.com/us/help_center/article/316/" rel="noopener ugc nofollow" target="_blank"> Mercari将</a>的产品状况分为5类。</p><ul class=""><li id="c3ff" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">新的</li><li id="2d0d" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">喜欢新的</li><li id="358e" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">好的</li><li id="c671" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">公平的</li><li id="665f" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">贫穷的；贫困的</li></ul><p id="b953" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">这些分别表示在从1到5的数据集中。现在，让我们来看看这些类别中的产品。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7bb755814ae64314c35d35e324ef2170.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*XX4AnCvwBx9YB2HNeR84pg.png"/></div></figure><p id="750b" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">我们可以清楚地观察到，对于item_condition_id，每个类别下的列表数量存在可变性。最大的组件属于类别1，而类别5拥有最小数量的列表。这是有道理的，因为数字越低，产品的质量/状况就越好，没有人想把他们的产品评为状况不佳。</p><h2 id="c01d" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1.c运输:</h2><p id="af10" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">我们将对运输执行类似的分析</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/125b49bfd9bc56a0affa649dfcb9c748.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*GxkfY0b902s8FCUdfkC1OA.png"/></div></figure><ul class=""><li id="bbc5" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">这里也有一个小的类别不平衡。这些特征随价格的变化将是一个有趣的分析，我们将在双变量分析部分看到。</li></ul><h2 id="b2b7" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1.d“品牌名称”</h2><p id="550d" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">品牌名称是最初将大约40 %的值保存为空的特征。我们将把这些空值视为“丢失”,我们将在预处理部分看到。我们还将从列表名称中提取品牌名称，这将未知品牌名称减少到27%。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/a8c515d89abd12cb853072e4fdac8a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*vgEailn6dJqcTSFdPYCz4g.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/8b5a67c3f1cdd3b1949f198e05b56704.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*K1fQuOctKwrUxbYVLo5bTA.png"/></div></figure><ul class=""><li id="6395" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">brand_name中有将近4800个类别。出现次数最多的前10个品牌包括<strong class="lq ir"> <em class="nq"> pink、Lularoe、Nike、victorias secret、apple、Nintendo、forever 21、lululemon、Michael kors </em> </strong> <em class="nq"> </em>，这些其实都是非常著名的品牌名称。<em class="nq"> </em>出现最少的品牌有<em class="nq"> </em> <strong class="lq ir"> <em class="nq">警察、快乐袜、pal zileri等。</em> </strong>其中很少听说过<strong class="lq ir"> <em class="nq">。</em> </strong></li></ul><h2 id="c2ba" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1.e类别名称</h2><p id="d324" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated"><strong class="lq ir"> <em class="nq">类别名称</em> </strong>是产品所属类别的名称。这是Mercari网站特有的。此功能还包含大约6k个空值，这些空值是用文本“缺失”输入的。</p><p id="c157" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">让我们先来全面了解一下category_name。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6796d371616453d844b1d70dd01e1bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*HF1yMBhgp8YTQn8f8r03Rw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/c1caf1a52a6a12d7c3adf98761e1b998.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*wgrc4RMFbyZDKyA2yqIPWA.png"/></div></figure><ul class=""><li id="4629" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">category_name有1287个类别，其中大部分产品来自女装和美容产品。</li><li id="32d7" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">我们可以在Mercari网站上看到，类别是分层的，这意味着一个主类别包含子类别等等，或者我们可以说有不同的层级(我们将使用这一术语)。这些由“/”分隔。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/dbc7d1812ac1604acb20b3bd2610d6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*FqxfVxXf_gAgHABtXz_m_A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图来自<a class="ae kv" href="https://www.mercari.com/" rel="noopener ugc nofollow" target="_blank">https://www.mercari.com/</a></p></figure><p id="90dd" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">我们将在数据预处理中看到如何分离这些类别，但现在，我们可以假设类别分为三层(Tier_1、Tier_2、Tier_3)。</p><p id="9552" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> 7.1.f Tier_1 </strong></p><p id="1a8b" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">在第一级中，共有10个类别(未知值被视为缺失)。几乎一半的产品属于“女性”类别，其次是美容和儿童，相比之下比例相当低。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/ea1c8831d917608bd1a9696a452d4403.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*-qPMjwxNi98Zeadc5YDkxQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/f0290615cf2ac775c4dadb29ef11d2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*US4poyT6OTKrIpWhUQDd1w.png"/></div></figure><h2 id="7a52" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1.g '第二层'</h2><p id="7bde" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在第二层，我们有100多个类别。不出所料，在10大女装中，美妆产品独占鳌头。最少出现的类别是'<em class="nq">被子'。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/fa100e0e3cc3c894ded7d0d70f2172c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*_wLXyyExzwUtFv3vlXvaAQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/cd275c1aed64de277979eabed21f9632.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*LM947J1WufAvFLt1vJUsfA.png"/></div></figure><h2 id="d858" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.1.h第三层</h2><p id="6102" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在第三层，我们可以观察到800多个类别。排名前十的产品包括t恤、紧身裤、游戏、鞋子和其他。最少10个产品类别包括视频游戏，瓷砖，教育(有趣)，清洁，袖口等。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/39271ef67af9576de6a9f9ee7b9a2347.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*Z0Y54Szz_hecXkC0bQtPlw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/9f358a1357fff2df1e315be168504911.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*Y6ZBQxsHAkpxYB9rn_9uFQ.png"/></div></figure><h2 id="c951" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated"><strong class="ak">7.1 . I‘名称’</strong></h2><p id="e3a0" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">接下来，我们有一个功能名称，它对于大多数产品都是唯一的，因为我们可以看到该功能中有100k个类别，但对于某些产品，它是相同的。出现次数最多的一个名称是“bundle”。这可能是为了大量销售的产品</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/ca20a57aafaf1173e02e372a14561d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*PmvfxZqEGl8NuWJUMPs5YA.png"/></div></figure><p id="4c50" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">对于文本特征，我们还可以检查字符长度和字数的分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/25bffa31ed5ca8dc865aa954179dd2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mN5r7Pk-UnW3Rtdj-TMXA.png"/></div></div></figure><ul class=""><li id="7660" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">大多数卖家倾向于给出超过20个字符的名字，因为一些字符的分布是左偏的。</li><li id="35bf" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">有些卖家给名字的字数特别多，比如超过12个</li></ul><p id="c785" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir"> 7.1.j '项目_描述'</strong></p><p id="b081" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">项目描述是建模的一个重要特征。它保存了卖方提供的关于产品的描述性信息。此功能包含4行空值，被估算为“缺失”。</p><p id="e932" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">当我们观察此功能中的类别时，发现大约5%的列表由<em class="nq">【暂无描述】</em>占据主导地位。这些可能是在网站上注册列表时为该零件提供的默认值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/fa991bb719ca29d57f2184ae44f204ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*qTROYpRrbUOO0NoH8p0pcQ.png"/></div></figure><ul class=""><li id="5e5c" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">item_description中的字符数分布描绘了高度倾斜的图。CDF图显示大约90%的描述长度小于400。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/fbf6a8362235e843f4324f16dfa239de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAxebCESzvn52I-V86POlQ.png"/></div></div></figure><h2 id="d7a0" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2双变量分析</h2><h2 id="cb06" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2 .项目条件标识与日志价格</h2><p id="0c7e" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这里我们绘制了item_condition中每个类别的log_prices的分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/7e5776953b680bdfa3be6885339c45f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KHM5G3pqOAf75oRMYmQpSA.png"/></div></div></figure><ul class=""><li id="85d8" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">整个情节相当笨拙，但我们可以观察到的一件事是，item_condition_id =5的CDF比其他的低，这是有意义的，因为5的条件很差，因此价格也应该很低。</li></ul><h2 id="6c31" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2.b运输与日志价格</h2><p id="6e90" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在这里，我们分析log_price和shipping之间的关系，并为每一类shipping绘制分布图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/e0ab984dd1a9a29d1786664c88acf0e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aOzDx_ypxhjD-y0ZaG9s_A.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/9ff26e364f1144016b394969c511accd.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*TxH-niXI1RP5LX-a_N-brQ.png"/></div></figure><ul class=""><li id="79e5" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">这个特征中有一些信息，因为类别的分布沿着轴移动。</li><li id="085c" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated"><strong class="lq ir">买方支付</strong>的CDF图向右，显示买方支付运费的价格更高，这是合理的。</li><li id="5d47" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">箱线图还表明类别1的价格低于类别0的价格。这是可以理解的，因为“1”表示卖家将支付运费，这使得产品价格更低。</li></ul><h2 id="c98d" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2.c品牌名称与价格</h2><p id="79c3" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">为此，我们在数据集中绘制了前25个最昂贵的品牌。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/8c2a7a9c14ebded5835cc174d3c83003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZvdzOMuwGhVUmnrS7ZEFg.png"/></div></div></figure><ul class=""><li id="b6fe" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">我们可以观察到，最昂贵的品牌价格可以高达2000美元。</li><li id="c4d4" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">这也取决于产品类型，因为有一个品牌<strong class="lq ir">戒指</strong>最有可能出售戒指。这种产品本身就是一种昂贵的产品，与品牌无关。</li></ul><h2 id="aa84" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2.d Tier_1与价格</h2><p id="dd6b" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">现在，让我们看看Tier_1类别对产品价格的影响。这里我们绘制了Tier_1中每个类别的平均价格和中间价格值，从中我们可以观察到平均值高于中间值。这是右偏分布的性质，我们知道产品的价格是高度右偏的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/96f797e4f9cd93985e171b92c0764627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yGiXUZnlLg11djpoeJHhg.png"/></div></div></figure><ul class=""><li id="57c8" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">每个类别的log_prices的方框图表示电子产品、女性用品、美容用品、古董收藏品和手工制品的价格范围高于其他产品。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/25277a4bdadd28a1b6c5a75f8a749d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*LXHpZpjZNEMFnaZvDO45zg.png"/></div></figure><h2 id="3975" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2.e名称与项目条件标识</h2><p id="23a7" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这是一个有趣的分析，它告诉我们这些名字是如何根据产品的状况而变化的。我们将利用Wordcloud进行分析。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/448fa55da2e16d5ebf44277f4572a178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VntJ4UM3HEalyWmxrj31WA.png"/></div></div></figure><ul class=""><li id="1e04" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">服装产品和品牌在所有图片中都可以看到，比如所有类别中都出现的“粉色”。</li><li id="6976" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">在item_conditon_1中,“新的”一词经常用于名称中，它还包括非常受欢迎的品牌名称，而在item _ conditon _ 5中可以看到“坏的”一词，这是有意义的，因为这一类别是针对劣质产品的。</li><li id="fc68" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">由于没有单独的尺寸特征，所以在名称本身中提到了尺寸。因此，我们可以在几乎所有的单词clouds中看到“size”。</li></ul><h2 id="3d4c" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">7.2.f项目描述与项目条件标识</h2><p id="a1a1" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">对item_description进行类似的分析，结果如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/ebfe91dca040427134a2a54243098eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoHnMrlCegM_NWLyGr4OMA.png"/></div></div></figure><ul class=""><li id="ebae" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">出现在每个类别中的所有单词都是可以理解的，而且相当真实。比如item_condition_id =有<strong class="lq ir">这样的词全新，从未用过，全新，高品质。</strong></li><li id="fc77" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">现在，随着item_condition_id数量的增加，描述中使用的词语也会发生变化。在item_condition_id =3 <strong class="lq ir">使用的条件中，轻轻使用的</strong>是最显著的字，其对于item_condition_id =5变为<strong class="lq ir">零件、损坏、工作</strong>。</li></ul><h2 id="b25c" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated"><strong class="ak"> 7.3 </strong>零价格产品分析</h2><p id="6d7d" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在本节中，我们将分析价格等于0美元的产品。首先让我们看看有多少产品的价格等于零。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="ee26" class="my kx iq ns b gy nw nx l ny nz">zero_price = df[df.price&lt;=0]<br/>print("The shape of the df =",zero_price.shape)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/9fbb8768f8b33a7752fc9619cd59f8bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*bWCKtPn-Z56fV14Jf_QHLA.png"/></div></figure><p id="04fc" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">为了了解这些产品属于哪一类别，我们将在功能Tier_1、Tier_2、Tier_3的每个类别中绘制产品图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/727b15b4c2439e11a1be9054ad13a214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*agfDl69ig6-mcH1OgKXbcQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/44cb449965940889b1856a3720764748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tmwsowVxq-3HeQQlB4kwxQ.png"/></div></div></figure><ul class=""><li id="ab3a" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">大多数价格为“0”的产品是<strong class="lq ir">服装或美容产品</strong>，属于<strong class="lq ir">女性</strong>类别。</li></ul><p id="2a0a" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">我们还可以计算出每种情况下产品的百分比，并将其与总百分比进行比较。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/c3434096bb86e804a687a6ad182b98e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DE1d7z24FaXkmU24XTRF8A.png"/></div></div></figure><ul class=""><li id="adad" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">价格为零的产品在项目条件为2、3、4、5的产品中所占的百分比较高。这表明，可能有一些用过的物品，如衣服等，人们只是为了捐赠而免费发放。</li></ul><h1 id="3c9d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">8.数据预处理</h1><p id="2baa" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">数据预处理或数据清洗是构建机器学习模型的一个不可或缺的步骤。在这一步中，我们对数据集进行必要的更改，使其适合进一步处理。数据预处理步骤对于我们正在处理的问题或数据集来说是非常具体的。在这里，我们将看到数据清理的特点，特别是这个问题。</p><h2 id="c602" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">8.1名称</h2><p id="9d09" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">对于文本特征，有许多技术用于数据预处理。这些包括去收缩、降低字符、词条化、记号化、词干化、停用词移除等等。在这里，我们做了非常简单的预处理，即去收缩、去除特殊字符、去除停用词和降低文本。它的代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">#注意，解收缩功能的代码取自上面给出的Ref</p></figure><p id="b20b" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir">例子:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/aeb1306c87e468ce4e1e48b97b6e790c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*gBJ5fNe2Rhk2WH0eDHM9Qg.png"/></div></figure><h2 id="fdb4" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">8.2品牌名称</h2><p id="9ba8" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">因此，对于brand_name，不仅完成了基本的文本预处理，而且正如我们之前在EDA中讨论的那样，某些产品的名称中包含brand _ name，因此我们必须提取它们。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><p id="4296" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir">例子:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/59924b5d8a079b6b3a79a5454cd696e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*5lLhwG0QAS-miOiqh5O7SA.png"/></div></figure><blockquote class="pm pn po"><p id="e082" class="ml mm nq lq b lr nl jr mn lt nm ju mo pp nn mq mr pq no mt mu pr np mw mx mb ij bi translated">现在，在从名称中提取brand_names之前，我们有大约42%的值“丢失”,但是在采用这种方法之后，我们将这一数字减少到了27%!！</p></blockquote><h2 id="10b8" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">8.3类别名称</h2><p id="1dda" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在catagory_name中，也遵循相同的方法进行预处理。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><p id="0e24" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir">例子:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ps"><img src="../Images/73f0937db20ab60df014f5a64de7115d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zn_8qkp3i6sUJTFLdfQQ2A.png"/></div></div></figure><p id="72c3" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">完成后，我们将通过在“/”处进行分割，将数据集分为三层。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><p id="6344" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir">例子:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pt"><img src="../Images/ef65ae21826026fdd8ebec09b619a3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lSo9NWPiVjkomwDdACRag.png"/></div></div></figure><h2 id="513a" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">8.4项目_描述</h2><p id="ddae" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">该特征也是需要处理的文本特征。还有一些空值需要注意。以下函数用于相同的目的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><p id="85f4" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated"><strong class="lq ir">举例:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pu"><img src="../Images/d7209db2e98373d6ecaa244d1790ff73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTCWsNJrr_urBEZmbi6cYA.png"/></div></div></figure><p id="d762" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">在这里，我已经展示了训练数据的预处理，测试数据也必须遵循同样的预处理。</p><h1 id="dd58" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">9.基准模型</h1><p id="80fb" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">我们将使用这个模型来比较我们的机器学习模型的性能。我们在这里使用的基准模型是一个简单的平均模型，它根据两个特性“shipping”和“item_conditon”给出平均输出。简而言之，当我们输入shipping (0或1)和item_conditon_id(1到5)时，模型会提取shipping和item_conditon_id相似的所有数据。它取这些点的平均值并输出结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><h2 id="6215" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">拆分数据</h2><p id="3478" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在测试模型之前，让我们将数据集分别以9:1的比例分成训练数据和验证数据。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="6d65" class="my kx iq ns b gy nw nx l ny nz">df_train,df_val = train_test_split(df,test_size=0.1,random_state = 3)<br/>print(df_train.shape)<br/>print(df_val.shape)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/b1f89eedb158fb282c5561b19a833829.png" data-original-src="https://miro.medium.com/v2/resize:fit:244/format:webp/1*8lXDmifNnmbAZGcdn4YdUw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">火车形状</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pw"><img src="../Images/162ead7d64b42fc6ab3886bef89325c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:202/format:webp/1*uiHCWAQwLl4b8clUijsX6w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">验证形状</p></figure><p id="5fbb" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">当在验证数据上测试基准模型时，它提供0.7255的RMSLE值，这成为基准。任何度量值高于该值的模型都表现不佳。</p><h1 id="9853" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">10.首次切割方法</h1><p id="62bb" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">对于第一个cut解决方案，我尝试了不同的机器学习模型，但机器学习最重要的部分是特征化。我遵循了两种类型的特征化。</p><h2 id="2bdf" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">10.1第一种方法</h2><h2 id="9e3e" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">特征工程</h2><p id="7047" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在第一种方法中，我们将尝试保持输出向量的维数较低，以便我们可以更快地训练模型。因此，我们将对分类数据使用顺序编码，对文本数据使用平均Word2Vec。让我们逐一看看:</p><h2 id="44ba" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">分类数据</h2><p id="037f" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">我们知道数据集中的分类数据由shipping、item_condition_id、brand_name、Tier_1、Tier_2、Tier_3组成，其中“shipping”和“item_condition_id”已经正常编码。所以对于剩下的特性，我将使用Sklearn库的OrdinalEncoder功能。</p><p id="cfeb" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">请注意，在验证数据中会有一些未知的类别，我给它们的值是-1。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><h2 id="0c47" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">文本数据</h2><p id="addf" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">对于文本数据，我将连接name和item_description。这实际上没有任何具体原因，只是为了减少维数。您也可以单独展示它们。我也分别尝试了它们，因为向量是密集的向量，需要更多的时间来训练。</p><p id="7f62" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">因此，我在第一部分中使用的文本特征矢量化方法是平均Word2Vec。在这里，我使用Gensim库的Word2Vec功能，并在连接数据(名称+项目描述)的语料库上训练它。</p><p id="e333" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">想法是每个句子在Word2Vec模型的帮助下向量化每个单词，然后取所有这些向量的平均值，这些向量将被视为句子的向量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><h2 id="af30" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">缺少10.1.1.3</h2><p id="5ab1" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">如果品牌名称或名称或项目描述中缺少一个值，此功能将给出1，否则为0。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="e948" class="my kx iq ns b gy nw nx l ny nz">df_train["is_missing"]  =  (df_train.brand_name_processed=="missing") | (df_train.name_processed =="missing")| (df_train.processed_item_description=="missing")</span><span id="a0cf" class="my kx iq ns b gy px nx l ny nz">df_train["is_missing"]  = df_train["is_missing"].astype(int)</span></pre><h2 id="883a" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">堆叠所有特征</h2><p id="7077" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">所有形成的特征水平堆叠在一起。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="6b46" class="my kx iq ns b gy nw nx l ny nz">'''STACKING ALL FEATURES OF TRAIN DATASET'''<br/>x_train = np.hstack((df_train.item_condition_id.values.reshape(-1,1)    ,          df_train.shipping.values.reshape(-1,1) ,\<br/>           df_train.is_missing.values.reshape(-1,1) ,<br/>           train_vec_brand , train_vec_t1 , <br/>           train_vec_t2,train_vec_t3 , train_vec_text))</span></pre><h2 id="08f9" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">建模</h2><h2 id="06bb" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">a.套索</h2><p id="fff0" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">该模型是线性模型，通过l1正则化来减少平方损失。在这里，我为这个模型使用了Sklearn库。该模型是在一系列值上调整的超参数，并根据最佳参数进行训练。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi py"><img src="../Images/ad9e809f0965b557e2e6482e7d2fb74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*UeZbYRrmQ8xfDy82-Bt9EA.png"/></div></figure><p id="6fe4" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">该模型在验证数据上的性能为0.6037，在Kaggle(公共分数)上的测试数据上的性能为0.60476。</p><h2 id="d0d8" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">b.山脉</h2><p id="bf81" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">脊模型也是线性模型，其减少了平方损失，但是具有l2正则化。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/4543f4e21d4bba4882b02455b0873520.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*XMQ8ytuiF7VHNTbcklU3yw.png"/></div></figure><p id="9f37" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">该模型的RMSLE在验证数据上是0.6038，在测试数据Kaggle上是0.6048。</p><h2 id="56bd" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">c.决策图表</h2><p id="8a85" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">顾名思义，决策树使用基于树的模型来预测输出。我这里用的是Sklearn的决策树模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/4a45402590c1469142cc625c11d37b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*6pS6eud6EVis-0ccm6avWQ.png"/></div></figure><p id="f7e7" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">验证数据的RMSLE为0.6353，测试数据的RMSLE为0.63648。显然，与早期的模型相比，决策树的性能并不好。</p><blockquote class="pm pn po"><p id="ef0b" class="ml mm nq lq b lr nl jr mn lt nm ju mo pp nn mq mr pq no mt mu pr np mw mx mb ij bi translated">我也尝试了随机森林的这些功能，但它的训练时间非常长，所以不得不停下来。如果感兴趣的话，你可以在Github知识库上看到完整的代码。</p></blockquote><p id="e418" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">d.轻型GBM</p><p id="8f98" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">集成模型的轻GBM模型功能和训练更快，因此它适用于问题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/1e2dfd89a3714b253e1ff9fe96d6f278.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*-P6Mhw8I46Peu8TRNn7EBw.png"/></div></figure><p id="c506" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">该模型在验证数据上的性能是0.5008，在测试数据上的性能是0.50049(私人Kaggle分数)。</p><h2 id="ed9c" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">10.2第二种方法</h2><h2 id="a023" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">特征工程</h2><p id="a2c6" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在第二种方法中，我们将对分类数据使用一种热编码，对文本数据使用Tfidf。</p><h2 id="3317" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">10.2.1.1分类数据(一个热编码)</h2><p id="59f7" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">对于包括运输在内的所有分类数据，项目条件id、Tier1、Tier2、Tier3是一个热编码。下面的代码用于实现这一点:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><h2 id="0bff" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">文本数据(Tfidf矢量器)</h2><p id="ef8d" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">Tfidf声明“术语频率-逆文档频率”。它由两部分组成，第一部分是“词频”,它是一个单词与句子中单词总数的简单比率，它为句子中出现得越多的单词赋予越多的价值。“逆文档频率”是第二部分，它是总文档数与出现错误的文档数之比。IDF对文档中较罕见的单词给予较高的价值。</p><p id="2554" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">我使用二元模型范围到2，最大特征到50000。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><h2 id="6a19" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">缺少10.2.1.3</h2><p id="fc32" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">如果品牌名称或名称或项目描述中缺少一个值，此功能将给出1，否则为0。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="e3c5" class="my kx iq ns b gy nw nx l ny nz">df_train["is_missing"]  =  (df_train.brand_name_processed=="missing") | (df_train.name_processed =="missing")| (df_train.processed_item_description=="missing")</span><span id="fba7" class="my kx iq ns b gy px nx l ny nz">df_train["is_missing"]  = df_train["is_missing"].astype(int)</span></pre><h2 id="f63c" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">堆叠</h2><p id="14ad" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">类似地，所有特征水平堆叠在一起，形成一个产品的一个向量。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="41c4" class="my kx iq ns b gy nw nx l ny nz">'''STACKING ALL THE FEATURES'''</span><span id="1f1c" class="my kx iq ns b gy px nx l ny nz"># STACKING TRAIN FEATURES<br/>x_train = hstack((train_vec_item_con,train_vec_shipping,<br/>                  train_vec_name,train_vec_brand,<br/>                  train_vec_t1,<br/>                  train_vec_t2,<br/>                  train_vec_t3,<br/>                  df_train.is_missing.values.reshape(-1,1)<br/>                   ,train_vec_desc))</span></pre><h2 id="3c9e" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">型号</h2><h2 id="af4b" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">a.线性回归</h2><p id="148d" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这种线性回归的实现减少了平方损失。这里我用的是Sklearn的线性回归实现。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="4557" class="my kx iq ns b gy nw nx l ny nz">'''TRAINING LINEAR REGERSSION'''</span><span id="fedf" class="my kx iq ns b gy px nx l ny nz">lr = LinearRegression(normalize=True)<br/>lr.fit(x_train,y_train)</span></pre><p id="227e" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">这个简单的模型为验证数据提供了0.4620的性能指标，为测试数据提供了0.4621的性能指标(Kaggle私人评分)</p><h2 id="daf4" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">b.岭模型</h2><p id="65b5" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">具有一个热内化和tfidf特征的脊模型是在各种参数上调谐的超参数。代码部分将保持与上面讨论的相同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/88183f60435df1374f97fdf642040026.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*zMYqFSCmS5THtece52z-wg.png"/></div></figure><p id="b2bc" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">通过对最佳参数的训练，我们在测试数据(Kaggle Private Score)上得到了0.4581和0.45831的验证RMSLE。</p><h2 id="82d2" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">观察结果:</h2><ul class=""><li id="261b" class="lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb oi md me mf bi translated">到目前为止，我们拥有的最佳模型是具有一个热编码和TFIDF特征的脊模型。</li><li id="6a8a" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">对于标签编码和word2vec功能，像Light GBM这样的复杂模型比像lasso、ridge这样的简单线性模型表现得更好。</li><li id="5b2b" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">但是对于Tdidf特征，这些特征变得相对较高，因此线性模型给出了相当不错的性能度量值</li><li id="4616" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">为了更好的性能，我们不得不尝试深度学习模型。</li></ul><h1 id="9709" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">11.基于深度学习的解决方案</h1><p id="99cb" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">深度学习模型在网络的输入和输出层之间使用多个层，这使得它成为解决问题的强大方法。此外，它与人脑的相似性使这一想法的运作具体化了。</p><p id="4018" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">这里我们将使用RNN类型的DL模型。RNN代表递归神经网络，包括基于LSTM或GRU的模型。RNN模型用于文本数据(名称和商品描述)中具有长序列的数据。因此，你可以看到建筑GRU被用于这些功能。</p><h2 id="5360" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">11.1标记和填充</h2><p id="b732" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">在我们向网络提供数据之前，必须对其进行矢量化处理。Keras为矢量化数据提供了嵌入层，但它需要特定格式的输入。为此，我们首先对文本数据进行了标记化。通过标记化，我们将把文本数据转换成数字，这些数字只不过是词汇中单词的索引值，而词汇是通过拟合训练数据来学习的。</p><p id="becf" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">接下来，需要对数据进行填充，使每个数据点的输入长度相同。此代码用于标记和填充。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><h2 id="dcd3" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">11.2架构</h2><p id="c218" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">模型的架构是深度学习实现更高性能的最重要因素。我在这里遵循的架构如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pi pj l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qc"><img src="../Images/d6fc3b8965032e2006d6417cb419d1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rFN_PDw_8nz84TFqvwt7BQ.png"/></div></div></figure><h2 id="b6da" class="my kx iq bd ky mz na dn lc nb nc dp lg lv nd ne li lx nf ng lk lz nh ni lm nj bi translated">11.3培训</h2><p id="bc9f" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">模型的训练是用Adam Optimizer完成的，损失是MSE，我采用的度量是RMSE。还介绍了模型检查点的回调、学习率调度器和提前停止。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="bc98" class="my kx iq ns b gy nw nx l ny nz"># FITTING THE MODEL</span><span id="6eb1" class="my kx iq ns b gy px nx l ny nz">model.fit(x=x_train,y=y_train,validation_data=  (x_val,y_val),epochs=10,batch_size = 100,<br/>callbacks=[save,lr,earlystop])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qd"><img src="../Images/1ed5b46884bdc049398c2a738e0ac33c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZFb7uxMCuEqfa68EESLxA.png"/></div></div></figure><p id="d221" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">请注意，该模型适合10个时期，但由于提前停止回调，它在4个时期后停止。</p><p id="d4fc" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">深度学习模型给我们的性能指标是验证数据0.4316，测试数据0.4331(ka ggle私分)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qe"><img src="../Images/9396169f31250617ea3bcbf080dffb3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yXy8edZEmwr_B3ebgan1OQ.png"/></div></div></figure><h1 id="eb7f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">12.模型比较和结论</h1><p id="3913" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这些是所有模型的性能，实际上显示了从作为基准的基本模型到复杂模型(如深度学习模型)的旅程，每一步都有改进。</p><p id="92a9" class="pw-post-body-paragraph ml mm iq lq b lr nl jr mn lt nm ju mo lv nn mq mr lx no mt mu lz np mw mx mb ij bi translated">它清楚地表明，对于这个问题，深度学习模型比机器学习模型表现得更好。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/78a541f77ed43c2756e9b0fae79a4485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*0DJKkahK4ye57xB6o7L2BA.png"/></div></figure><h1 id="ac79" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">13.部署和预测</h1><p id="033e" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">我已经在AWS上部署了这个模型。要试用该型号，请点击<a class="ae kv" href="http://18.218.104.147:8080/" rel="noopener ugc nofollow" target="_blank">链接</a>。下面是模型工作的视频和对其中一个产品的预测。请在评论中告诉我你的想法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qg pj l"/></div></figure><h1 id="4920" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">14.未来的工作</h1><p id="9f71" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">经过所有这些努力，我认为我已经达到了一个不错的性能指标值，但总有改进的余地。以下是我未来将努力的一些想法。</p><ul class=""><li id="50b7" class="lo lp iq lq b lr nl lt nm lv of lx og lz oh mb oi md me mf bi translated">为机器学习模型执行更多功能工程技术。</li><li id="9762" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">使用Tfidf功能尝试更复杂的模型。</li><li id="a010" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">尝试基于CNN的模型。</li><li id="ffe9" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated">在深度学习模型中尝试基于Tfidf/CountVectorizer的功能。</li></ul><h1 id="443a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">15.Github知识库和LinkedIn</h1><p id="cc2c" class="pw-post-body-paragraph ml mm iq lq b lr ls jr mn lt lu ju mo lv mp mq mr lx ms mt mu lz mv mw mx mb ij bi translated">这里是<a class="ae kv" href="https://github.com/pushapgandhi/Mercari_Price_Prediction" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>参考完整代码并在LinkedIn <a class="ae kv" href="https://www.linkedin.com/in/pg1995/" rel="noopener ugc nofollow" target="_blank">上与我联系点击这里</a>。</p><h1 id="7b93" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">16.参考</h1><ul class=""><li id="e677" class="lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb oi md me mf bi translated"><a class="ae kv" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></li><li id="ecdd" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated"><a class="ae kv" href="https://www.kaggle.com/c/mercari-price-suggestion-challenge" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/mercari-price-suggestion-challenge</a></li><li id="18bd" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated"><a class="ae kv" href="https://www.youtube.com/watch?v=QFR0IHbzA30&amp;t=2010s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=QFR0IHbzA30&amp;t = 2010s</a></li><li id="7816" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb oi md me mf bi translated"><a class="ae kv" href="https://gh.mltrainings.ru/presentations/LopuhinJankiewicz_KaggleMercari.pdf" rel="noopener ugc nofollow" target="_blank">https://GH . mltraints . ru/presentations/lopuhinjankeiewicz _ kagglemercari . pdf</a></li></ul></div></div>    
</body>
</html>