<html>
<head>
<title>Fast Feature Engineering in Python: Tabular Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的快速要素工程:表格数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fast-feature-engineering-in-python-tabular-data-d050b68bb178?source=collection_archive---------12-----------------------#2021-04-11">https://towardsdatascience.com/fast-feature-engineering-in-python-tabular-data-d050b68bb178?source=collection_archive---------12-----------------------#2021-04-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0d3f" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">特征工程</h2><div class=""/><div class=""><h2 id="570c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使您的表格数据更适合输入ML系统</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8b6e113d9fc84a98725960960d41b6e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vGL3OGrqSy2jmpl_"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">亚历山大·辛恩在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><blockquote class="lf lg lh"><p id="202f" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">作为数据科学家，我们的工作是从噪音中提取信号。”</p><p id="bf2e" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq"> ― </em> <a class="ae le" href="https://www.linkedin.com/in/dtunkelang/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">丹尼尔·唐克朗</em> </a> <em class="iq">，顾问/顾问</em></p></blockquote><p id="4cf7" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">通常被称为数据科学中的秘方，特征工程可能是数据清理工作流程中最重要的一步。</p><p id="7576" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">您的特征越好，模型的预测能力就越强。</p><p id="6857" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">在本文中，我们将探讨使用Python中流行的数据科学库从数据中有效地设计和提取要素的许多方法。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="6469" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">表格数据是数据科学从业者使用的最常见的数据类型。在这种格式中，数据以行和列的形式排列。</p><p id="575b" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们来看看表格数据面临的一些常见问题，以及如何解决。</p><h1 id="d4a4" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">🔢处理数字数据</h1><p id="9e86" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">让我们使用<code class="fe nm nn no np b">sklearn.datasets</code>模块创建一个具有10000行和25个特征的合成数据集。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/2b58c854f59d9dad2452f3b334a1974f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tADgjbQ_qyh7gKvpfVN84Q.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/b3ee8bdb4624725b0e6394054f371bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ALzsW0dp3FAf0Kduqrelww.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">X_df的内容</p></figure><h2 id="1804" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated"><strong class="ak">缩放、标准化和规范化</strong></h2><p id="a773" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">训练线性模型(如线性/逻辑回归和SVM)时，缩放数据集会对模型性能产生巨大影响。</p><p id="df06" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">因为这些模型是使用距离度量来优化的，缩放确保具有<strong class="ll ja">较大值的特征不会支配</strong>模型拟合的结果。</p><p id="b2f7" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">在我们的第一种缩放方法中，我们将使用由<code class="fe nm nn no np b">sklearn</code>提供的<code class="fe nm nn no np b">MinMaxScaler</code>来将每个特征缩放到值<em class="lk"> -1 </em>和<em class="lk"> 1 </em>之间。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/f83ac769fb919256892fc3ea590d364f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gaG36RDB1lcZdEl0wULXng.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/870407cef93088b599381a0baa372fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3T6T4Nd-hObYnaLZ2FBVJg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">X_df的内容</p></figure><p id="5fa2" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated"><code class="fe nm nn no np b">MinMaxScaler</code>接受一个名为<code class="fe nm nn no np b">feature_range</code>的参数，用户可以在其中指定所需的范围。根据您的特征是否具有正值，保持范围为<em class="lk"> -1 </em>到<em class="lk"> 1 </em>或<em class="lk"> 0 </em>到<em class="lk"> 1 </em>被认为是最佳实践。</p><p id="ddbf" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">在引擎盖下，这是正在计算的:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/8ed5acf3db00065601b3d6145170322c.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*am0GOIhPKTypjwj0qcsfpw.png"/></div></figure><p id="08b9" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">其中特征中的元素与特征的最小值的差除以特征的范围<em class="lk"/>。</p><p id="3a17" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">另一种形式的缩放被称为<strong class="ll ja">标准化</strong>，其中每个特征被转换为具有平均值<em class="lk"> 0 </em>和标准偏差<em class="lk"> 1。</em>这对于<strong class="ll ja">正常发布</strong>我们的功能非常有用。</p><p id="0cb5" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated"><code class="fe nm nn no np b">StandardScaler</code>模块可用于标准化我们的功能:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/cd63e74e646f349997261056560dd97a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sCRQNXScov_o0QlHe7J0mA.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/44871d21d8c7ec3d0f6010a99a9a2026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37rynkm_9I8SEDmfaiw_Gg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">X _ df _标准化的内容</p></figure><p id="b1d7" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">标准化工作如下:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/1efdd78f8ba6a7054e082ef85a52f4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/format:webp/1*BUizBxIQih1MSt0TIo0A_g.png"/></div></figure><p id="0b1c" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">其中特征的每个单独元素减去特征集的<em class="lk">均值</em>并除以<em class="lk">标准差</em>。</p><p id="9952" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">到目前为止，我们已经研究了在特征级操作的缩放方法。像<strong class="ll ja">单位长度</strong> <strong class="ll ja">归一化</strong>这样的方法也支持跨观测值的缩放。</p><p id="d555" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">当数据具有大量等效特征时，如<strong class="ll ja">文本数据</strong>，这种类型的标准化非常有用，因为每个单词都被视为一个特征。</p><p id="d6b7" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated"><code class="fe nm nn no np b">Normalizer</code>缩放每个观察值，使其单位范数长度为1。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/1e9b5a51b85e8dc1f7f2f8f720d1341f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pStnuKXYxxldwJNP9TQcVg.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/3f06c3144f1b42c1549ce7ff08a2a4b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtyr-2ST3GTOHaQAANN0aw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">X_df_normalized内容</p></figure><p id="5f3e" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">以下是归一化的公式:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi of"><img src="../Images/56952500fac9a0866777c73cac3fd708.png" data-original-src="https://miro.medium.com/v2/resize:fit:172/format:webp/1*t9Xn_x2MyjoRyZbAqQjYyw.jpeg"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi og"><img src="../Images/5e84aedb3f50efdf92e8edbd4fa6b6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*8sMIqDhKJPD9Wxjo31FQVQ.png"/></div></figure><p id="54af" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">分母是观察值的<em class="lk"> l2 </em> <a class="ae le" href="https://en.wikipedia.org/wiki/Norm_(mathematics)" rel="noopener ugc nofollow" target="_blank"> <em class="lk">范数</em> </a>，它是每个特征中观察值的<strong class="ll ja">平方和</strong>的平方根。</p><h2 id="5cfe" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated"><strong class="ak">创建多项式特征</strong></h2><p id="da30" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">两种情况下可能需要多项式要素:</p><ol class=""><li id="6560" class="oh oi iq ll b lm ln lp lq mf oj mg ok mh ol me om on oo op bi translated">当您怀疑特征与目标变量有<strong class="ll ja">非线性关系</strong>时</li><li id="0265" class="oh oi iq ll b lm oq lp or mf os mg ot mh ou me om on oo op bi translated">当您怀疑特性相互依赖时(交互)。</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/a242c0952b4667859d6fb4a8efb9ebea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8kPBStpnSp6kwUyyniuqA.png"/></div></div></figure><pre class="kp kq kr ks gt ov np ow ox aw oy bi"><span id="093c" class="ns mq iq np b gy oz pa l pb pc">(10000, 350)</span></pre><p id="e054" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们可以清楚地看到，我们最初只有25个特征的数据现在有350个了！😮</p><blockquote class="lf lg lh"><p id="b655" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">注意:构建多项式特征将导致<strong class="ll ja">特征爆炸</strong>，因此请确保使用良好的特征选择实践。</p></blockquote><h2 id="7825" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated"><strong class="ak">变换特征</strong></h2><p id="4117" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">Scikit Learn还使创建自定义变形器以应用于一个或多个功能变得非常容易。你所要做的就是定义一个函数，并将它传递给<code class="fe nm nn no np b">FunctionTransformer</code>的一个实例。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/81f90cca37f7a83825937ebc64445048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ic8IJw-jNZ0jRzuwic8TCQ.png"/></div></div></figure><p id="0a8a" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">如果您正在使用Pandas数据框，您可以使用数据框可用的<code class="fe nm nn no np b">.apply</code>方法来转换您的数据，而不是使用<code class="fe nm nn no np b">FunctionTransformer</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/17723bb22f0d61490f00aff5937a217e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oF-5KfgfMY0nGH8nxWNDgQ.png"/></div></div></figure><h2 id="3ff1" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">扔掉</h2><p id="3be1" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">宁滨是一种像处理分类变量一样处理数值变量的方法。宁滨涉及到将我们的数字数据分解成<strong class="ll ja">个离散的单元</strong>。</p><p id="8a1b" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">Numpy有一个名为<code class="fe nm nn no np b">.digitize</code>的方法，可以帮助轻松创建媒体夹:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/f188477aba142739f5d9c1a287f55ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A2mnYENiqqUZzm2zlF0Vww.png"/></div></div></figure><p id="7e4e" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">如果您正在处理数据帧，您也可以使用Pandas提供的<code class="fe nm nn no np b">.cut</code>方法来创建bin:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/2854547482da3d55152f5087707e7350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mvXqZBbVJCNuzyDsWpw68Q.png"/></div></div></figure><blockquote class="lf lg lh"><p id="08d9" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">注意:Pandas输出与Numpy输出略有不同。在Pandas中，我们必须指定数值数据的下限<strong class="ll ja">和上限</strong>，以避免生成未知值。Pandas输出还以间隔的形式输出数据，这与Numpy输出相反，后者将每个值分配给一个bin号。</p></blockquote></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="76e8" class="mp mq iq bd mr ms pe mu mv mw pf my mz kf pg kg nb ki ph kj nd kl pi km nf ng bi translated">👫处理分类数据</h1><p id="4fe6" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">到目前为止，我们只研究了数字数据的处理。分类数据可以大致分为:</p><ul class=""><li id="4022" class="oh oi iq ll b lm ln lp lq mf oj mg ok mh ol me pj on oo op bi translated">名义变量——有两个或两个以上类别，但缺乏任何排序的变量。例如，<em class="lk">男孩，女孩</em>可以称为一个名义变量</li><li id="66f4" class="oh oi iq ll b lm oq lp or mf os mg ot mh ou me pj on oo op bi translated">序数—具有特定关联顺序的变量。例如，一个与温度相关的特征具有类别:<em class="lk">非常冷、冷、暖、热、非常热</em>。</li></ul><p id="62cd" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">由于机器学习算法只理解数字，而不理解其他任何东西，因此我们必须应用适当的转换，以便我们的算法吸收数据。</p><p id="cb5e" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们使用另一个来自著名的UCI机器学习库的关于汽车的数据集。这里可以找到<a class="ae le" href="https://archive.ics.uci.edu/ml/machine-learning-databases/autos/imports-85.data" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pk"><img src="../Images/d2f18c4e47828d5fc3ce9d75b03d1953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HAYtHbTBKo5inc-fO4vHQ.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/14b098a55965061d59751336219f577c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JytBTPdl1-xNlejW429DKw.png"/></div></div></figure><h2 id="5bbb" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated"><strong class="ak">标签编码</strong></h2><p id="5891" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">标签编码是一种编码形式，我们<strong class="ll ja">将每个类别编码为一个数字</strong>。这种编码在基于<strong class="ll ja">树的算法</strong>中特别有用。</p><p id="20aa" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们看看如何将标注编码应用于数据集的一个要素:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/bdd9d297d634a3de031c144166cf56a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LK0COQnr7OmFj_QO0Ikt1g.png"/></div></div></figure><p id="443e" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们看到特性<code class="fe nm nn no np b">engine_type</code>有7个不同的类别。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/bef2148ea28b8ebb99f5c0d11033332b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmFog8lSk-tA5sZQEJQ7-w.png"/></div></div></figure><p id="6a98" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">在创建了一个将每个类别映射到一个数字的字典之后，我们可以使用Pandas提供的<code class="fe nm nn no np b">.map</code>方法轻松地转换这个特性。</p><p id="aba0" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">对于中级Python开发人员，您可能会发现使用<strong class="ll ja">字典理解</strong>以编程方式创建映射字典更加直观:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/165d0d236d4a99f6d8e7f5df7c947a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-Ic3dODpZQfdMemAk0XaQ.png"/></div></div></figure><p id="5e97" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">标签编码的另一种方式是<code class="fe nm nn no np b">sklearn</code>提供的开箱即用解决方案:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/621dbc5b3d882eba4231eb3e4c240377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FyzbVm32Pa7fPBWPF1JXSQ.png"/></div></div></figure><p id="caa5" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">当我们对顺序变量进行编码时，标签编码是我们选择的编码方式。</p><blockquote class="lf lg lh"><p id="0b91" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">注意:确保编码与类别的顺序相称。</p></blockquote><h2 id="4ff4" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">一个热编码</h2><p id="de67" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">一种热编码技术是我们将每个类别编码为一个二进制值<strong class="ll ja">的向量</strong>，向量的长度是我们特征中唯一类别的数量。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/8cd026f6b615e59f158b82fd6f4c8254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnmpSdK-6hAQJdTUBFxcnA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">一个热点编码示例</p></figure><p id="949f" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">尽管一键编码可以<strong class="ll ja">增加我们数据中的特征数量</strong>，但是大多数列将会<strong class="ll ja">稀疏</strong>。</p><p id="955a" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">当我们使用基于<strong class="ll ja">回归的</strong>模型时，这种类型的编码特别有用。</p><p id="8d67" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">就像这里的大多数例子一样，<code class="fe nm nn no np b">sklearn</code>也有一个现成的热编码实现:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi po"><img src="../Images/33e66e9c6ba770a30c315af1fb1decf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_jWnq92vFa2xXXBzEmFZg.png"/></div></div></figure><blockquote class="lf lg lh"><p id="8a37" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">注:<code class="fe nm nn no np b">OneHotEncoder</code>模块有一个名为<code class="fe nm nn no np b">sparse</code>的参数，允许用户校准编码器的输出。</p><p id="f3e8" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">默认情况下,<code class="fe nm nn no np b">sparse</code>被设置为<code class="fe nm nn no np b">true</code>,因此输出数组是一个消耗较少内存的稀疏数组。</p></blockquote><h2 id="83ab" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated"><strong class="ak">将分类变量转换为数值变量</strong></h2><p id="7f20" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">一个非常简单的方法是简单地获得每个类别的计数，然后用它替换类别。</p><p id="dca0" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们可以结合熊猫提供的<code class="fe nm nn no np b">groupby</code>和<code class="fe nm nn no np b">transform</code>方法来实现这一点:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/48741fee8ae32d3b877ba5a359ae0748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrzrWpNjte7teuDiU6RLCg.png"/></div></div></figure><p id="1699" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">您可能还想按多列分组并使用计数。：</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/9dc4f38e662153e199bbac4697d153d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i88BKnImhSYNhQK3ecoM0w.png"/></div></div></figure><h2 id="714d" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">创建新的分类特征</h2><p id="6ef6" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">这是一个我不知道的技巧，直到我最近读了Kaggle特级大师Abhishek Thakur写的一本名为“<em class="lk">接近(几乎)任何机器学习问题</em>”的书。</p><p id="f200" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">通过Pandas，从现有的分类特征创建新的分类特征非常容易。</p><p id="ab34" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">例如，我们可以从两个现有特征<code class="fe nm nn no np b">fuel_type</code>和<code class="fe nm nn no np b">engine_type</code>中创建一个名为<code class="fe nm nn no np b">fuel_type_engine_type</code>的新特征，如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pp"><img src="../Images/7ef6df5b6507f033168c1ab4585cc452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dcEe1hgKbPe3xNKfxMmJbg.png"/></div></div></figure><p id="1847" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们看到，通过将特征转换为类型<em class="lk">字符串</em>，我们可以利用<strong class="ll ja">运算符重载</strong>和<strong class="ll ja">矢量化运算</strong>来优雅地创建新特征。</p><p id="65a6" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">此技巧可用于使用多列分类数据创建多个要素。</p><blockquote class="lf lg lh"><p id="0b80" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">注意:在决定组合哪些功能时，了解一些关于您正在处理的数据的领域知识可能会有所帮助。这将帮助您构建有意义的功能，而不是构建多余的功能。</p></blockquote></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="3888" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">📈处理时间序列数据</h2><p id="91f1" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">我知道时间序列数据也许应该归入数字数据的范畴。然而，由于处理这类数据的技术与数字数据相比略有不同，我认为应该有一个单独的部分。</p><p id="dbcc" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们使用约翰·霍普金斯大学CSSE提供的新冠肺炎数据来演示如何轻松地在时间序列数据上构建要素:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/0f098a356dfc6960187ed044e2b3d5ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wywr433eEUKUDCkwqB8JCQ.png"/></div></div></figure><blockquote class="lf lg lh"><p id="d998" class="li lj lk ll b lm ln ka lo lp lq kd lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">注意:这里我们看到“Date”列有字符串格式的日期。为了将这些转换成日期时间特性，我们将<code class="fe nm nn no np b">pd.to_datetime</code>应用于每个观察值</p></blockquote><h2 id="6995" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">提取特征</h2><p id="8ec6" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">从日期时间对象中提取特征非常容易。我们可以使用<code class="fe nm nn no np b">.dt</code>属性来访问序列中的日期时间值，并返回多个新特性:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/b6e09b671bb08f6abf79f33de1e11574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PSCPQ1-tApg5tUMkkBcBgw.png"/></div></div></figure><h2 id="d432" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">汇总统计数据</h2><p id="91bb" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">我从Abhishek Thakur的书中学到的另一个技巧是如何将提取的时间序列特征与目标变量的聚合特征结合起来。</p><p id="961b" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">在这种方法中，我们使用从时间序列数据中提取的特征和目标变量特征(“已确认”)来创建每个国家的综合特征:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/9d8c1b8259b4d50bc9cb40ee3167a301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1w_udsvwz5VP--MB-gJ1TQ.png"/></div></div></figure><p id="b07c" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">然后，我们可以使用<code class="fe nm nn no np b">Country/Region</code>特性作为键，将这个表与我们的原始表合并。</p><h2 id="a05c" class="ns mq iq bd mr nt nu dn mv nv nw dp mz mf nx ny nb mg nz oa nd mh ob oc nf iw bi translated">滞后特征和移动平均线</h2><p id="21f5" class="pw-post-body-paragraph li lj iq ll b lm nh ka lo lp ni kd lr mf nj lu lv mg nk ly lz mh nl mc md me ij bi translated">如果您想在当前观察中添加<strong class="ll ja">过去的信息</strong>，滞后特性尤其有用。</p><p id="0d76" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">熊猫图书馆提供了一个名为<code class="fe nm nn no np b">.shift</code>的方法来开箱即用:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/3c9806634aeb078ca5a1c7b6655759a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8dZ57dZLK4zdF3BXt2gjg.png"/></div></div></figure><p id="3880" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">移动平均线是不同数据子集的一系列平均线。通过从短期波动(如股票市场价格)中“去噪”时间序列数据，它们在平滑趋势方面特别有用。</p><p id="f257" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">类似于创建滞后特征，为了创建移动平均线，我们可以在Pandas中使用<code class="fe nm nn no np b">.rolling</code>方法。<code class="fe nm nn no np b">.rolling</code>方法采用一个名为<code class="fe nm nn no np b">window</code>的参数，在这里您可以指定由数字组成的窗口的大小来计算平均值。</p><p id="6152" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">然后我们可以在这个窗口上应用<code class="fe nm nn no np b">.mean</code>函数来计算移动平均值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/73ccd6600a1f4b344aa5a5cc60f98f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCQnvMt3dHB_z8jdxvFG5g.png"/></div></div></figure><p id="fec4" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">通过一个名为tsfresh的库，可以为时间序列数据创建更多的特性。这里我就不深究了。你可以在这里阅读tsfresh <a class="ae le" href="https://tsfresh.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">的文档。</a></p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="507a" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">因此，我们已经看到了许多设计、提取和转换我们现有特征的方法，以创建新的有意义的特征。我希望你们都喜欢这篇文章😄</p><p id="cee0" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我知道我还没有介绍如何处理图像和文本数据。请放心，将来也会有关于如何处理这些问题的文章！✊</p><p id="0aed" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">如果您想了解如何处理数据集中的缺失值，请点击此处查看本文:</p><div class="pq pr gp gr ps pt"><a rel="noopener follow" target="_blank" href="/data-cleaning-series-with-python-part-1-24bb603c82c8"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd ja gy z fp py fr fs pz fu fw iz bi translated">Python数据清理系列</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">回到基础——处理缺失值</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">towardsdatascience.com</p></div></div><div class="qc l"><div class="qd l qe qf qg qc qh ky pt"/></div></div></a></div><p id="0075" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">最后，我强烈建议您阅读这两本书，我发现它们在学习特征工程时非常有用:</p><div class="pq pr gp gr ps pt"><a href="https://www.amazon.in/Approaching-Almost-Machine-Learning-Problem-ebook/dp/B089P13QHT" rel="noopener  ugc nofollow" target="_blank"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd ja gy z fp py fr fs pz fu fw iz bi translated">接近(几乎)任何机器学习问题</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">拿到这本书已经11天了。我刷新了这么多话题(带代码)，学到了很多新的。我希望…</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">www .亚马逊. in</p></div></div><div class="qc l"><div class="qi l qe qf qg qc qh ky pt"/></div></div></a></div><div class="pq pr gp gr ps pt"><a href="https://www.amazon.in/Machine-Learning-Python-Cookbook-Preprocessing-ebook/dp/B07BC3LFKT" rel="noopener  ugc nofollow" target="_blank"><div class="pu ab fo"><div class="pv ab pw cl cj px"><h2 class="bd ja gy z fp py fr fs pz fu fw iz bi translated">Python机器学习指南:从预处理到深度学习的实用解决方案</h2><div class="qa l"><h3 class="bd b gy z fp py fr fs pz fu fw dk translated">Python机器学习指南:从预处理到深度学习的实用解决方案</h3></div><div class="qb l"><p class="bd b dl z fp py fr fs pz fu fw dk translated">www .亚马逊. in</p></div></div><div class="qc l"><div class="qj l qe qf qg qc qh ky pt"/></div></div></a></div><p id="671f" class="pw-post-body-paragraph li lj iq ll b lm ln ka lo lp lq kd lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">下次见，再见！✋</p></div></div>    
</body>
</html>