<html>
<head>
<title>Stop saving your Data frame in CSV format</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止以CSV格式保存数据框</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stop-saving-your-data-frame-in-csv-format-7823d3873ba2?source=collection_archive---------5-----------------------#2021-06-20">https://towardsdatascience.com/stop-saving-your-data-frame-in-csv-format-7823d3873ba2?source=collection_archive---------5-----------------------#2021-06-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="392b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用各种数据格式进行读取和保存操作的基准时间比较</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ffb102031d9c44ce0156f8f420773127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ad-bfbBQPGoRB6z2wn5Tug.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1841158" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/pexels-2286921/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1841158" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><p id="6a78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据科学就是与数据打交道。整个数据科学模型开发流程包括数据争论、数据探索、探索性数据分析、特征工程和建模。读取和保存中间文件是模型开发管道中的一项常见任务。数据科学家通常喜欢以CSV格式读取和保存熊猫的数据帧。处理小规模或中等规模的数据非常容易，不需要太多的开销，但当处理大规模数据集时，由于资源的限制，工作流会变慢。</p><p id="4109" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CSV、Excel或其他文本文件格式在处理大型数据时失去了吸引力，或者您的工作流涉及频繁的读取和保存操作。有各种二进制数据格式可以优于CSV文件格式，熊猫包支持使用这种数据格式。在本文中，我们将比较各种数据格式的内存消耗、保存和读取操作次数，并进一步总结每种用例可以使用的数据格式。</p><h1 id="7128" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">要比较的数据格式:</h1><p id="c131" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们将比较下面提到的<strong class="lb iu"> <em class="ms"> 8种数据格式</em> </strong>的指标，包括<strong class="lb iu"> <em class="ms">与熊猫</em></strong><strong class="lb iu"><em class="ms">的读取时间，与熊猫</em></strong><strong class="lb iu"><em class="ms">的节省时间，以及</em> </strong>的磁盘内存消耗。</p><ul class=""><li id="bb3c" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">CSV(逗号分隔值)</li><li id="1ea0" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">压缩CSV</li><li id="d4f2" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">JSON</li><li id="2f12" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">泡菜</li><li id="c34f" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">压缩泡菜</li><li id="f3f9" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">镶木地板</li><li id="c7ba" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">HDF</li><li id="f75c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">羽毛</li></ul><h2 id="31b5" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">数据:</h2><blockquote class="nt nu nv"><p id="0af1" class="kz la ms lb b lc ld ju le lf lg jx lh nw lj lk ll nx ln lo lp ny lr ls lt lu im bi translated">我将使用来自Kaggle 的<a class="ae ky" href="https://www.kaggle.com/c/nyc-taxi-trip-duration/data" rel="noopener ugc nofollow" target="_blank">纽约市出租车持续时间数据集来比较基准数据，该数据集有1，458，644条记录和12个特征。</a></p></blockquote><h1 id="6b26" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">基准:</h1><div class="kj kk kl km gt ab cb"><figure class="nz kn oa ob oc od oe paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/12db80e6f2f811cd95ac2ebb8387d92a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*wYEVa7wPosyD8Zc9CjxiNA.png"/></div></figure><figure class="nz kn of ob oc od oe paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/da5469be06960b77f0dd3b25c5974735.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*_xmL1Bx9vLrrkstjz8Dscw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk og di oh oi translated">(图片由作者提供)，<strong class="bd oj">左:</strong>读取和保存时间对比(秒)，<strong class="bd oj">右:</strong>内存消耗(MB)</p></figure></div><h2 id="b9d1" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">建议:</h2><p id="8d20" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">通过观察上述每种文件格式的读取和保存操作以及内存消耗的基准数，我们可以针对不同的用例遵循以下建议:</p><ul class=""><li id="97d4" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">要保存会话之间的数据或中间文件，请使用<strong class="lb iu"> <em class="ms">【泡菜】</em> </strong>、<strong class="lb iu"> <em class="ms">羽毛</em> </strong>或<strong class="lb iu"> <em class="ms">拼花</em> </strong>格式。<strong class="lb iu">酸洗</strong>为最优先推荐，因为它的读数最低，节省时间。</li><li id="aba0" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">要以最小的大小保存数据或优化内存消耗，请使用压缩pickle、parquet和压缩CSV格式。最推荐使用<strong class="lb iu"> <em class="ms">压缩泡菜</em> </strong>，因为它的内存消耗最少(比CSV格式优化了78%)。</li><li id="9744" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">压缩pickle格式占用的内存最少，但是在保存数据时需要很多时间。人们可以使用<strong class="lb iu"> <em class="ms">拼花</em> </strong>格式，这种格式具有相对更快的读取和节省时间，并且比标准CSV格式优化了70%。</li><li id="b1b1" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">要保存非常大的数据帧，使用<strong class="lb iu"> <em class="ms"> HDF </em> </strong>格式。</li><li id="cbbe" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">要读取不支持其他格式的另一个平台(非Python)上的数据，使用<strong class="lb iu"> <em class="ms"> CSV </em> </strong>，<strong class="lb iu"> <em class="ms">压缩CSV </em> </strong>格式<strong class="lb iu">。</strong></li><li id="0491" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">要使用Excel、Google Sheets、记事本查看和观察数据，请使用<strong class="lb iu"> <em class="ms"> CSV </em> </strong>格式。</li></ul><h1 id="3048" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论:</h1><p id="b447" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们讨论了可用于保存原始数据和中间数据的8种数据格式，并比较了基准时间数和内存消耗。上面讨论的建议是通过观察基准数字和领域知识得出的。没有遵循特定数据格式的经验法则，但它取决于用例。</p><p id="9cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拼花、压缩泡菜、压缩CSV、羽毛数据格式可用于优化数据的内存消耗。与标准CSV格式相比，使用这些文件格式可以优化高达78%的内存。</p><p id="41c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pickle、Parquet、Feather文件格式优于标准CSV格式，因为它们具有更快的读取和保存能力。</p><p id="797b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">读取熊猫数据框中的数据后，可以通过降级每个要素的数据类型来优化内存使用。阅读下述文章中的<a class="ae ky" rel="noopener" target="_blank" href="/optimize-pandas-memory-usage-while-reading-large-datasets-1b047c762c9b">以了解实现和用法:</a></p><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/optimize-pandas-memory-usage-while-reading-large-datasets-1b047c762c9b"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">为大型数据集优化Pandas的内存使用</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">有效利用数据类型来防止内存崩溃</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div><h1 id="7e6e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考资料:</h1><p id="fa74" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">[1]熊猫文献:【https://pandas.pydata.org/docs/reference/io.html T42】</p><blockquote class="pc"><p id="94cf" class="pd pe it bd pf pg ph pi pj pk pl lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>