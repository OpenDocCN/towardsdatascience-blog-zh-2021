<html>
<head>
<title>How To Get Tables From Websites Into Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将网站上的表格转换成熊猫数据框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-get-tables-from-websites-into-pandas-dataframes-e82bd8a0ac59?source=collection_archive---------27-----------------------#2021-06-04">https://towardsdatascience.com/how-to-get-tables-from-websites-into-pandas-dataframes-e82bd8a0ac59?source=collection_archive---------27-----------------------#2021-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cd09" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从网上获取数据的简单方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c412b3009bafa1dc0dd39dc92655f591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*brW7bvtv5PzbKXla"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@mike_van_den_bos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迈克·范·登博斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="70ee" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">渴望网站上的表格</h1><p id="c67a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设你正在阅读一个维基百科页面，页面上有一个很大的数据表。灵感来了，这正是你可以用在Python项目中的东西。但是如何把它放到一个熊猫的数据框架中，以便你能操作它呢？谢天谢地，你可以用Pandas <code class="fe mn mo mp mq b">read_html()</code>功能直接从网上导入表格！</p><p id="e48f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><strong class="lt iu">以本文为例让我们使用</strong> <a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_best-selling_music_artists" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">维基百科页面的【畅销音乐艺术家排行榜】</strong> </a> <strong class="lt iu">。本页包含了一些很好的表格，可能会用于项目分析。</strong></p><h1 id="21d3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">网站上的表格元素</h1><p id="9d2a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Pandas中的<code class="fe mn mo mp mq b">read_html()</code>函数通过在网站的html中查找表格元素来工作。让我们通过查看Wikipedia页面上第一个表的代码来看看这意味着什么。如果我们右键单击第一个表格的第一个单元格，并单击“Inspect”选项，该站点的代码将在一个框中弹出。在这段代码中，我们将看到这个表被编码为一个<code class="fe mn mo mp mq b">&lt;table&gt;</code>元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/03583f02073f5029eff72f2b5dda9600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*EOc6icsb_I6kdK9FfDjaqQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">查看表格的代码(图片由作者创建)</p></figure><p id="ffdc" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">查看表格的扩展代码，您可以看到各种其他元素，如表格标题(<code class="fe mn mo mp mq b">&lt;thead&gt;</code>)编码为一行，每个标题(<code class="fe mn mo mp mq b">&lt;th&gt;</code>)都有相应的格式。然后您可以看到表体开始(<code class="fe mn mo mp mq b">&lt;tbody&gt;</code>)，在这里输入每一行(<code class="fe mn mo mp mq b">&lt;tr&gt;</code>)，并为表的每个单元格添加各种数据(<code class="fe mn mo mp mq b">&lt;td&gt;</code>)。Pandas使用html代码的这些元素来计算数据应该如何放入数据帧中。</p><p id="ad2d" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">我鼓励您在查看自己感兴趣的站点时，使用灰色箭头进一步扩展代码。更熟悉html以了解熊猫如何解析html并将其转换成数据帧是很有用的。</p><h1 id="c1c4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">将数据带入熊猫体内</h1><p id="7a0d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们对它的工作原理有了一点了解，让我们实际使用<code class="fe mn mo mp mq b">read_html()</code>函数。这非常简单，因为URL只是作为字符串传递给函数。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="7b01" class="nb la it mq b gy nc nd l ne nf">import pandas as pd</span><span id="c95a" class="nb la it mq b gy ng nd l ne nf">url = '<a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_best-selling_music_artists" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/List_of_best-selling_music_artists</a>'</span><span id="b3ec" class="nb la it mq b gy ng nd l ne nf">pd.read_html(url)</span></pre><p id="6673" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">在我们的例子中，返回的是一个数据帧列表。它返回一个列表，因为这个Wikipedia页面上有几个表格元素。通过索引结果，我们可以检查列表中的每个数据帧。第一个dataframe是页面上的第一个表格，用于销售了2.5亿张或更多唱片的艺术家。我们可以将它赋给一个变量，然后像处理其他数据帧一样处理它。下面是代码的样子:</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="88b4" class="nb la it mq b gy nc nd l ne nf">url = '<a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_best-selling_music_artists" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/List_of_best-selling_music_artists</a>'</span><span id="0b95" class="nb la it mq b gy ng nd l ne nf">250_plus = pd.read_html(url)[0]</span></pre><p id="6fdb" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">这是生成的数据帧的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/b1e6682f08b40417e17d19336e85dd8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wax5Ukhaa17nJUwOPcusZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">结果数据帧(由作者创建的图像)</p></figure><p id="1e8f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">在我们的例子中，Pandas甚至能够使用上面的html代码的表格标题元素来解析列标题。如果我们想把文件保存到我们的电脑上，我们可以使用代码<code class="fe mn mo mp mq b">250_plus.to_csv(‘250_plus.csv’)</code>，瞧！现在，我们已经从网站上获得了一个保存了表格数据的csv文件。</p><h1 id="9198" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">收尾工作</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/88343e4406772f6103b9201c8a62fcfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MATHFLq4ISHEI6J6"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="7e9d" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">预计这种方法需要一定程度的清洁。例如，在我们的例子中，将所有的表合并成一个表是有意义的。这意味着我们需要浏览从网站创建的数据帧列表，为我们想要的每个数据帧创建一个单独的变量，并手动组合它们。</p><p id="b849" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">很多时候，您可能还会发现数据解析不那么清晰，并且存在头、空值等问题。如果使用<code class="fe mn mo mp mq b">read_html()</code>功能证明任务很困难或不可能，那么你可以使用web scraper来代替。通过查看html元素，您通常可以预测数据传输的好坏。但是在必须建立网页抓取功能之前，看看<code class="fe mn mo mp mq b">read_html()</code>功能是否有效总是值得一试的。</p><p id="608f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">使用该功能时，不要忘记查看<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank"> Pandas文档</a>以获得更多参数或帮助！</p></div></div>    
</body>
</html>