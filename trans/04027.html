<html>
<head>
<title>Anomaly Detection with GESD (Generalized Extreme Studentized Deviate) in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中基于GESD的异常检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anomaly-detection-with-generalized-extreme-studentized-deviate-in-python-f350075900e2?source=collection_archive---------7-----------------------#2021-04-05">https://towardsdatascience.com/anomaly-detection-with-generalized-extreme-studentized-deviate-in-python-f350075900e2?source=collection_archive---------7-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fa52" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解GESD并用Python实现它</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7b1feca64f79162391ebe23b1005af4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKqmqw23Aaeetjs2Tsca3w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="c057" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">异常检测在各种各样的用例中扮演着非常重要的角色。通常，异常数据可能与某种问题或罕见事件有关，例如银行欺诈、医疗问题、结构缺陷、设备故障等。这种联系使得挑选出哪些数据点可以被视为异常变得非常有趣，因为从业务角度来看，识别这些事件通常非常有趣。</p><p id="912b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，许多统计技术对异常值的存在很敏感。例如，平均值和标准偏差的简单计算可能会被一个非常不准确的数据点扭曲。检查异常值应该是任何数据分析的常规部分，并且应该检查潜在的异常值以查看它们是否可能是错误的</p><p id="f1cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">什么是异常检测？</strong></p><p id="e50a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">异常检测是发现数据集异常值的任何过程；那些不属于这里的东西。这些异常可能指向不寻常的网络流量，发现某个传感器出了故障，或者只是在分析之前识别出要清理的<a class="ae kv" href="https://www.bmc.com/blogs/data-normalization/" rel="noopener ugc nofollow" target="_blank">数据</a>。</p><p id="45ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有各种技术可用于根据不同的方案或方法识别异常，如图形(箱线图、散点图)、基于距离的方案(最近邻法、聚类算法)、统计方法(GESD、基于四分位数的技术)等。每种方案都有其优点和缺点，其功效取决于使用案例。</p><p id="eb89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将重点关注GESD(广义极端学生化偏差)，并用python实现一个简单的示例，以更好地理解它的工作原理。在我开始之前，我想承认这篇文章在很大程度上受到了我的探索性数据分析教授Edward McFowland和Bhavesh Bhatt在YouTube上的<a class="ae kv" href="https://www.youtube.com/channel/UC8ofcOdHNINiPrBA9D59Vaw" rel="noopener ugc nofollow" target="_blank">机器学习和统计教程</a>的启发。</p><p id="9f1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">什么是GESD？</strong></p><p id="b4b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GESD是一种简单的统计方法，用于检测符合近似正态分布的单变量数据集中的一个或多个异常值。统计方法假设常规数据遵循某种统计模型，不遵循该模型的数据是异常值。</p><p id="84de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GESD克服了<a class="ae kv" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda35h1.htm" rel="noopener ugc nofollow" target="_blank">格拉布斯检验</a>和<a class="ae kv" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda35h2.htm" rel="noopener ugc nofollow" target="_blank">蒂特金-摩尔检验</a>的主要限制，即异常值的可疑数量<em class="ls"> k </em>必须精确指定。如果没有正确指定<em class="ls"> k </em>，这可能会扭曲这些测试的结论。GESD检验只要求指定异常值可疑数量的上限。</p><p id="f70f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给定上限<em class="ls"> r </em>，广义ESD测试本质上执行<em class="ls"> r </em>单独的测试:一个异常值的测试，两个异常值的测试，等等，直到<em class="ls"> r </em>异常值。</p><p id="2ace" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">广义ESD测试是针对以下假设定义的:</p><p id="9886" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> H0:数据集中没有异常值</strong></p><p id="5235" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">高可用性:数据集中有多达r个异常值</strong></p><p id="c5a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的测试统计由下面的公式给出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/e431b5ba4eaf0fc987d8b498af2ed939.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*4Vnl7XrzUTiG8EO4SQxSKQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">GESD的检验统计</p></figure><p id="bddc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，x_bar和σ分别表示样本均值和样本标准差。</p><p id="ed7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在GESD，我们移除最大化| <em class="ls"> xi </em> — <em class="ls"> x_bar </em>的观察，然后用n-1个观察重新计算上述统计。我们重复这个过程，直到r个观察值被去除。这导致r统计数据<em class="ls"> R1，R2 ……，Rr。通过编码示例，该过程将变得更加清晰。</em></p><p id="6fef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对应于<em class="ls"> r </em>测试统计，计算以下<em class="ls"> r </em>临界值:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/06bc5c2939b24e6dacdcd0c374d9f5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*WoPkCMW1sKUurN-u08NFXg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">临界值计算</p></figure><p id="5032" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中<em class="ls"> tp，ν </em>是从具有<em class="ls"> ν </em>自由度的<a class="ae kv" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda3664.htm" rel="noopener ugc nofollow" target="_blank">t<em class="ls">t</em>分配</a>的100 <em class="ls"> p </em>百分点</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/19ffc843cea6ce3c2e82364305eff5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*cT13ei9iH-g4M-egS7zNRQ.png"/></div></figure><p id="e0da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的显著性水平将由α表示。</p><p id="b7e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">通过找到最大的<em class="ls"> i </em>来确定异常值的数量，使得<em class="ls"> Ri </em> &gt; <em class="ls"> λi </em>。</strong></p><p id="223f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Rosner 的模拟研究表明，这个临界值近似值对于n  ≥ 25非常精确，对于n<em class="ls"/>≥15相当精确。</p><p id="b8e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，尽管广义ESD本质上是按顺序应用的<a class="ae kv" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda35h1.htm" rel="noopener ugc nofollow" target="_blank">格拉布斯测试</a>，但还是有一些重要的区别:</p><ul class=""><li id="44c4" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">广义ESD测试根据测试的异常值数量对临界值进行适当的调整，而连续应用Grubbs测试则不会。</li><li id="1690" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">如果存在明显的掩蔽，连续应用格拉布斯检验可能会过早停止。</li></ul><p id="980a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在为了巩固理论部分，让我们用Python实现GESD，以了解它实际上是如何工作的:</p><p id="beac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于这是一个例子，我们将首先模拟我们的数据。这里我们创建100个0到1之间的随机值。我们的数据散点图如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/dc8e7c5d310a39bc96f89d7ccf43396a.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*YLe9kRIoJhQbcDXyE2IScA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/94d47aa7711a61fbe0dc0462d836c170.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*U43aUwZ_1HIsleCrbXqM-g.png"/></div></figure><p id="3852" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们会故意在数据中放一些异常值进行识别。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/d8b0c3786bdd07d0b817d96c5ede1460.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*JQmj9vbiYRWdozw4bNoHqw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/7af317a890ae01b3ab1b9bea3a1fcaba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*G6h7fVZx4vEVgvofwtgqSg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">有异常值的数据</p></figure><p id="0e2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将创建单独的函数来计算测试统计数据和临界值</p><p id="97f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算测试统计的函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/4e77ffe23d560296a0c59f9d264e6490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*0KGQrRkIBr47AYCOHBwxug.png"/></div></figure><p id="c28d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算临界值的函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/5573a9623d9b9708121c053857344174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*hs2AVTHGzz7pqfBdp7mpdw.png"/></div></figure><p id="c295" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该函数将所有内容汇集在一起，并执行r检验来确定异常值的数量。对于每次迭代，我们使用上面的函数来计算使|<em class="ls">Xi</em>—<em class="ls">x _ bar</em>|最大化的检验统计量，然后计算相应的临界值，然后在下一次迭代中从我们的数据中移除观察值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/71f1696c167e8878e928ded68b6a366d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4saESACb0ior788msUJdTw.png"/></div></div></figure><p id="587e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对我们的数据调用具有7个异常值上限且显著性水平为5%的函数会产生以下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/a663627221c23e63619e33a5f12b0089.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*KyG4w0fw8vFqGwRP_ZktQQ.png"/></div></figure><p id="ac6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到执行了7项测试。通过找到最大的<em class="ls"> i </em>来确定异常值的数量，使得<em class="ls">Ri</em>T20】T8】λI。在本例中，测试统计值大于临界值(在5 %的水平)的最大异常值数是3。因此，我们得出结论，在这个数据集中有<strong class="ky ir"> 3个异常值。</strong></p><p id="1021" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是完整的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1965" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是GESD在python中的实现。我希望这篇文章将有助于您实现这个简单而有效的方法来发现数据中的异常值。更多项目请查看我的<a class="ae kv" href="https://github.com/shaleenswarup" rel="noopener ugc nofollow" target="_blank"> Github简介</a>。</p><p id="f78e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献:</strong></p><p id="bf1c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">bmc| <a class="ae kv" href="https://www.bmc.com/blogs/machine-learning-anomaly-detection/#:~:text=Anomaly%20detection%20is%20any%20process,data%20for%20cleaning%2C%20before%20analysis" rel="noopener ugc nofollow" target="_blank">机器学习的异常检测:Jonathan Johnson的介绍</a></p><div class="mu mv gp gr mw mx"><a href="https://datascience904.wordpress.com/2019/10/14/anomaly-detection-using-pca/" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd ir gy z fp nc fr fs nd fu fw ip bi translated">使用主成分分析的异常检测</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">异常检测(或异常值检测)是对引起异常的罕见项目、事件或观察结果的识别</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">datascience904.wordpress.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl kp mx"/></div></div></a></div><p id="c631" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda35h3.htm" rel="noopener ugc nofollow" target="_blank">https://www . ITL . NIST . gov/div 898/handbook/EDA/section 3/EDA 35h 3 . htm</a></p></div></div>    
</body>
</html>