<html>
<head>
<title>Choosing a Baseline Accuracy for a Classification Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为分类模型选择基线精度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/calculating-a-baseline-accuracy-for-a-classification-model-a4b342ceb88f?source=collection_archive---------8-----------------------#2021-05-07">https://towardsdatascience.com/calculating-a-baseline-accuracy-for-a-classification-model-a4b342ceb88f?source=collection_archive---------8-----------------------#2021-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7d79" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">选择一个简单的基线精度来证明您的分类模型在某个问题上有技巧</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/809f318b6e391a9338f367f9324a7691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mKty9Kyjs8mrvX_4"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">罗伯特·阿纳奇在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="26de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你评估一个新的机器学习模型，并最终得到一个准确度数字或其他指标时，你需要知道它是否有意义。特别是在不平衡的分类模型中，看起来你的模型并不比猜测好多少。什么样的精度才足以称你的模型有用？</p><p id="5fe3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章只是为了展示你的模型的简单的基线准确性，我发现这很有用。</p><h1 id="bba3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">问题是</h1><p id="8ede" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我创建了一个选举模型，使用经济指标预测了美国所有3200多个县(民主党或共和党)的投票习惯。该模型的准确率为86%。这听起来很棒，直到你意识到美国84%的县都投票给共和党。这些县碰巧更小，更农村，所以有更多。像许多数据集一样，我有明显的阶级不平衡。</p><p id="a22b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以简单地预测所有的县都是共和党的，准确率为84%。我的模型真的仅仅比猜测每个县的共和党好一点点吗？</p><h1 id="5f14" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">零速率分类器</h1><p id="6606" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们刚刚描述的模型基线有一个名字。</p><blockquote class="mp mq mr"><p id="2884" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">ZeroR(或零比率)分类器总是分类到最大的类，换句话说，只是平凡地预测最频繁的类。对于一个两种结果的模型来说，只是随波逐流往往是正确的。</p></blockquote><p id="6160" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总是选择多数组(ZeroR分类器)作为基线是有见地的，并且是任何分类模型都应该选择的。对于一个机器学习算法来说，要证明它在某个问题上有技巧，它必须达到比这个零值更好的精度。</p><p id="4e8b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于高度不平衡的问题(如投票分类问题)，一个比ZeroR稍高一点的模型精度可能是非常重要的。不管怎样，你的模型必须比ZeroR更好才能被认为对问题有用。</p><h1 id="4afc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">随机速率分类器(加权猜测)</h1><p id="5072" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们将把我们的高中数学运用到工作中。我们可以使用的另一个基线策略是，如果我们猜测每个类的加权百分比，看看我们的准确度会是多少。该值将始终低于ZeroR值，因此它不应该是您的下限基线。相反，它可以用来解释和理解您的结果，即您的模型增加了多少价值。</p><blockquote class="mp mq mr"><p id="533c" class="kw kx ms ky b kz la jr lb lc ld ju le mt lg lh li mu lk ll lm mv lo lp lq lr ij bi translated">随机比率分类器—在进行随机类别分配时应用类别分配的先验知识。</p></blockquote><p id="73b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将针对几个分类问题研究这两种策略。</p><h2 id="2a89" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">抛硬币</h2><p id="8941" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们先来看一个抛硬币模型。50%的结果是反面(0)，50%的结果是正面(1)。</p><p id="469c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的基线策略在这里是如何工作的？：</p><ul class=""><li id="b9d4" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated">零——猜测所有的头像会给我们50%的准确率。</li><li id="11d0" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">随机比率——我们凭直觉知道，猜测0.50的正面和0.50的反面也会给我们50%的准确率。我们将有一半正面预测和一半反面预测是正确的。</li></ul><p id="29d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">猜测随机速率分类器的半头半尾在数学上是这样工作的:</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="e4ae" class="mw lt iq nx b gy ob oc l od oe">Odds of Guessing Heads Correct: 0.50 * 0.50 = 0.25<br/>Odds of Guessing Tails Correct: 0.50 * 0.50 = 0.25</span><span id="6d4f" class="mw lt iq nx b gy of oc l od oe">Baseline = 0.50**2 + 0.50**2 = 0.50</span></pre><h2 id="28bd" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">不平衡的结果</h2><p id="32a1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们来看一个不是50/50的。假设结果是75/25。我们现在将对猜测进行加权，这样我们可以在75%的情况下预测大多数结果。这个随机速率猜测策略看起来像这样</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="3940" class="mw lt iq nx b gy ob oc l od oe">Odds of Guessing Minority Correct: 0.25 * 0.25 = 0.0625<br/>Odds of Guessing Majority Correct: 0.75 * 0.75 = 0.5625</span><span id="0ce8" class="mw lt iq nx b gy of oc l od oe">Baseline = 0.25**2 + 0.75**2 = 0.625</span></pre><p id="32df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们以这个速度猜测，我们的正确猜测率只有62.5%。任何在这个基线上改进的机器学习模型都是增值的，但也必须高于零或75%的阈值才能用作预测器。</p><h2 id="502f" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">我们的投票示例</h2><p id="1147" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">那么我在本文开头描述的投票模型到底做得怎么样呢？它高于零基线，所以这个模型是有用的。如果我们猜测实际速率，我们还可以找出我们的基线，然后将其与我们的模型准确性进行比较。</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="b5b2" class="mw lt iq nx b gy ob oc l od oe">Odds of Guessing Democratic Correct: 0.16 * 0.16 = 0.0256<br/>Odds of Guessing Republican Correct: 0.84 * 0.84 = 0.7056</span><span id="cca2" class="mw lt iq nx b gy of oc l od oe">Baseline = 0.16**2 + 0.84**2 = 0.73</span></pre><p id="c759" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以用随机加权猜测，我们只能预测73%的县。我们的实际准确率是86%。这比加权猜测的理论值提高了13%。这个看起来没什么前途的模型，无疑增加了重要的价值。它也在ZeroR基线之上，所以这个模型对这个问题很有用。</p><h2 id="0d90" class="mw lt iq bd lu mx my dn ly mz na dp mc lf nb nc me lj nd ne mg ln nf ng mi nh bi translated">多类问题</h2><p id="80a2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你能为多类问题这样做吗？当然可以。</p><p id="4deb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最近做了一个Twitter情绪分类器，它将一条推文的情绪分为积极、消极或无情绪。这些班级在以下方面不平衡:</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="950f" class="mw lt iq nx b gy ob oc l od oe">No emotion toward brand or product    0.593<br/>Positive emotion                      0.328<br/>Negative emotion                      0.080</span></pre><p id="97e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用我们的猜测策略的理论基线是:</p><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="517e" class="mw lt iq nx b gy ob oc l od oe">0.593**2 + 0.328**2 + 0.080**2 = 0.465633</span></pre><p id="20e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的实际准确率是0.81，所以机器学习给我们的理论基线增加了34%。这很重要。更重要的是，如果我们对每一个结果都预测了“<em class="ms">无情绪”</em>，我们的准确度也远高于0.59的零值。</p><h1 id="e3c4" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">要点和建议</h1><ul class=""><li id="a8ea" class="ni nj iq ky b kz mk lc ml lf og lj oh ln oi lr nn no np nq bi translated">你的模型必须比零规则(ZeroR)做得更好，才能在预测中有用。这是无法回避的。</li><li id="0cf7" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">您可以将您的模型与随机猜测的理论基线进行比较，并使用它来评估您的模型的有用性。</li><li id="c616" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">您可能会发现其他一些有用的基线(统一猜测、随机猜测和一个规则就是其中的几个)。</li><li id="2ec0" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">查看<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.dummy.DummyClassifier.html" rel="noopener ugc nofollow" target="_blank">sk learn . dummy . dummy classifier</a>，它为以下基线策略提供了自动化解决方案:<em class="ms">、【分层】、【最频繁】、【先验】、【统一】、【恒定】。</em></li><li id="e017" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">当评估不平衡分类问题的准确性时，考虑查看AUC。</li><li id="3da3" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">在构建模型之前创建基线，并建立用于评估最终模型的规则。</li></ul><p id="67b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此处展示的技术为您的模型性能提供了一个“现实检查”,对于广大观众来说是可以理解和解释的(我可以很容易地用非技术演示来解释这一点)。他们帮助我评估和理解我自己的模型，我希望你也能发现它们有用。</p></div></div>    
</body>
</html>