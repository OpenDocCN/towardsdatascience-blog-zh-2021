<html>
<head>
<title>Applied Bayesian Inference with PyMC3 Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyMC3应用贝叶斯推理第2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/applied-bayesian-inference-with-python-pt-2-80bcd63b507e?source=collection_archive---------13-----------------------#2021-07-25">https://towardsdatascience.com/applied-bayesian-inference-with-python-pt-2-80bcd63b507e?source=collection_archive---------13-----------------------#2021-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="34ce" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在StockX上展示阿迪达斯Yeezy和耐克米色转售</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d8eef2d3087d285ce851d08e4a17a5ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RRkLYmVkoKTF5p5E8mUMw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">纽约时报。作者图片</p></figure><h1 id="aeba" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="cbe3" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">如果你是从第1部分来到这里的，那么我已经假设你至少知道Python &amp;统计学的基础。如果不是，从第1部分开始可能对你自己的学习体验更舒服。</p><p id="c5fb" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">在第1部分中，我展示了如何通过Python使用PyMC3，通过掷硬币的例子进行贝叶斯建模。这个例子是一个很好的起点，因为它是一个大多数人都熟悉的概念，而且数据并不“混乱”。这个例子的问题是它的人为性质使你，学习者，很难真正使用这个技能。我知道，因为这正是我的感受。因此，在这一部分中，我将把PyMC3模型和方法应用于“真实”数据集。由于我是一个狂热的耐克粉丝，我将浏览这个<a class="ae mm" href="https://www.kaggle.com/hudsonstuck/stockx-data-contest" rel="noopener ugc nofollow" target="_blank"> StockX 2019数据竞赛数据集</a>。这个数据集比这个领域的大多数专家使用的数据集都要干净得多。Kaggle是一个很好的游乐场，可以做数据科学的有趣事情，但是现实世界中的大多数数据集都非常混乱。</p><p id="9ee5" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">为了解决这个问题，假设我们想为Yeezys和Off-white的利润率建模，以帮助我们在转售世界中找到一个更好的权衡。</p><p id="4883" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">与任何好的数据科学项目一样，让我们先做尽职调查，进行探索性的数据分析，并在此过程中做一些清理工作。</p><h1 id="d9b6" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">探索性数据分析和数据清理</h1><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="98f7" class="mx kz it mt b gy my mz l na nb">import pandas as pd<br/>import numpy as np<br/>import pymc3 as pm<br/>import arviz as az<br/>from arviz.plots.plot_utils import xarray_var_iter<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import xarray as xr</span><span id="3314" class="mx kz it mt b gy nc mz l na nb">%matplotlib inline</span><span id="c087" class="mx kz it mt b gy nc mz l na nb">RANDOM_SEED = 42</span><span id="ae0d" class="mx kz it mt b gy nc mz l na nb">stockx_data = pd.read_csv('StockX-Data-Contest-2019-3.csv')</span><span id="8a8e" class="mx kz it mt b gy nc mz l na nb">#Seeing how many rows/columns we're working with<br/>print(stockx_data.shape)</span><span id="a95d" class="mx kz it mt b gy nc mz l na nb">(99956, 8)</span><span id="724b" class="mx kz it mt b gy nc mz l na nb">#Getting first glimpse at dataset<br/>stockx_data.head(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/b575e71a453376a464b0565d860777de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a7qFwR9r3oT3VodtWn-bYw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3b9c" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">首先检查nan和dtypes:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="15c6" class="mx kz it mt b gy my mz l na nb">stockx_data.isna().sum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/9c91c1b609527d9e890c9243621648dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:244/format:webp/1*5IzhAA-Q8L-GSVfOEiAMWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="b22d" class="mx kz it mt b gy my mz l na nb">stockx_data.dtypes</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/a433dda87bb654e7bcd357d439382749.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*cSvZbbaoNNSFB4YFO44olg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5a61" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">一开始看起来相对干净。让我们稍微清理一下数据/数据类型，然后创建一些有趣的特性。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ebf6" class="mx kz it mt b gy my mz l na nb">def cleanCurrency(series):<br/>    """<br/>    Input: a dataframe series for currency (USD)<br/>    Output: cleaned series as a float<br/>    """<br/>    #Replaces dollar sign and comma with empty string<br/>    series = series.str.replace('$', '', regex=True)<br/>    series = series.str.replace(',', '', regex=True)<br/>    series = series.astype(float)<br/>    return series</span><span id="9910" class="mx kz it mt b gy nc mz l na nb">#Fix the Price fields to only be numeric<br/>stockx_data['Sale Price'] = cleanCurrency(stockx_data['Sale Price'])<br/>stockx_data['Retail Price'] = cleanCurrency(stockx_data['Retail Price'])</span><span id="ed50" class="mx kz it mt b gy nc mz l na nb">#Calculate Profit by subtracting Sale from Retail<br/>stockx_data['Profit'] = stockx_data['Sale Price'] - stockx_data['Retail Price']</span><span id="0871" class="mx kz it mt b gy nc mz l na nb">#Cleaning Sneaker Name column by removing hyphens<br/>stockx_data['Sneaker Name'] = stockx_data['Sneaker Name'].str.replace('-', '')</span><span id="9e72" class="mx kz it mt b gy nc mz l na nb">#Making brand name a little more descriptive<br/>stockx_data['Brand'] = stockx_data['Brand'].str.replace('Yeezy', 'Yeezy (Adidas)')<br/>stockx_data['Brand'] = stockx_data['Brand'].str.replace('Off-White', 'Off-White (Nike)')</span><span id="0bd4" class="mx kz it mt b gy nc mz l na nb">#Getting only 'object' dtype columns and then stripping trailing white spaces<br/>stockx_data_obj = stockx_data.select_dtypes(['object'])<br/>stockx_data[stockx_data_obj.columns] = stockx_data_obj.apply(lambda x: x.str.strip())</span><span id="655b" class="mx kz it mt b gy nc mz l na nb">#Ensure date fields are the right dtype<br/>stockx_data['Order Date'] = pd.to_datetime(stockx_data['Order Date'])<br/>stockx_data['Release Date'] = pd.to_datetime(stockx_data['Release Date'])</span><span id="5c0c" class="mx kz it mt b gy nc mz l na nb">#Calculate Duration of Days from Release Date to Order Date<br/>stockx_data['Duration (days)'] = stockx_data['Order Date'] - stockx_data['Release Date']</span><span id="8f22" class="mx kz it mt b gy nc mz l na nb">#Univariate stats on the numeric measures<br/>stockx_data.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d50ee1f6f9d360d558dbe5f212f86378.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*6asFMzQFGF-ANzOItoIBjw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="41ba" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">首先引起我注意的是这双鞋的价格。考虑到品牌和StockX的目标(转售高端街头服饰)，这一点得到了证实。这里的平均订单也从转售中获得了相当不错的利润，大约60美元。不过，标准差显示利润有很大的变化。这里需要注意的另一件有趣的事情是，在2017-2019年期间，Off-Whites &amp; Yeezys平均需要2个月才能在StockX上转售。这可能是由于在鞋子发布的最初几个月供货率低。</p><p id="44a9" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">接下来，让我们快速了解一下日期字段的范围。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ce3c" class="mx kz it mt b gy my mz l na nb">#Getting the min and max dates to understand order date range<br/>print(stockx_data['Order Date'].min(), stockx_data['Order Date'].max())</span><span id="85fb" class="mx kz it mt b gy nc mz l na nb">2017-09-01 00:00:00 2019-02-13 00:00:00</span></pre><p id="4084" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">似乎我们有相当多的数据！将近两年的相对干净的数据。目前看起来不错，现在让我们开始可视化数据，以便更好地理解我们正在处理的内容:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="dab3" class="mx kz it mt b gy my mz l na nb">#Grouping by Brand to see how the general distribution of sales are<br/>brand_group = pd.DataFrame(stockx_data.groupby('Brand').size(), columns=['values']).reset_index().sort_values('values', ascending=False)<br/>brand_group['values'] = brand_group['values'].astype(int)<br/>plt.figure(figsize=(16, 8))<br/>plt.rcParams.update({'font.size': 10})<br/>ax = sns.barplot(x=brand_group['Brand'], y=brand_group['values'], data=brand_group, hue='Brand', palette="icefire")<br/>ax.set(ylabel='Number of Shoes')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/4106917b1ab952c3dc782c6d4bf64894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VLyoE_8T9nDfo0pAFdlaww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按品牌销售的鞋子总数。作者图片</p></figure><p id="0302" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这是一个很大的阶级不平衡，Yeezys在这两年的销量似乎远远超过了白人。让我们潜得更深。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="26da" class="mx kz it mt b gy my mz l na nb">#Grouping by Sneaker Name to see how the general distribution of ratings are<br/>sneaker_group = pd.DataFrame(stockx_data.groupby(['Brand', 'Sneaker Name']).size(), columns=['values']).reset_index().sort_values('values', ascending=False)<br/>sneaker_group['values'] = sneaker_group['values'].astype(int)<br/>plt.figure(figsize=(20, 8))<br/>plt.rcParams.update({'font.size': 10})<br/>ax = sns.barplot(x=sneaker_group['Sneaker Name'], y=sneaker_group['values'], data=sneaker_group, hue='Brand', palette="icefire")<br/>ax.set(ylabel='Number of Shoes')<br/>plt.xticks(rotation=90)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/d531af5d6ba6d7074c4072c054d554d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*soQnxNiej1NVmiCG5SML1A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按运动鞋名称销售的鞋子总数。作者图片</p></figure><p id="a227" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">按销量排名前10的运动鞋品牌似乎主要由Yeezys占据。即:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8d37" class="mx kz it mt b gy my mz l na nb">sneaker_group[:10]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/bd1491311a0d07fe332378195856d6e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*wvb86W3P_dA671vJDgySFg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e14b" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">尽管买方地区(州)可能有点显而易见，但让我们确认一下假设。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d92d" class="mx kz it mt b gy my mz l na nb">#Grouping by Region to see how the general distribution of ratings are<br/>region_group = pd.DataFrame(stockx_data.groupby([‘Buyer Region’, ‘Brand’]).size(), columns=[‘values’]).reset_index().sort_values(by=’values’, ascending=False)<br/>region_group[‘values’] = region_group[‘values’].astype(int)<br/>plt.figure(figsize=(20, 8))<br/>plt.rcParams.update({‘font.size’: 10})<br/>ax = sns.barplot(x=region_group[‘Buyer Region’], y=region_group[‘values’], data=region_group, hue=’Brand’, palette=”icefire”)<br/>ax.set(ylabel=’Number of Shoes’)<br/>plt.xticks(rotation=90)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/a7aaf10b769f8c826a6a43d43cd5a0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJhkIq4Gn0gtGjXeFcN57w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按买家区域列出的售出鞋子总数。作者图片</p></figure><p id="f6b1" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">像加利福尼亚和纽约这样的州在这里有很多代表。这无疑证明了这些州(和俄勒冈州)的运动鞋文化是非常强大的。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="81f5" class="mx kz it mt b gy my mz l na nb">region_group[:10]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/a40270f62d2fadf12e41be481208f67b.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*5WmaAl0tKbI_gwJUw329pA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8526" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">最后，让我们更好地了解一下利润与我们目前所看到的内容之间的关系。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ba3a" class="mx kz it mt b gy my mz l na nb">order_group = pd.DataFrame(stockx_data.groupby([‘Order Date’, ‘Brand’]).size(), columns=[‘values’]).reset_index().sort_values(by=’values’, ascending=False)<br/>order_group[‘values’] = order_group[‘values’].astype(int)<br/>fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(20, 12))<br/>plt.rcParams.update({‘font.size’: 10})<br/>ax1 = sns.lineplot(x=order_group[‘Order Date’], y=order_group[‘values’], data=order_group, hue=’Brand’, palette=”icefire”, ax=ax1)<br/>ax2 = sns.lineplot(x=stockx_data[‘Order Date’], y=stockx_data[‘Profit’], data=stockx_data, hue=’Brand’, palette=”icefire”, ax=ax2)<br/>ax1.set(ylabel=’Number of Shoes’)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/d6e878e88b01d74d79aba9b19f7290b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NAFA0QkgcM_WrI1j7aDydA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一段时间内售出的鞋子数量(上图)。一段时间内每次销售的利润(下图)。作者图片</p></figure><p id="7280" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这讲述了一个非常有趣的故事——虽然Yeezys在StockX上销售的鞋子数量上占主导地位(根据该数据集)，但白人的利润数字一直较高。将散点图矩阵可视化将有助于查看是否有任何固有的模式出现在数值测量中:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c505" class="mx kz it mt b gy my mz l na nb">sns.pairplot(stockx_data, diag_kind=’kde’, hue=’Brand’, palette=’icefire’);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/2cff9cbefd519a597e631c6b7f3d92a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zAMBXRwWc-wm0p_iKz6Ctg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="638c" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">很明显，销售价格和利润会有一个完美的线性关系，但除此之外，变量之间不会出现明显的模式。与Yeezys相比，我们在各种散点图中看到了更多的灰白色分散和变化。最后，值得注意的是，售出的平均鞋码似乎在10码左右。在美国，这个数字相当大，可能意味着销售的主要是男鞋。</p><p id="dc4c" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">因为我们最终想要对利润建模，所以让我们仔细看看它们的分布。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="99bc" class="mx kz it mt b gy my mz l na nb">fig, (ax1, ax2) = plt.subplots(1,2, figsize=(16, 8))</span><span id="e722" class="mx kz it mt b gy nc mz l na nb">ax1 = sns.histplot(stockx_data.loc[stockx_data[‘Brand’]==’Yeezy (Adidas)’,’Profit’], kde=True, color=’midnightblue’, ax=ax1)<br/>ax2 = sns.histplot(stockx_data.loc[stockx_data[‘Brand’]==’Off-White (Nike)’,’Profit’], kde=True, color=’maroon’, ax=ax2)</span><span id="6582" class="mx kz it mt b gy nc mz l na nb">ax1.set_title(‘Rating Distribution for Yeezy (Adidas) Products’)<br/>ax2.set_title(‘Rating Distribution for Off-White (Nike) Products’)</span><span id="9cdc" class="mx kz it mt b gy nc mz l na nb">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e574e2c6c8a56afd7b475a3a4848c8b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOAGX3GvyOYclwfXNJ0c7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1a53" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">一定要记住天平；该数据集中的灰白色计数要少得多，但它们都遵循类似的双峰分布，大频率接近0–500，长尾将平均值向右倾斜。从线图中可以看出，我们确实证实了米白色的平均利润更高。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7d05" class="mx kz it mt b gy my mz l na nb">#Filtering dataframe to get the respective brands only<br/>yeezy = stockx_data[stockx_data[‘Brand’]==’Yeezy (Adidas)’]<br/>offwhite = stockx_data[stockx_data[‘Brand’]==’Off-White (Nike)’]</span></pre><p id="100f" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们已经对我们的数据有了一个相当不错的想法，现在是时候开始构建模型了。</p><h1 id="6d42" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">建模和分析</h1><p id="a9c1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在我们开始编码之前，重要的是要经历第1部分中说明的步骤:<br/> <strong class="ls iu"> 1。</strong>描述这个利润数据的最佳随机变量是什么？这种分布似乎表明，有两种类型的人从yee zys/Off-white(双峰)中获利。此外，长尾可能代表更具排他性的产品，但我们的模型会将它们解读为噪音。为了说明这一点，我们可以使用学生的t分布。这种分布与正态分布非常相似，除了对异常值更稳健，这对我们非常有用。这种假设反映了我们所认为的利润人群会得到我们所拥有的信息。考虑到世界上流行的高斯人是多么有效，这可能是一个很好的起点。</p><p id="d473" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls iu"> 2。</strong>接下来，我们想，“好吧，假设利润是学生的t分布，我需要正态分布吗？”嗯，t分布有三个参数mu ( <em class="np"> μ </em> ) <em class="np">、</em> sigma ( <em class="np"> σ </em>)，nu ( <em class="np"> v </em>)。这些表示平均值、标度(与数据的分布相关)和t分布的自由度，它们决定了t分布的形状。</p><p id="c6cd" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls iu"> 3。</strong>我们知道<em class="np"> μ，σ，</em>和<em class="np"> v </em>吗？不，我们对它的最好估计是我们分布的均值和标准差。似乎每个品牌都有不同，所以我们能做的是设定一个先验来评估它们。</p><p id="45c3" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls iu"> 4。</strong>对于<em class="np"> μ，σ，</em>和<em class="np"> v </em>有哪些好的分布？对于<em class="np"> μ </em>，我们可以用一个很宽的均匀分布来体现我们的无知。从本质上讲，我们认为在给定的范围内，平均值可能是相同的。仅仅通过观察分布，我们就可以得到Yeezys的范围是[0，500]，灰白色的范围是[0，1000]。对于<em class="np"> σ </em>，我们知道标准差需要有正值，因此我们可以使用半正态分布，并通过使用宽范围[0，10]来反映我们的无知。最后，我们也不知道<em class="np"> v </em>的分布，所以我们可以遵循推荐的文献，使用另一个弱信息先验。这意味着一个平均值为30的指数分布。这基本上反映了我们或多或少地认为<em class="np"> v </em>应该在30左右，但是可以轻松地移动到更小和更大的值。</p><p id="4358" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">到目前为止，我们讨论的所有观点都反映了我们对两个品牌利润的人口分布的各种假设和忽视。请记住，这个过程的目标是从某个相当好的地方开始，获得新的证据，然后更新我们的先验和可能性，以获得更准确/精确的后验。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="add2" class="mx kz it mt b gy my mz l na nb">#Creating a model with respective mu, sigma, and y distributions<br/>with pm.Model() as model:<br/>    mu_offwhite = pm.Uniform('mu_offwhite', 0, 1000)<br/>    sigma_offwhite = pm.HalfNormal('sigma_offwhite', sd=10)<br/>    nu_offwhite = pm.Exponential('nu_offwhite', 1/30)<br/>    y_offwhite = pm.StudentT('y_offwhite', mu=mu_offwhite, sd=sigma_offwhite, nu=nu_offwhite, observed=offwhite['Profit_transformed'])</span><span id="a1db" class="mx kz it mt b gy nc mz l na nb">mu_yeezy = pm.Uniform('mu_yeezy', 0, 500)<br/>    sigma_yeezy = pm.HalfNormal('sigma_yeezy', sd=10)<br/>    nu_yeezy = pm.Exponential('nu_yeezy', 1/30)<br/>    y_yeezy = pm.StudentT('y_yeezy', mu=mu_yeezy, sd=sigma_yeezy, nu=nu_yeezy, observed=yeezy['Profit_transformed'])<br/>    <br/>pm.model_to_graphviz(model)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/bb78ee7d45f5076f145c359ea9548ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmBXf6Pu8-ZpyFXcsSWjyg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f1e5" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">你可能想知道为什么我在同一个模型中有两种利润分布。这应该不会对我们的模型产生很大的影响，如果有的话，对我们后面要讨论的部分会有帮助。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="002a" class="mx kz it mt b gy my mz l na nb">with model:<br/>    trace = pm.sample(10000, tune=2000, target_accept=.9, return_inferencedata=True, random_seed=RANDOM_SEED)</span></pre><p id="b6c9" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">关于排除发散链故障的快速说明:当您创建自己的MCMC模型时，您可能会遇到后验分布收敛的问题。马尔可夫链蒙特卡罗(MCMC)使用马尔可夫链𝑞0,…,𝑞𝑁.的状态来逼近关于给定目标(后验)分布的期望问题是，只有当链变得无限长时，它们才能保证精确。这通常在计算上是不可行的，因此我们试图在不耗尽资源的情况下快速收敛到目标分布。不幸的是，这需要一个叫做几何遍历的条件才能成立。这个条件本质上使我们能够在仅利用有限次迭代时遵循MCMC模型的中心极限定理。从技术上讲，我们无法以简单的方式证明几何遍历性，但我们可以观察到链中的发散，这表明条件已被违反。采样中发现的Rhat统计和发散链是违反该条件的关键指标，如果您发现了这一点，我建议尝试以下策略:</p><ol class=""><li id="5606" class="nr ns it ls b lt mn lw mo lz nt md nu mh nv ml nw nx ny nz bi translated">增加“调整”参数:如果你想从你的模型中抽取“真实的”(无偏的)样本，你需要“调整”(让它收敛)这个链。默认情况下，tune对1000个样本执行此操作，但增加此操作会让模型有更多时间达到收敛。</li><li id="90fc" class="nr ns it ls b lt oa lw ob lz oc md od mh oe ml nw nx ny nz bi translated">增加抽取的样本数量:马尔可夫链从随机分布开始，慢慢收敛到你的模型的分布。在调整步骤收敛后，增加绘制次数可以为模型提供更多样本供选择。</li><li id="3585" class="nr ns it ls b lt oa lw ob lz oc md od mh oe ml nw nx ny nz bi translated">增加“target_accept”参数:这等同于降低机器学习模型中的学习速率。降低该值可使采样器确保更少的发散。</li></ol><p id="5afc" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">如何对推理引擎进行最佳故障诊断的理论和解释在这里得到了最好的说明<a class="ae mm" href="https://docs.pymc.io/notebooks/Diagnosing_biased_Inference_with_Divergences.html" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c2ef" class="mx kz it mt b gy my mz l na nb">var_names = ['mu_offwhite', 'sigma_offwhite', 'nu_offwhite', 'mu_yeezy', 'sigma_yeezy', 'nu_yeezy']<br/>lines = list(xarray_var_iter(trace.posterior[var_names].mean(dim=("chain", "draw"))))<br/>az.plot_trace(trace, lines=lines);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/ada292120c5f4216604f8b7456b6fda2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhrIKymqZsBVZxRLg5AGww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/5a494cb8bb3e97cfab809800af80384c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bjX7FjQSxy1ibSFjxRd_hQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="efb1" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">对我们前科的初步分析看起来不错。左边的KDE图平滑且相对对齐(尽管在这里和那里可以看到轻微的偏差),右边的图看起来更像白噪声，没有明显的模式。</p><p id="64b4" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">在继续前进之前，对你的过去进行更多的分析是一个很好的习惯。请记住，从数据中获得洞察力的桥梁是通过假设，因此理解和提炼我们的先验知识非常重要！幸运的是，ArviZ让我们的工作变得简单多了。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="f346" class="mx kz it mt b gy my mz l na nb">with model:<br/> prior_checks = pm.sample_prior_predictive(random_seed=RANDOM_SEED)<br/> idata_prior = az.from_pymc3(prior=prior_checks)<br/> <br/>fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16,8))<br/>ax1 = az.plot_dist(idata_prior.prior[‘mu_yeezy’], kind=’kde’, rug=True, <br/> quantiles=[.25, .5, .75], color=’midnightblue’, ax=ax1)<br/>ax2 = az.plot_dist(idata_prior.prior[‘mu_offwhite’], kind=’kde’, rug=True,<br/> quantiles=[.25, .5, .75], color=’maroon’, ax=ax2)</span><span id="b4a4" class="mx kz it mt b gy nc mz l na nb">ax1.set_title(‘Prior Distribution for mu_yeezy’)<br/>ax2.set_title(‘Prior Distribution for mu_offwhite’)</span><span id="0681" class="mx kz it mt b gy nc mz l na nb">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/ec492ae7e90c5d43371f1853cb7fa88d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wJf6-eSGpqnWEzE07QFEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a32a" class="mx kz it mt b gy my mz l na nb">fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(16,8))</span><span id="e514" class="mx kz it mt b gy nc mz l na nb">ax1 = az.plot_dist(idata_prior.prior[‘sigma_yeezy’], kind=’kde’, rug=True, <br/> quantiles=[.25, .5, .75], color=’midnightblue’, ax=ax1)<br/>ax2 = az.plot_dist(idata_prior.prior[‘sigma_offwhite’], kind=’kde’, rug=True,<br/> quantiles=[.25, .5, .75], color=’maroon’, ax=ax2)</span><span id="d7e4" class="mx kz it mt b gy nc mz l na nb">ax1.set_title(‘Prior Distribution for sigma_yeezy’)<br/>ax2.set_title(‘Prior Distribution for sigma_offwhite’)</span><span id="b3eb" class="mx kz it mt b gy nc mz l na nb">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/ea6cea7bb55c85f767fdcffbd21f6cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lnM2ZTvEO2_burgAHyUzw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="da65" class="mx kz it mt b gy my mz l na nb">az.summary(trace)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/3d69b66a61c61912ec7a7cda56cfa90f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*DrGiXfbYDF-6tqmscsOsrg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cf42" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这些先验分布图并不意味着与我们的利润分布相匹配；在给定数据的情况下，我们正在研究模型发现的每个品牌利润的均值和标准差的可能分布。所以对于平均的先验分布，我们确实看到平均值与我们在每个利润分布中发现的相对接近。事实上，对于yeezy，该模型能够拾取由较大数据分布组成的较大的第一个尖峰。我们估计值的低标准偏差是一大优势。此外，查看摘要，我们可以看到rhat的良好数字和相当低的MCSE误差，这是一个好现象。最后，我们看到自由度的估计值约为2.4，这表明我们的分布确实有较重的尾部(由于异常值)，选择Student的t分布是一个很好的选择，因为它可以为我们提供更稳健的估计。</p><p id="cf10" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们肯定要进行后验预测检验，看看后验分布是否成立。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7878" class="mx kz it mt b gy my mz l na nb">with model:<br/> ppc = pm.sample_posterior_predictive(trace, var_names=var_names+[‘y_offwhite’, ‘y_yeezy’], random_seed=RANDOM_SEED)</span><span id="94f6" class="mx kz it mt b gy nc mz l na nb">fig, (ax1,ax2) = plt.subplots(1,2, figsize=(10, 5))<br/>ax1.hist([y.mean() for y in ppc['y_yeezy']], bins=19, alpha=0.5, color='midnightblue')<br/>ax2.hist([y.mean() for y in ppc['y_offwhite']], bins=19, alpha=0.5, color='maroon')<br/>ax1.axvline(yeezy['Profit'].mean(), color='r')<br/>ax2.axvline(offwhite['Profit'].mean(), color='r')<br/>for ax in [ax1, ax2]:<br/>    ax.set(xlabel='x', ylabel='')<br/>ax1.set_title('Posterior Predictive Check for y_yeezy')<br/>ax2.set_title('Posterior Predictive Check for y_offwhite');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5fcee0d5a3b9234bdda9317977ac1d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*s7RJA2N6X0SzTRKtcEwbdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="edaa" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">红线代表我们观察到的各个利润分布的平均值。这里很容易说我们的模型没有像我们最初想的那样学习数据，但是让我们考虑一下我们的假设。我们第一眼看到的利润分布显示，由于离群值的长尾效应，利润分布明显向右倾斜。我们的假设是，这些异常值并不代表每个品牌的利润，如果我们想更准确地了解哪个品牌的利润率更高，我们应该构建一个对这些异常值稳健的模型。因此，我们选择学生的t分布作为我们的可能性。这是一个直接的结果。我们观察数据的平均值<em class="np">应该</em>高于我们后验分布的平均值，因为我们明确想要一个对异常值更稳健的目标分布。</p><p id="a824" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">既然我们对每个利润分配都有了一个看似强大的模型，我们就可以明显地看到米色的平均利润率更高，或者进行典型的t检验来评估差异。对我们来说幸运的是，贝叶斯估计为我们提供了一个很好的比较群体的方法，同时也产生了对不确定性的评估。</p><h1 id="9936" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">分组比较</h1><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="1be9" class="mx kz it mt b gy my mz l na nb">with model:<br/>    diff_means = pm.Deterministic('means difference', mu_yeezy-mu_offwhite)<br/>    diff_std = pm.Deterministic('stds difference', sigma_yeezy-sigma_offwhite)<br/>    effect_size = pm.Deterministic('effect size (cohens d)', diff_means/np.sqrt((yeezy['Profit'].std() ** 2 + offwhite['Profit'].std() ** 2) / 2))</span></pre><p id="d615" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们可以计算均值、标准差和效应大小的差异，然后用确定性对象来表示我们希望将采样值记录为输出的一部分。</p><p id="4588" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">对于效应大小，我们可以使用Cohen的d测量值来计算，d测量值是两组平均标准差的平均值之差。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ce9a" class="mx kz it mt b gy my mz l na nb">with model:<br/> trace = pm.sample(5000, return_inferencedata=True, random_seed=RANDOM_SEED)</span><span id="4b6f" class="mx kz it mt b gy nc mz l na nb">pm.plot_posterior(trace, var_names=['mu_yeezy', 'mu_offwhite', 'sigma_yeezy', 'sigma_offwhite'], color='#87ceeb');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/005f3bea0c0154f18f7f802ad4442577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDM9KDcCZUgs7w7fiaT4tw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="3a28" class="mx kz it mt b gy my mz l na nb">pm.plot_posterior(trace, var_names=['means difference', 'stds difference', 'effect size (cohens d)'], ref_val=0, color='#87ceeb');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/003d38ec79e303a601c5889807e2b164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQTdDeQ7aO6So9G823AYmQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b435c170c89044ef43c6daddbe43d76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*OQDysqam59zGa-Kr89D7rA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="e441" class="mx kz it mt b gy my mz l na nb">az.summary(trace, var_names=['means difference', 'stds difference', 'effect size (cohens d)'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/1811330d808c35ee9a2125e0e37f255a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BVb96jA5giKMcFtDyIrb6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="554e" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">如果Yeezy和Off-White之间的利润率出现巨大差异，我们会看到什么；Yeezys在该数据集中的销售额可能更高，但利润率比非白种人低330美元左右。效果大小也非常重要，可以解释为Z分数。所以Yeezy的利润率比白人低1.3个标准差。</p><h1 id="7938" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="de24" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">贝叶斯估计和建模的惊人之处在于，它为您提供了分布的稳健不确定性估计，并且您可以轻松地添加新的数据/证据来完善您的先验知识。使用PyMC3，我们可以将这一点进一步扩展到分层建模，我们不仅可以比较品牌，还可以对每款鞋的目标分布进行建模，即使我们只有每款鞋相对少量的数据。</p><p id="efa5" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们最初的目标是为Yeezys和Off-white的利润率建模，以帮助我们在转售世界中找到更好的权衡。看看我们的数据集，Yeezys的转售数量占压倒性多数，这给人的印象是，这些将是更好的目标选择。在使用贝叶斯估计对我们的目标利润分布进行建模后，我们发现白色人种的利润率可以高出近1.3个标准差。作为耐克的狂热爱好者，这是一个好消息！</p><p id="dfa8" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls iu">参考文献</strong></p><p id="542b" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">[1]奥斯瓦尔多·马丁，<a class="ae mm" href="https://learning.oreilly.com/library/view/bayesian-analysis-with/9781785883804/" rel="noopener ugc nofollow" target="_blank">用Python进行贝叶斯分析</a></p><p id="1c6f" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">[2]卡梅隆·戴维森-皮隆，<a class="ae mm" href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers" rel="noopener ugc nofollow" target="_blank">黑客的概率编程和贝叶斯方法</a></p><p id="8b90" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">[3] PyMC3，<a class="ae mm" href="https://docs.pymc.io/notebooks/posterior_predictive.html" rel="noopener ugc nofollow" target="_blank">事前和事后预测检查</a></p><p id="0d83" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">[4] PyMC3，<a class="ae mm" href="https://docs.pymc.io/pymc-examples/examples/case_studies/BEST.html" rel="noopener ugc nofollow" target="_blank">贝叶斯估计取代了T检验</a></p><p id="2c93" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">[5] PyMC3，<a class="ae mm" href="https://docs.pymc.io/pymc-examples/examples/diagnostics_and_criticism/Diagnosing_biased_Inference_with_Divergences.html" rel="noopener ugc nofollow" target="_blank">诊断有偏差的推理与分歧</a></p></div></div>    
</body>
</html>