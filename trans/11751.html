<html>
<head>
<title>End-to-end machine learning project: Telco customer churn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">端到端机器学习项目:电信客户流失</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/end-to-end-machine-learning-project-telco-customer-churn-90744a8df97d?source=collection_archive---------0-----------------------#2021-11-23">https://towardsdatascience.com/end-to-end-machine-learning-project-telco-customer-churn-90744a8df97d?source=collection_archive---------0-----------------------#2021-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3343" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="c73a" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">分析 IBM 电信数据(Kaggle 数据集)</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/11a2118b83b867f1c41471ee5e2cd7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qtCP3Yhc0w_XEZ8L"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">杰里米·贝赞格在 Unsplash 上的照片</p></figure><p id="e9b4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">预测<strong class="lh ja">客户流失</strong>对于<strong class="lh ja">电信公司</strong>能够有效留住客户至关重要。获得新客户比留住现有客户的成本更高。出于这个原因，大型电信公司正在寻求开发模型来预测哪些客户更有可能改变并采取相应的行动。</p><p id="09dc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本文中，我们建立了一个模型来<strong class="lh ja">预测客户流失</strong>的可能性，方法是分析其特征:(1) <strong class="lh ja">人口统计信息</strong>、( 2) <strong class="lh ja">账户信息</strong>和(3) <strong class="lh ja">服务信息</strong>。目标是获得一个数据驱动的解决方案，使我们能够降低流失率，从而提高客户满意度和公司收入。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="95a1" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">数据集</h1><p id="f7bd" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">本文中使用的数据集可在<strong class="lh ja">ka ggle(</strong>CC BY-NC-ND<strong class="lh ja">)</strong>和<strong class="lh ja"> </strong>中获得，包含<strong class="lh ja">十九列(自变量)</strong>，表明一个虚构电信公司的客户的<strong class="lh ja">特征。<code class="fe nf ng nh ni b">Churn</code>列(<strong class="lh ja">响应变量</strong>)表示客户是否在上个月离开。类别<code class="fe nf ng nh ni b">No</code>包括上个月没有离开公司的客户，而类别<code class="fe nf ng nh ni b">Yes</code>包括决定终止与公司关系的客户。分析的目标是获得<strong class="lh ja">客户特征和流失</strong>之间的关系。</strong></p><div class="nj nk gp gr nl nm"><a href="https://www.kaggle.com/blastchar/telco-customer-churn" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ja gy z fp nr fr fs ns fu fw iz bi translated">电信客户流失</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">重点客户保留计划</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">www.kaggle.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ky nm"/></div></div></a></div><p id="15e5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">原始的 IBM 数据可以在下面的链接中找到:</p><div class="nj nk gp gr nl nm"><a href="https://www.ibm.com/docs/en/cognos-analytics/11.1.0?topic=samples-telco-customer-churn" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ja gy z fp nr fr fs ns fu fw iz bi translated">电信客户流失</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">这个示例数据模块基于各种因素跟踪一个虚构的电信公司的客户流失。“客户流失”栏…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">www.ibm.com</p></div></div></div></a></div><p id="bf45" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Kaggle 中可用的数据集是对原始 IBM 数据的改编。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="a079" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">项目步骤</h1><p id="7617" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">该项目由以下部分组成:</p><ol class=""><li id="1db5" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma og oh oi oj bi translated"><strong class="lh ja">数据读取</strong></li><li id="91b1" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">探索性数据分析和数据清洗</strong></li><li id="104a" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">数据可视化</strong></li><li id="8183" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">特征重要性</strong></li><li id="8a89" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">特色工程</strong></li><li id="7189" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">设置基线</strong></li><li id="c85f" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">拆分训练集和测试集中的数据</strong></li><li id="cc67" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">评估多种算法</strong></li><li id="322f" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">选择的算法:梯度增强</strong></li><li id="6f2c" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">超参数调谐</strong></li><li id="dc04" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">模型的性能</strong></li><li id="87b6" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma og oh oi oj bi translated"><strong class="lh ja">得出结论—总结</strong></li></ol></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="461d" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">1.数据读取</h1><p id="75b7" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">分析的第一步包括<strong class="lh ja">使用<code class="fe nf ng nh ni b">pandas.read_csv</code>函数读取和存储 Pandas 数据帧中的数据</strong>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/9451103e038b964a14ed29c4dfa90e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*bA5qfwjwgcJ-dTZDi3O_tg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/d32333875cac1c4eb839fb695c0e0a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77XhbIztI1O3nUyOz84_HA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="350c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如上图所示，数据集包含<strong class="lh ja"> 19 个自变量</strong>，可分为 3 组:</p><p id="4a16" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> (1)人口统计信息</strong></p><ul class=""><li id="6a7a" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">gender</code>:客户是女性还是男性(<code class="fe nf ng nh ni b">Female</code>、<code class="fe nf ng nh ni b">Male</code>)。</li><li id="15b4" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">SeniorCitizen</code>:客户是否为老年人(<code class="fe nf ng nh ni b">0</code>、<code class="fe nf ng nh ni b">1</code>)。</li><li id="1b29" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">Partner</code>:客户是否有伴侣(<code class="fe nf ng nh ni b">Yes</code>、<code class="fe nf ng nh ni b">No</code>)。</li><li id="1b75" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">Dependents</code>:客户是否有家属(<code class="fe nf ng nh ni b">Yes</code>、<code class="fe nf ng nh ni b">No</code>)。</li></ul><p id="5a51" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> (2)客户账户信息</strong></p><ul class=""><li id="f937" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">tenure</code>:客户在公司的月数(多个不同的数值)。</li><li id="5aed" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">Contract</code>:表示客户当前的合同类型(<code class="fe nf ng nh ni b">Month-to-Month</code>、<code class="fe nf ng nh ni b">One year</code>、<code class="fe nf ng nh ni b">Two year</code>)。</li><li id="a4a0" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">PaperlessBilling</code>:客户是否无纸化开票(<code class="fe nf ng nh ni b">Yes</code>、<code class="fe nf ng nh ni b">No</code>)。</li><li id="6004" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">PaymentMethod</code>:客户的付款方式(<code class="fe nf ng nh ni b">Electronic check</code>、<code class="fe nf ng nh ni b">Mailed check</code>、<code class="fe nf ng nh ni b">Bank transfer (automatic)</code>、<code class="fe nf ng nh ni b">Credit Card (automatic)</code>)。</li><li id="e00b" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">MontlyCharges</code>:每月向客户收取的金额(多个不同的数值)。</li><li id="185a" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">TotalCharges</code>:向客户收取的总金额(多个不同的数值)。</li></ul><p id="22a2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> (3)服务信息</strong></p><ul class=""><li id="7903" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">PhoneService</code>:客户端是否有电话服务(<code class="fe nf ng nh ni b">Yes</code>、<code class="fe nf ng nh ni b">No</code>)。</li><li id="def4" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">MultipleLines</code>:客户端是否有多条线路(<code class="fe nf ng nh ni b">No phone service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li><li id="d5d6" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">InternetServices</code>:客户是否向公司订购了互联网服务(<code class="fe nf ng nh ni b">DSL</code>、<code class="fe nf ng nh ni b">Fiber optic</code>、<code class="fe nf ng nh ni b">No</code>)</li><li id="10e2" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">OnlineSecurity</code>:客户端是否有在线安全(<code class="fe nf ng nh ni b">No internet service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li><li id="07d3" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">OnlineBackup</code>:客户端是否有在线备份(<code class="fe nf ng nh ni b">No internet service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li><li id="daf0" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">DeviceProtection</code>:客户端是否有设备保护(<code class="fe nf ng nh ni b">No internet service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li><li id="467c" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">TechSupport</code>:客户是否有技术支持(<code class="fe nf ng nh ni b">No internet service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li><li id="0fc1" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">StreamingTV</code>:客户端是否有流媒体电视(<code class="fe nf ng nh ni b">No internet service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li><li id="8c7f" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">StreamingMovies</code>:客户端是否有流媒体电影(<code class="fe nf ng nh ni b">No internet service</code>、<code class="fe nf ng nh ni b">No</code>、<code class="fe nf ng nh ni b">Yes</code>)。</li></ul></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="8d68" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">2.探索性数据分析和数据清理</h1><p id="22a0" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">探索性数据分析</strong>包括分析数据集的主要特征，通常采用<strong class="lh ja">可视化方法</strong>和<strong class="lh ja">汇总统计</strong>。目标是理解数据，发现模式和异常，并在执行进一步评估之前检查假设。</p><h2 id="59a9" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">缺少值和数据类型</h2><p id="0f93" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">在 EDA 之初，我们希望了解尽可能多的关于数据的信息，这就是<code class="fe nf ng nh ni b">pandas.DataFrame.info</code>方法派上用场的时候。该方法打印数据帧的<strong class="lh ja">简明摘要，包括列名及其数据类型、非空值的数量以及数据帧使用的内存量。</strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/e88c60491ad5cabf7bea843fae53148b.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*hqYah0eN8RPWCp1ngWGUvw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="2507" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如上图所示，数据集包含<strong class="lh ja"> 7043 个观察值</strong>和<strong class="lh ja"> 21 列</strong>。显然，数据集上没有空值；然而，我们观察到列<code class="fe nf ng nh ni b">TotalCharges</code>被<strong class="lh ja">错误地检测为对象</strong>。该列表示向客户收取的总金额，因此它是一个数字变量。为了进一步分析，我们需要将这个列转换成一个<strong class="lh ja">数字数据类型</strong>。为此，我们可以使用<code class="fe nf ng nh ni b">pd.to_numeric</code>功能。默认情况下，该函数在看到非数字数据时会引发异常；然而，我们可以使用参数<code class="fe nf ng nh ni b">errors='coerce'</code>跳过这些情况，用一个<code class="fe nf ng nh ni b">NaN</code>来代替它们。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="0e61" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们现在可以观察到列<code class="fe nf ng nh ni b">TotalCharges</code>有 11 个缺失值。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/2acd49423c91db32b17d507fbf7b9e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJoByi5dGaeqMo30HhXV-A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="f15d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这些观察值的任期也为 0，即使这些条目的<code class="fe nf ng nh ni b">MontlyCharges</code>不为空。这一信息似乎是矛盾的，因此，我们决定从数据集中删除这些意见。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="f232" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">删除 customerID 列</h2><p id="5310" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><code class="fe nf ng nh ni b">customerID</code>一栏对于解释客户是否会流失是没有用的。因此，我们从数据集中删除该列。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="9750" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">付款方式面额</h2><p id="7286" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">如下所示，一些支付方式名称在括号中包含单词 automatic。这些名称太长，无法在进一步的可视化中用作刻度标签。因此，我们从<code class="fe nf ng nh ni b">PaymentMethod</code>列的条目中删除了括号中的澄清。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ph"><img src="../Images/8baed11cb9d432077680adc73949c2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*gPhixKlZ3qevTyYNFpHRHA.png"/></div></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/bdd31048e46565ae7e4d0830ab7292d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*iwLwqfK5TLb3kj5V6wj0KA.png"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="b16f" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">3.数据可视化</h1><p id="4a6e" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">在本节中，我们通过使用可视化来分析数据。</p><h2 id="c9ff" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">响应变量</h2><p id="517b" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">下面的<strong class="lh ja">条形图</strong>显示了与<strong class="lh ja">响应变量</strong> : <code class="fe nf ng nh ni b">no</code>和<code class="fe nf ng nh ni b">yes</code>的每一类相对应的观察值的百分比。如下所示，这是一个不平衡的数据集，因为两个类别在所有观测值中的分布并不均匀，其中<code class="fe nf ng nh ni b">no</code>是多数类别(<strong class="lh ja"> 73.42% </strong>)。建模的时候，这种不平衡会导致大量的漏报，我们后面会看到。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/beb07c61044f32223142e478fbee87e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*7IizaGGBgBXkosx7EufSeg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="a7a9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本文中，我们将使用<strong class="lh ja">标准化堆积条形图</strong>来分析结果中每个独立分类变量的<strong class="lh ja">影响。</strong></p><p id="51ed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一个<strong class="lh ja">标准化堆积条形图</strong>使每一列具有相同的高度，因此它对于比较总数没有用处；然而，<strong class="lh ja">非常适合于比较所有独立变量组的响应变量如何变化</strong>。</p><p id="3041" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">另一方面，我们使用<strong class="lh ja">直方图</strong>来评估结果中每个独立数值变量的<strong class="lh ja">影响。如前所述，数据集不平衡；因此，我们需要画出每一类的概率密度函数(<code class="fe nf ng nh ni b">density=True</code>)，以便能够适当地比较两种分布。</strong></p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="f097" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">人口统计信息</h2><p id="771a" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">下面的代码为每个人口统计属性(<code class="fe nf ng nh ni b">gender</code>、<code class="fe nf ng nh ni b">SeniorCitizen</code>、<code class="fe nf ng nh ni b">Partner</code>、<code class="fe nf ng nh ni b">Dependents</code>)创建一个堆积百分比条形图，显示属性的每个类别的<code class="fe nf ng nh ni b">Churn</code>的百分比。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/f1da5610c5d99db8ad66f4e73e586057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*Gt8wb_9wKQVv-Wh1awYAMA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">人口统计信息—由作者创建的图像</p></figure><p id="bd2c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如上所示，每个条形是自变量的一个类别，它被细分以显示每个响应类的比例(<code class="fe nf ng nh ni b">No</code>和<code class="fe nf ng nh ni b">Yes</code>)。</p><p id="fc9f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过分析<strong class="lh ja">人口统计属性</strong>，我们可以提取出<strong class="lh ja">以下结论</strong>:</p><ul class=""><li id="bc84" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated">老年人的流失率几乎是年轻人的两倍。</li><li id="deeb" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">我们不期望性别有显著的预测能力。当客户是男性或女性时，显示出相似的流失率。</li><li id="e28a" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">有<strong class="lh ja">合作伙伴</strong>的客户比没有合作伙伴的客户流失少。</li></ul></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="254e" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">客户账户信息—分类变量</h2><p id="eea1" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">正如我们对人口统计属性所做的那样，我们对客户帐户属性的每个类别(<code class="fe nf ng nh ni b">Contract</code>、<code class="fe nf ng nh ni b">PaperlessBilling</code>、<code class="fe nf ng nh ni b">PaymentMethod</code>)评估了<code class="fe nf ng nh ni b">Churn</code>的百分比。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/03bc1ae94df8f39deb1636464bbe3611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*wDw0ZUREL3nUcOmY4LHeiQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">客户帐户信息—由作者创建的图像</p></figure><p id="ef36" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过分析<strong class="lh ja">客户账户属性</strong>，我们可以得出<strong class="lh ja">以下结论</strong>:</p><ul class=""><li id="fe9a" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated">与拥有<strong class="lh ja">年度合同</strong>的客户相比，拥有<strong class="lh ja">月度合同</strong>的客户拥有<strong class="lh ja">更高的流失率</strong>。</li><li id="ffb7" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">选择<strong class="lh ja">电子支票</strong>作为支付方式的客户更有可能离开公司。</li><li id="a254" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">订阅<strong class="lh ja">无纸化账单</strong>的客户比未订阅的客户流失更多。</li></ul></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="4f58" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">客户账户信息—数字变量</h2><p id="1eab" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">下面的图显示了<code class="fe nf ng nh ni b">tenure</code>、<code class="fe nf ng nh ni b">MontlyCharges</code>、<code class="fe nf ng nh ni b">TotalCharges</code>按<code class="fe nf ng nh ni b">Churn</code>的分布。对于所有数字属性，两个类别(<code class="fe nf ng nh ni b">No</code>和<code class="fe nf ng nh ni b">Yes</code>)的分布是不同的，这表明所有属性都将有助于确定客户是否翻盘。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/dc4dbf7a830e1397925470a62c0ea79d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E9nwGi7755LbJCYRJhPJ9g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">客户帐户信息—由作者创建的图像</p></figure><p id="6200" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过分析上面的<strong class="lh ja">直方图，我们可以提取出下面的<strong class="lh ja">结论</strong>:</strong></p><ul class=""><li id="07f9" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated">当<strong class="lh ja">月费</strong>高时，流失率往往更大。</li><li id="01a5" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">新客户(任期短的客户)更有可能流失。</li><li id="0602" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">总费用高的客户不太可能离开公司。</li></ul></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="9bc7" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">服务信息</h2><p id="3f06" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">最后，我们用堆积条形图评估每个类别的服务列的目标百分比。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/e37f4785b14d7ca55ff4f5f0fa53427b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-uPk2ROgACG2VVLRJ-KwA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">服务信息—由作者创建的图像</p></figure><p id="a30b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过评估<strong class="lh ja">服务属性</strong>，我们可以得出<strong class="lh ja">以下结论</strong>:</p><ul class=""><li id="ba28" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated">我们不期望<strong class="lh ja">手机属性</strong> ( <code class="fe nf ng nh ni b">PhoneService</code>和<code class="fe nf ng nh ni b">MultipleLines</code> ) <strong class="lh ja"> </strong>有显著的预测能力。两个独立变量中所有类别的流失百分比几乎相同。</li><li id="00c4" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">拥有<strong class="lh ja">在线安全</strong>的客户比没有的客户流失少。</li><li id="17c2" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated">没有技术支持的客户比有技术支持的客户更容易流失。</li></ul><p id="19d9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过查看上面的图表，我们可以确定与检测客户流失最相关的<strong class="lh ja">属性。我们希望这些属性在我们未来的模型中是有区别的。</strong></p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="d8d1" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">4.特征重要性</h1><h2 id="605a" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">互信息—线性和非线性关系的分析</h2><p id="21ca" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">互信息</strong>基于熵估计测量两个变量之间的相互依赖性。在机器学习中，我们感兴趣的是<strong class="lh ja">评估每个自变量与响应变量</strong>之间的依赖程度。互信息的值越高，相关性程度越高，这表明独立变量将有助于预测目标。</p><p id="cd39" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Scikit-Learn 库在<code class="fe nf ng nh ni b">metrics</code>包中实现了交互信息。下面的代码计算数据集的每个分类变量和<code class="fe nf ng nh ni b">Churn</code>变量之间的互信息得分。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi po"><img src="../Images/da0c5c2715573073e24fed6a25c9fa60.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*0EWt-zhVA6h9uxNo457djw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="e6e7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">互信息</strong>不仅能让我们更好地理解我们的数据，还能让我们<strong class="lh ja">识别出完全独立于目标</strong>的预测变量。如上图所示，<code class="fe nf ng nh ni b">gender</code>、<code class="fe nf ng nh ni b">PhoneService</code>、<code class="fe nf ng nh ni b">MultipleLines</code>的互信息得分真的<strong class="lh ja">接近于 0 </strong>，意味着这些变量与目标没有很强的关系。这些信息与我们之前通过可视化数据得出的结论一致。在接下来的步骤中，我们应该考虑在训练前从数据集中删除这些变量，因为它们不能提供预测结果的有用信息。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/27b2dbeec95342407050644713e3c375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*GxEzAxJjatLV40t5YKMZ3g.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">特征重要性(交互信息得分)-由作者创建的图像</p></figure><p id="4713" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">互信息</strong>将相关性的概念扩展到非线性关系，因为与皮尔逊相关系数不同，该方法<strong class="lh ja">不仅能够检测线性关系，还能够检测非线性关系</strong>。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="f75f" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">5.特征工程</h1><p id="3c3c" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">特征工程</strong>是<strong class="lh ja">从数据中提取特征并将其转换成适合机器学习模型</strong>的格式的过程。在这个项目中，我们需要转换数字和分类变量。大多数机器学习算法需要数值；因此，<strong class="lh ja">在训练模型之前，应该将数据集中所有可用的分类属性编码到数字标签</strong>中。此外，<strong class="lh ja">我们需要将数字列转换成通用的刻度</strong>。这将防止具有大值的列主导学习过程。在这个项目中实现的技术将在下面详细描述。所有的转换都只使用熊猫来实现；然而，我们也提供了一个使用 Scikit-Learn 的替代实现。如您所见，有多种方法可以解决同一个问题😃。</p><h2 id="da50" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">没有修改</h2><p id="1ffd" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><code class="fe nf ng nh ni b">SeniorCitizen</code>列已经是二进制列，不应修改。</p><h2 id="3c98" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">标签编码</h2><p id="15cf" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">标签编码</strong>用于将分类值替换为数值。这个编码<strong class="lh ja">用一个数字标签</strong>替换每个类别。在本项目中，我们使用带有以下二进制变量的标签编码:(1) <code class="fe nf ng nh ni b">gender</code>、(2) <code class="fe nf ng nh ni b">Partner</code>、(3) <code class="fe nf ng nh ni b">Dependents</code>、(4) <code class="fe nf ng nh ni b">PaperlessBilling</code>、(5) <code class="fe nf ng nh ni b">PhoneService</code>、(6) <code class="fe nf ng nh ni b">Churn</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><h2 id="0187" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">一键编码</h2><p id="8209" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">一键编码</strong>为分类变量的每一级创建<strong class="lh ja">一个新的二进制列。新列包含 0 和 1，表示数据中是否存在该类别。在这个项目中，我们对以下分类变量应用一键编码:(1) <code class="fe nf ng nh ni b">Contract</code>、(2) <code class="fe nf ng nh ni b">PaymentMethod</code>、(3) <code class="fe nf ng nh ni b">MultipleLines</code>、(4) <code class="fe nf ng nh ni b">InternetServices</code>、(5) <code class="fe nf ng nh ni b">OnlineSecurity</code>、(6) <code class="fe nf ng nh ni b">OnlineBackup</code>、(7) <code class="fe nf ng nh ni b">DeviceProtection</code>、(8) <code class="fe nf ng nh ni b">TechSupport</code>、(9) <code class="fe nf ng nh ni b">StreamingTV</code>和(10) <code class="fe nf ng nh ni b">StreamingMovies</code>。</strong></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="7fca" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这种编码的主要缺点是数据集的维数显著增加(<strong class="lh ja">维数灾难</strong>)；因此，当分类列有大量唯一值时，应避免使用此方法。</p><h2 id="4502" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">正常化</h2><p id="5c5f" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">数据规范化</strong>是机器学习中的常见做法，包括将<strong class="lh ja">数字列</strong>转换为<strong class="lh ja">通用比例。</strong>在机器学习中，有些特征值与其他特征值相差很多倍。具有较高值的特征将主导学习过程；然而，这并不意味着这些变量对预测目标更重要。<strong class="lh ja">数据标准化</strong>将多尺度数据转换为相同尺度。归一化后，所有变量对模型都有<strong class="lh ja">相似的影响</strong>，提高了学习算法的稳定性和性能。</p><p id="2dbd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">统计学中有多种<strong class="lh ja">归一化技术</strong>。在这个项目中，我们将使用最小-最大方法将数字列(<code class="fe nf ng nh ni b">tenure</code>、<code class="fe nf ng nh ni b">MontlyCharges</code>和<code class="fe nf ng nh ni b">TotalCharges</code>)调整到一个通用的比例。<strong class="lh ja">最小-最大方法</strong>(通常称为<strong class="lh ja">归一化</strong>)通过减去特征的最小值，然后除以范围，将特征重新缩放到<strong class="lh ja"> [0，1] </strong>的<strong class="lh ja">固定范围</strong>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="24b3" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">6.设定基线</h1><p id="2c17" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">在机器学习中，<strong class="lh ja">我们经常使用一个叫做基线的简单分类器来评估一个模型的性能</strong>。在这个分类问题中，<strong class="lh ja">没有流失的客户比率(最频繁的类别)可以用作基线</strong>来评估生成的模型的质量。这些模型应该优于未来预测所考虑的基线能力。</p><h1 id="2a2b" class="mi mj iq bd mk ml pq mn mo mp pr mr ms kf ps kg mu ki pt kj mw kl pu km my mz bi translated">7.拆分训练集和测试集中的数据</h1><p id="82af" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">建立模型的第一步是<strong class="lh ja">将数据分成两组</strong>，通常称为<strong class="lh ja">训练和测试集</strong>。机器学习算法使用训练集来构建模型。测试集包含不属于学习过程的样本，用于评估模型的性能。使用看不见的数据来评估模型的质量以保证客观的评估是很重要的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/f4db11e4e61ca4d87bba7c3d83934b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*L26ZxXlL-NgiLUbg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">训练集和测试集—作者创建的图像</p></figure><p id="fa90" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们创建一个变量<code class="fe nf ng nh ni b">X</code>来存储数据集的<strong class="lh ja">独立属性</strong>。此外，我们创建一个变量<code class="fe nf ng nh ni b">y</code>来只存储<strong class="lh ja">目标变量</strong> ( <code class="fe nf ng nh ni b">Churn</code>)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/feb020ce72ac5d9722cea44f84fa9459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*iJvqR4c-uBkjMt_Dnnr2Nw.png"/></div></figure><p id="bbfe" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然后，我们可以使用<code class="fe nf ng nh ni b">sklearn.model_selection</code>包中的<code class="fe nf ng nh ni b">train_test_split</code>函数来创建训练集和测试集。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="d511" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">8.评估多种算法</h1><p id="1980" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">算法选择是任何机器学习项目中的一个关键挑战</strong>，因为没有一种算法是所有项目中最好的。通常，我们需要评估一组潜在候选人，并选择那些提供更好性能的候选人进行进一步评估。</p><p id="504a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这个项目中，我们比较了<strong class="lh ja"> 6 种不同的算法，</strong>它们都已经在 Scikit-Learn 中实现。</p><ul class=""><li id="3d61" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><strong class="lh ja">虚拟分类器(基线)</strong></li><li id="f93a" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja"> K 个最近邻居</strong></li><li id="08aa" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja">逻辑回归</strong></li><li id="90e4" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja">支持向量机</strong></li><li id="5059" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja">随机森林</strong></li><li id="97a8" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja">梯度推进</strong></li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi px"><img src="../Images/5443cca9cdf097fe7bb5a043c978ee28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y_6amXUVTMJmYXYRLPtCHQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">评估多种算法—图片由作者创建</p></figure><p id="c006" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如下所示，<strong class="lh ja">所有模型在预测精度方面都优于虚拟分类器模型</strong>。因此，我们可以确认<strong class="lh ja">机器学习适用于我们的问题</strong>，因为我们观察到基线上的改进。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi py"><img src="../Images/000c92f40daadb6e99c3c0b2209388b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*WZED9gxwnUl-rSlsZ2SH7w.png"/></div></figure><p id="7ed1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">重要的是要记住<strong class="lh ja">我们已经使用默认的超参数</strong>训练了所有的算法。许多机器学习算法的准确性对选择用于训练模型的超参数高度敏感。更深入的分析将包括在为超参数调整选择一个(或多个)模型之前，对更广泛的超参数(不仅仅是默认值)进行评估。尽管如此，这超出了本文的范围。在本例中，我们将仅进一步评估使用默认超参数呈现更高准确性的模型。如上所示，这对应于<strong class="lh ja">梯度增强模型</strong>，其显示了接近 80%的准确度。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="f8e3" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">9.选择的算法:梯度增强</h1><p id="0f97" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">梯度推进</strong>是一种非常流行的机器学习<strong class="lh ja">集成方法</strong>，基于多个模型的<strong class="lh ja">顺序训练</strong>进行预测。在梯度推进中，首先，使用原始数据的随机样本建立一个模型。拟合模型后，进行预测并计算模型的残差。<strong class="lh ja">残差</strong>是实际值和模型预测值之间的差值<strong class="lh ja">。然后，根据前一个树的残差训练一个新的树，再次计算这个新模型的残差。我们重复这个过程，直到达到一个阈值(残差接近 0)，这意味着实际值和预测值之间的差异非常小。最后，<strong class="lh ja">你取所有模型预测</strong>(数据的预测和误差的预测)的总和，做出最终预测。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pz"><img src="../Images/1ace29e77e066f0d6dd8aaf392149e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0paiDhIelfDJ28um2w1YA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">梯度推进分类器—由作者创建的图像</p></figure><p id="9a0d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们可以使用来自<code class="fe nf ng nh ni b">sklearn.ensemble</code>模块的<code class="fe nf ng nh ni b">GradientBoostingClassifier</code>类，通过 Scikit-Learn 轻松构建一个<strong class="lh ja">梯度增强分类器</strong>。在<strong class="lh ja">创建了模型</strong>之后，我们需要<strong class="lh ja">训练它</strong>(使用<code class="fe nf ng nh ni b">.fit</code>方法)并且<strong class="lh ja">通过比较预测值(<code class="fe nf ng nh ni b">.predict</code>方法)和实际的类值来测试它的性能</strong>，正如你在上面的代码中看到的。</p><p id="9802" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如<strong class="lh ja"> Scikit-Learn 文档</strong>(以下链接)所示，<code class="fe nf ng nh ni b">GradientBoostingClassifier</code>有<strong class="lh ja">多个超参数</strong>；其中一些列举如下:</p><ul class=""><li id="5bf7" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">learning_rate</code>:每棵树对最终预测的贡献。</li><li id="c4bf" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">n_estimators</code>:要执行的决策树数量(提升阶段)。</li><li id="8fad" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">max_depth</code>:单个回归估计量的最大深度。</li><li id="927d" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">max_features</code>:寻找最佳分割时要考虑的特征数量。</li><li id="b078" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><code class="fe nf ng nh ni b">min_samples_split</code>:分割内部节点所需的最小样本数。</li></ul><div class="nj nk gp gr nl nm"><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ja gy z fp nr fr fs ns fu fw iz bi translated">sk learn . ensemble . gradientboostingclassifier</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">用于分类的梯度增强。GB 以向前分阶段的方式建立了一个附加模型；它允许…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">scikit-learn.org</p></div></div><div class="nv l"><div class="qa l nx ny nz nv oa ky nm"/></div></div></a></div><p id="789f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下一步是找到超参数的组合，从而对我们的数据进行最佳分类。这个过程称为超参数调整。</p><h1 id="1554" class="mi mj iq bd mk ml pq mn mo mp pr mr ms kf ps kg mu ki pt kj mw kl pu km my mz bi translated">10.超参数调谐</h1><p id="385a" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">到目前为止，我们已经将数据分为<strong class="lh ja">训练集</strong>用于<strong class="lh ja">学习模型</strong>的参数，以及<strong class="lh ja">测试集</strong>用于<strong class="lh ja">评估其性能</strong>。机器学习过程的下一步是执行超参数调整。超参数的<strong class="lh ja">选择</strong>包括根据超参数的不同组合测试模型的性能，根据<strong class="lh ja">选择的度量</strong>和<strong class="lh ja">验证方法</strong>选择那些性能最好的。</p><p id="bd21" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对于超参数调整，<strong class="lh ja">我们需要将我们的训练数据再次分成一组用于训练的数据和一组用于测试超参数的数据(通常称为验证集)。使用<strong class="lh ja"> k 倍</strong> <strong class="lh ja">交叉验证进行超参数调优</strong>是非常常见的做法。训练集被再次分成 k 个大小相等的样本，1 个样本用于测试，其余 k-1 个样本用于训练模型，重复 k 次。然后，k 个评估度量(在这种情况下是精确度)被平均以产生单个估计量。</strong></p><p id="7192" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">需要强调的是<strong class="lh ja">验证集用于超参数选择，而不是评估我们模型</strong>的最终性能，如下图所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/a3da41216ad73b301249dad38cb435ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*luMRjozO04FWO0MbZcXJnw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">交叉验证的超参数调整—图片由作者创建</p></figure><p id="15bb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">有多种技术可以找到模型的最佳超参数。最常用的方法有(1) <strong class="lh ja">网格搜索</strong>、(2) <strong class="lh ja">随机搜索</strong>、(3) <strong class="lh ja">贝叶斯优化</strong>。<strong class="lh ja">网格搜索测试超参数的所有组合</strong>并选择表现最好的一个。这是一个非常耗时的方法，尤其是当要尝试的超参数和值的数量非常大的时候。</p><p id="cbea" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<strong class="lh ja">随机搜索</strong>中，您指定一个超参数网格，然后<strong class="lh ja">随机组合被选择</strong>，其中每个超参数组合被采样的机会相等。我们不分析超参数的所有组合，而只分析这些组合的随机样本。这种方法在计算上比尝试所有组合更有效；然而，它也有一些缺点。<strong class="lh ja">随机搜索</strong>的主要缺点是<strong class="lh ja">并非网格的所有区域都被均匀覆盖，</strong>尤其是当从网格中选择的组合数量很少时。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi qc"><img src="../Images/1bd8cbdf0328729c35064cdfa82c5a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZbKTvl1koe5Qo4YY4pCehQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">网格搜索与随机搜索——作者创建的图像</p></figure><p id="854d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们可以使用<code class="fe nf ng nh ni b">sklearn.model_selection</code>包中的<code class="fe nf ng nh ni b">RandomSearchCV</code>类在 Scikit-learn 中实现<strong class="lh ja">随机搜索</strong>。</p><p id="7d6c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们使用字典(<code class="fe nf ng nh ni b">grid_parameters</code>)指定<strong class="lh ja">超参数值</strong>的网格，其中<strong class="lh ja">键</strong>表示<strong class="lh ja">超参数</strong>，而<strong class="lh ja">值</strong>是我们想要评估的<strong class="lh ja">选项集</strong>。然后，我们定义了<code class="fe nf ng nh ni b">RandomizedSearchCV</code>对象，用于从这个网格中尝试不同的随机组合。被采样的超参数组合的数量在<code class="fe nf ng nh ni b">n_iter</code>参数中定义。自然地，增加<code class="fe nf ng nh ni b">n_iter</code>将在大多数情况下导致更精确的结果，因为更多的组合被采样；然而，在许多情况下，性能的提高并不显著。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/15f467deb8d1f24e3653186400030dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*cx_knFqMBv2VYZQ0SsfUFQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="1ccb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">拟合网格对象后，我们可以使用<code class="fe nf ng nh ni b">best_params_</code>属性获得<strong class="lh ja">最佳超参数</strong>。如上所述，最好的超参数是:<strong class="lh ja"> {'n_estimators': 90，' min_samples_split': 3，' max_features': 'log2 '，' max_depth': 3} </strong>。</p><h1 id="5b2c" class="mi mj iq bd mk ml pq mn mo mp pr mr ms kf ps kg mu ki pt kj mw kl pu km my mz bi translated">11.模型的性能</h1><p id="1a80" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">机器学习过程</strong>的最后一步是<strong class="lh ja">通过使用混淆矩阵和一些评估指标来检查模型</strong>(最佳超参数)的性能。</p><h2 id="9f18" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">混淆矩阵</h2><p id="8edc" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated"><strong class="lh ja">混淆矩阵</strong>，也称为误差矩阵，用于<strong class="lh ja">通过检查正确和错误分类的观察值数量来评估机器学习模型</strong>的性能。<strong class="lh ja">矩阵的每一列包含预测类别，而每一行代表实际类别，反之亦然</strong>。在完美的分类中，除了对角线之外，混淆矩阵将全为零。主对角线之外的所有元素代表错误分类。重要的是要记住，混淆矩阵允许我们观察错误分类的模式(错误分类的类别和程度)。</p><p id="02ce" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<strong class="lh ja">二元分类问题</strong>中，<strong class="lh ja">混淆矩阵</strong>是一个由 4 个元素组成的<strong class="lh ja"> 2 乘 2 矩阵</strong>:</p><ul class=""><li id="372e" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><strong class="lh ja"> TP(真阳性)</strong>:被正确归类为患病的脊柱问题患者人数。</li><li id="6989" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja"> TN(真阴性)</strong>:被正确分类为健康的无病变患者的数量。</li><li id="3196" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja"> FP(假阳性)</strong>:被错误归类为患病的健康患者人数。</li><li id="98f5" class="ob oc iq lh b li ok ll ol lo om ls on lw oo ma ot oh oi oj bi translated"><strong class="lh ja"> FN(假阴性)</strong>:被误分类为健康的脊柱疾病患者数量。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/1d5c5b4555f6662f737298e5b4c8415c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*eGR-BAWE7Hr-8-jm.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">困惑矩阵——作者创造的图像</p></figure><p id="5083" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">既然模型已经训练好了，是时候使用测试集来评估它的性能了。</strong>首先，我们使用之前的模型(具有最佳超参数的梯度推进分类器)来预测测试数据的类别标签(使用<code class="fe nf ng nh ni b">predict</code>方法)。然后，我们使用来自<code class="fe nf ng nh ni b">sklearn.metrics</code>包的<code class="fe nf ng nh ni b">confusion_matrix</code>函数构建混淆矩阵，以检查哪些观察值被正确分类。输出是一个 NumPy 数组，其中<strong class="lh ja">行表示真实值</strong>而<strong class="lh ja">列表示预测类</strong>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/f2130431495aa05946206fada347cada.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*GATL1bzsd-pJ-7V43S0O7Q.png"/></div></figure><p id="4f51" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如上所示，测试数据的 1402 个观察值被模型正确分类(1154 个真阴性和 248 个真阳性)。相反，我们可以观察到 356 个错误分类(156 个假阳性和 200 个假阴性)。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="5df6" class="ou mj iq bd mk ov ow dn mo ox oy dp ms lo oz pa mu ls pb pc mw lw pd pe my iw bi translated">评估指标</h2><p id="cb83" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">评估模型的质量是机器学习过程的基本部分。最常用的<strong class="lh ja">绩效评估指标</strong>是根据混淆矩阵的元素计算出来的。</p><ul class=""><li id="245d" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><strong class="lh ja">准确性:</strong>它代表被正确分类的预测的比例。准确性是最常用的评估指标；但是，请务必记住，在处理不平衡的数据集时，准确性可能会产生误导。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/0498ab20de6f1dc8bae63bdd7e7e3d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/0*G3PGqTrNrWOgZwGQ"/></div></figure><ul class=""><li id="52ba" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><strong class="lh ja">灵敏度:</strong>表示被识别为阳性的样本(患病患者)的比例。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/7e43659c09ee23ad7d340eccc434e6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/0*_9qGqnEdpkiVCV1W"/></div></figure><ul class=""><li id="cea8" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><strong class="lh ja">特异性:</strong>表示阴性样本(健康患者)的比例。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/c70268bfc4f8fd6dcf401914b692dc42.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*qdQJGmfnttCXXiEL"/></div></figure><ul class=""><li id="ad8b" class="ob oc iq lh b li lj ll lm lo od ls oe lw of ma ot oh oi oj bi translated"><strong class="lh ja">精度:</strong>代表实际正确的正面预测比例。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qi"><img src="../Images/a693ddd9183859d36e6b632e5ed9de1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/0*18JQw9BFYbAaYVCu"/></div></figure><p id="4c7e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们可以使用混淆矩阵的数字来手动计算评估指标。或者，Scikit-learn 已经实现了函数<code class="fe nf ng nh ni b">classification_report</code>，该函数为<strong class="lh ja">提供了关键评估指标</strong>的摘要。分类报告包含每个类别达到的精度、灵敏度、f1 值和支持度(样本数)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/22ad65dc1305e6a2ce41c5209029cb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*wguB79nuFReEtYcPXHqnuQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者创造的形象</p></figure><p id="f58b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如上图所示，我们获得了 0.55 (248/(200+248))的<strong class="lh ja">灵敏度</strong>和 0.88 (1154/(1154+156))的<strong class="lh ja">特异性</strong>。所获得的模型更准确地预测了不会流失的客户。这不应该让我们感到惊讶，因为<strong class="lh ja">梯度提升分类器通常偏向于具有更多观察值的类别</strong>。</p><p id="4d0c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您可能已经注意到，之前的总结不包含分类的准确性。然而，这可以通过使用<code class="fe nf ng nh ni b">metrics</code>模块中的函数<code class="fe nf ng nh ni b">accuracy_score</code>很容易地计算出来。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi qk"><img src="../Images/733003171435e6c527e0a4a1c289af90.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*T9Mk6DNc5p9BflJ8qmWHYw.png"/></div></figure><p id="df30" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">正如您所观察到的，超参数调整几乎没有增加模型的准确性。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="a246" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">12.得出结论——总结</h1><p id="874b" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">在本帖中，我们使用<strong class="lh ja">电信客户流失</strong>数据集完成了一个完整的端到端机器学习项目。我们从清理数据开始，并用可视化分析它。然后，为了能够建立机器学习模型，我们将分类数据转换为数字变量(特征工程)。在转换数据后，我们使用默认参数尝试了 6 种不同的机器学习算法。最后，我们调整了用于模型优化的<strong class="lh ja">梯度提升分类器</strong>(最佳性能模型)的超参数，获得了近 80% (比基线高近 6%)的<strong class="lh ja">准确度。</strong></p><p id="f38e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">需要强调的是，机器学习任务的<strong class="lh ja">确切步骤因项目</strong>而异。虽然在文章中我们遵循了线性过程，但机器学习<strong class="lh ja">项目往往是迭代的，而不是线性过程</strong>，当我们对我们试图解决的问题了解更多时，以前的步骤往往会被重新审视。</p><p id="1518" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">阿曼达·伊格莱西亚斯</p></div></div>    
</body>
</html>