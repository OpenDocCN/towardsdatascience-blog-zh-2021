<html>
<head>
<title>How To Visualize Machine Learning Results Like a Pro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何像专业人士一样可视化机器学习结果</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualize-machine-learning-metrics-like-a-pro-b0d5d7815065?source=collection_archive---------13-----------------------#2021-12-27">https://towardsdatascience.com/visualize-machine-learning-metrics-like-a-pro-b0d5d7815065?source=collection_archive---------13-----------------------#2021-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0548" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">只用一行代码</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fb3e274b5a617e5aa27746f8c4b96090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wxMSOYR0AjaGyNNvGyuvlw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/@mikhail-nilov?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">米哈伊尔·尼洛夫</a>从<a class="ae kv" href="https://www.pexels.com/photo/woman-holding-papers-standing-next-to-a-charts-bulletin-9304688/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>拍摄</p></figure><h1 id="3b37" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">动机</h1><p id="0a15" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">评估机器学习模型是机器学习工作流程中的一个重要步骤。在本文中，我们研究了如何使用 Scikit-plot 轻松可视化各种常见的机器学习指标。虽然它的名字可能表明它只与 Scikit-learn 模型兼容，但 Scikit-plot 可用于任何机器学习框架。在幕后，Scikit-plot 使用 matplotlib 作为它的图形库。</p><p id="2340" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">Scikit-plot 最好的部分是它只需要一行代码来可视化每个指标。</p><h1 id="ed84" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">设置</h1><p id="a424" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">安装软件包</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8c51" class="mu kx iq mq b gy mv mw l mx my">pip install scikit-plot==0.3.7</span></pre><p id="a68e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">导入必要的包</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="29b1" class="mu kx iq mq b gy mv mw l mx my">import pandas as pd<br/>import numpy as np<br/>from sklearn import datasets<br/>from sklearn.ensemble import GradientBoostingClassifier, RandomForestClassifier<br/>from sklearn.model_selection import cross_val_predict, train_test_split</span><span id="45fd" class="mu kx iq mq b gy mz mw l mx my">import scikitplot as skplt</span></pre><p id="a17b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了演示 Scikit-plot，我们将使用乳腺癌数据集训练一个简单的随机森林和梯度增强分类器。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="307a" class="mu kx iq mq b gy mv mw l mx my">X,y = datasets.load_breast_cancer(return_X_y = True)<br/>X_train, X_test, y_train, y_test = train_test_split(X,y, test_size = 0.3, stratify = y)</span><span id="df09" class="mu kx iq mq b gy mz mw l mx my">gbc = GradientBoostingClassifier()<br/>gbc_model = gbc.fit(X_train, y_train)<br/>y_gbc_proba = gbc_model.predict_proba(X_test)<br/>y_gbc_pred = np.where(y_gbc_proba[:,1] &gt; 0.5, 1, 0)</span><span id="3da0" class="mu kx iq mq b gy mz mw l mx my">rfc = RandomForestClassifier()<br/>rfc_model = rfc.fit(X_train, y_train)<br/>y_rfc_proba = rfc_model.predict_proba(X_test)<br/>y_rfc_pred = np.where(y_rfc_proba[:,1] &gt; 0.5, 1, 0)</span></pre><p id="9887" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们看看如何使用 Scikit-plot 来可视化各种指标。</p><h1 id="05a2" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">混淆矩阵</h1><p id="6b08" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">混淆矩阵将基础事实与预测标签进行比较，并将结果分为真阳性、真阴性、假阳性和假阴性。为了绘制混淆矩阵，我们简单地调用<code class="fe na nb nc mq b">plot_confusion_matrix</code>方法。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c4e0" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_confusion_matrix(y_test, y_gbc_pred, normalize=False, title = 'Confusion Matrix for GBC')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3867d296decbf2ecbe78177d409abb7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/0*tlilIbd24EJgZuDD"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e51b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">要显示 0 到 1 之间的标准化值，只需将<code class="fe na nb nc mq b">normalize</code>参数设置为<code class="fe na nb nc mq b">True</code></p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="424c" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_confusion_matrix(y_test, y_gbc_pred, normalize=True, title = 'Confusion Matrix for GBC')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/df7ac9f580427ff3a6e5d90d6f3c5ca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/0*GX3Nxro85BMk_UOv"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="97f9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">受试者工作特性曲线</h1><p id="b9c3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">ROC 曲线显示了分类器在所有分类阈值下相对于随机基线分类器的性能(真阳性率，也称为召回率和假阳性率)。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0e88" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_roc(y_test, y_gbc_proba, title = 'ROC Plot for GBC')</span></pre><p id="f98e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">默认情况下，ROC 图带有宏观和微观平均值。我们可以通过将<code class="fe na nb nc mq b">plot_micro</code>或<code class="fe na nb nc mq b">plot_macro</code>参数设置为<code class="fe na nb nc mq b">False</code>来隐藏这些情节线。<code class="fe na nb nc mq b">plot_roc</code>方法显示所有类别的所有 roc 曲线，并且图表在多类别绘图中可能会变得混乱，因此我们可以通过传递<code class="fe na nb nc mq b">classes_to_plot</code>参数来选择绘制特定类别的 roc 曲线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c1f497b3319c169f54954684baabd017.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/0*lVQnX3UvXQbeLpgG"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="db2c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">精确召回曲线(PR 曲线)</h1><p id="6556" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">精确度和召回率曲线显示所有分类阈值的精确度和召回率值。它总结了精确度和召回率之间的权衡。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="b5c2" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_precision_recall(y_test, y_gbc_proba, title = 'PR Curve for GBC')</span></pre><p id="b10d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">默认情况下，精确召回曲线带有宏观和微观平均值。我们可以通过将<code class="fe na nb nc mq b">plot_micro</code>或<code class="fe na nb nc mq b">plot_macro</code>参数设置为<code class="fe na nb nc mq b">False</code>来隐藏这些情节线。<code class="fe na nb nc mq b">plot_precision_recall</code>显示所有类别的 PR 曲线，在多类别图中图表可能会变得混乱，因此我们可以通过传递<code class="fe na nb nc mq b">classes_to_plot</code>参数来选择绘制特定类别的 PR 曲线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/751b0442788798c087ed325b5a15a6e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/0*Lf5iNlV8m2XyF3Qo"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="136a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">校准图</h1><p id="8a7d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">校准图也称为概率校准曲线，是一种检查预测值是否可以直接解释为置信水平的诊断方法。例如，校准良好的二进制分类器应该对样本进行分类，使得对于概率约为 0.8 的样本，大约 80%的样本来自正类。该函数仅适用于二元分类任务。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d06e" class="mu kx iq mq b gy mv mw l mx my">probas_list = [y_gbc_proba, y_rfc_proba]<br/>clf_names = ['GBC', 'RF']<br/>skplt.metrics.plot_calibration_curve(y_test, probas_list = probas_list, clf_names = clf_names)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/268faa4d4995281833fdf95f7eaf3453.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/0*MTtfTo9SSdSQXRRx"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="b0ac" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">累积增益曲线</h1><p id="7ea2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">累积增益曲线显示模型的性能，并与随机基线分类器进行比较。它显示了在考虑概率最高的一部分人口时实现目标的百分比。该功能仅适用于二元分类。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="dc89" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_cumulative_gain(y_test, y_gbc_proba, title = 'Cumulative Gains Chart for GBC')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/01b35d053888698e92d7b113f59ce17a.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/0*ZeWTfccDatXc2hZb"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="e508" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">升力曲线</h1><p id="31da" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">提升曲线显示了当考虑具有最高概率的人群的一部分时，与随机基线分类器相比，每个类别的响应率。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="b0cb" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_lift_curve(y_test, y_gbc_proba, title = 'Lift Curve for GBC')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/41224a87abdaafb123507599c4645de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/0*vzVI5Ukds_cnCYsB"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="89c8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">调整图表属性</h1><p id="25f8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Scikit-plot 允许用户分别使用<code class="fe na nb nc mq b">figsize</code>、<code class="fe na nb nc mq b">title_fontsize</code>和<code class="fe na nb nc mq b">text_fontsize</code>参数调整基本属性，如图形大小、标题字体大小和文本字体大小。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="ac1e" class="mu kx iq mq b gy mv mw l mx my">skplt.metrics.plot_lift_curve(y_test, y_gbc_proba, title = 'Lift Curve for GBC', figsize = (10,10), title_fontsize = 20, text_fontsize = 20)</span></pre><p id="16e0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">此外，这些方法还通过<code class="fe na nb nc mq b">ax</code>参数接受<code class="fe na nb nc mq b">matplotlib.axes.Axes</code>对象。这很有用，因为我们可以定义要绘制的轴。例如，我们希望在同一个子图上并排绘制累积收益图和提升曲线。我们可以首先创建一个 1x2 子图网格，并使用<code class="fe na nb nc mq b">ax</code>参数在子图的不同网格中绘制每个图表。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="7950" class="mu kx iq mq b gy mv mw l mx my">fig, ax = plt.subplots(1,2)<br/>skplt.metrics.plot_cumulative_gain(y_test, y_gbc_proba, ax = ax[0], title = 'Cumulative Gains Chart for GBC')<br/>skplt.metrics.plot_lift_curve(y_test, y_gbc_proba, ax = ax[1],  title = 'Lift Curve for GBC')<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3e0c526aa4910a7b2a2a4658b7101be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/0*ok1OBYmA9d68A2sW"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3b8b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这些方法的输出是<code class="fe na nb nc mq b">matplotlib.axes._subplots.AxesSubplot</code>对象，我们可以使用 matplotlib 方法进一步操作这些对象。例如，我们可以执行以下操作来调整垂直轴的范围。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="381f" class="mu kx iq mq b gy mv mw l mx my">import matplotlib.pyplot as plt<br/>ax = skplt.metrics.plot_lift_curve(y_test, y_gbc_proba, title = 'Lift Curve for GBC')<br/>ax.set_ylim(0,3)</span></pre><h1 id="ad3f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="92b5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们研究了如何使用一行代码绘制各种常见的机器学习指标，以及如何使用 matplotlib 调整图表属性以满足我们的需求。Scikit-plot 中还有很多我们在本文中没有涉及到的功能，比如为聚类问题绘制肘图和剪影图。查看<a class="ae kv" href="https://scikit-plot.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Scikit-plot </a>文档了解更多详情。</p></div></div>    
</body>
</html>