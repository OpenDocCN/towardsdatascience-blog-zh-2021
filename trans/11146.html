<html>
<head>
<title>Temporal Coils: Intro to Temporal Convolutional Networks for Time Series Forecasting in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时态线圈:Python中时间序列预测的时态卷积网络介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/temporal-coils-intro-to-temporal-convolutional-networks-for-time-series-forecasting-in-python-5907c04febc6?source=collection_archive---------3-----------------------#2021-11-01">https://towardsdatascience.com/temporal-coils-intro-to-temporal-convolutional-networks-for-time-series-forecasting-in-python-5907c04febc6?source=collection_archive---------3-----------------------#2021-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aa2b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个TCN教程，使用飞镖多方法预测库</h2></div><p id="1717" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">昨天的文章提供了一个关于<em class="le">递归神经网络(RNNs)的教程:</em>它们的<em class="le"> LSTM，GRU，</em>和<em class="le">香草</em>变种。今天我们来补充一下<strong class="kk iu">时态卷积网络(TCNs)，</strong>作为这个关于时间序列预测器的小编第四篇文章的第十种方法。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/6ec5f1f94a791f8236e35b31b202de0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*0bKhs9KPDEGpuIddKCfa3Q.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><a class="ae lr" href="https://pixabay.com/illustrations/coil-slinky-spring-flexible-spiral-632650/" rel="noopener ugc nofollow" target="_blank">螺旋弹簧，数字艺术家，皮特·林弗斯Pixabay上的免费图片</a></p></figure><ul class=""><li id="3a18" class="ls lt it kk b kl km ko kp kr lu kv lv kz lw ld lx ly lz ma bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/temporal-loops-intro-to-recurrent-neural-networks-for-time-series-forecasting-in-python-b0398963dc1f">时间循环:Python中用于时间序列预测的递归神经网络简介|走向数据科学</a></li><li id="90b8" class="ls lt it kk b kl mb ko mc kr md kv me kz mf ld lx ly lz ma bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/wisdom-of-the-forecaster-crowd-f70b398f190b">预测者群体的智慧。面向数据科学的Python |时间序列集合预测</a></li><li id="a757" class="ls lt it kk b kl mb ko mc kr md kv me kz mf ld lx ly lz ma bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/darts-swiss-knife-for-time-series-forecasting-in-python-f37bb74c126">飞镖的时间序列预测瑞士刀|走向数据科学</a></li></ul><p id="57f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RNN教程通过描述神经网络的核心特征和术语，提供了一般神经网络和递归神经网络的快速运行。今天的文章将从这个基础开始，然后强调时态卷积网络不同于RNNs的方面。</p><p id="326e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将通过使用<em class="le"> Darts </em>库构建一个TCN，它包装了<em class="le"> PyTorch </em>包中可用的神经网络；<em class="le"> </em>然后在一个小型锦标赛中运行我们的TCN，对抗三个RNN变体和我们昨天遇到的Theta方法。</p><h1 id="f4a5" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">1.时间卷积网络的概念</h1><p id="475e" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">卷积神经网络(CNN)通常应用于计算机视觉任务:图像或视频识别和分类。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/3b970281d20f82fd1a965d826932f1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*iomGTUusOB-gQFDo1TDCQg.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><a class="ae lr" href="https://pixabay.com/illustrations/projector-film-movie-the-movie-4598558/" rel="noopener ugc nofollow" target="_blank">Alexander Lesnitsky的投影仪电影《The》——pix abay上的免费图像</a></p></figure><p id="9af9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Sumit Saha在2018年发表的一篇文章对CNN在图像处理中的应用进行了出色的概述(<a class="ae lr" rel="noopener" target="_blank" href="/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53">卷积神经网络综合指南ELI5 way |作者Sumit Saha |迈向数据科学</a>)。</p><p id="fb68" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">受视觉皮层早期研究的启发，卷积神经网络的基本架构于1979年首次提出。由此产生的“neocognitron”被应用于手写日文字符的识别。</p><p id="f7b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CNN的核心架构由输入层、隐藏层(其中包括卷积层)和输出层组成。隐藏层执行卷积。<em class="le">汇集</em>层收集整理中间成果。<em class="le">完全连接的</em>层试图导出描述输入值到输出的映射的非线性函数。类似于RNNs，TCN也有一个<em class="le">成本</em>或<em class="le">损失函数</em>，它试图将其最小化以减少预测误差。</p><p id="7dfe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个<em class="le">卷积</em>是积分学中的一个运算。卷积采用两个函数，其中一个被反转和移位，并计算它们乘积的积分。卷积函数表示一个函数的形状如何被另一个函数修改。卷积类似于<em class="le">互相关</em>，因为它反映了两个系列或序列的相似性。</p><p id="cf91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据计算机视觉术语，给定节点监管的输入被称为<em class="le">感受野</em>或<em class="le">小块</em>。每个节点接收来自网络前一层的有限区域的输入，即节点的感受域。</p><p id="7ed3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CNN将<em class="le">过滤器</em>应用于输入，以检测特征的存在。它的节点或神经元充当这些过滤器。</p><p id="4763" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在图像中，形状或颜色可以代表一个特征。一个<em class="le">过滤器</em>可以专门用于例如垂直线的检测。其他过滤器会将自己与其他特征挂钩，例如水平线。在时间序列中，趋势或季节性是需要隔离的特征。滤波器的值是CNN将在训练期间校准的权重，以最小化损失函数中表达的预测误差。当在搜索拍照宠物时对图像进行分类时，CNN将学习分离狗或猫的特征，从而在它训练的过滤器的帮助下建立一个狗或猫的分类器。在处理时间序列时，它可以学习识别它们的趋势和季节性模式。</p><p id="e923" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">节点创建一个<em class="le">特征图，</em>映射出特征的存在。过滤器穿过其输入面片，并检查其是否存在该特征。结果收集在要素地图中。内核或特征检测器是一个二维权重数组。内核穿过图像的感受野来检测特征。滤波器在输入端移动的距离称为<em class="le">步幅</em>。</p><p id="62ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">完全连接的</em>层接收提取的特征作为输入，并应用激活函数。这一层之所以得名，是因为它将一层中的每个节点与另一层中的每个节点连接起来:全连接层中节点的感受野是整个前一层。完全连接的层构建了一个通常非线性的函数，该函数将它从前一层接收的特征联系在一起。</p><p id="b83b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CNN通过一系列的训练时期——前馈接着反向传播——学习从本质特征中挑选出不重要的特征。</p><p id="9986" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">时间卷积网络</strong>——最近的发展(<a class="ae lr" href="https://arxiv.org/abs/1803.01271" rel="noopener ugc nofollow" target="_blank">一种用于序列建模的通用卷积和递归网络的经验评估(arxiv.org)</a>)——将递归神经网络的某些属性添加到经典的CNN设计中。</p><p id="4a90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">TCN确保<em class="le">因果卷积</em>。输出值必须只依赖于在输入序列中位于前面的值。</p><p id="b88c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">TCN中的扩张</em>将一个节点的感受野扩大到包含更多的历史时期。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/52e063d4827e9e6f952ca804fb04f005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*yXTv-ZAz-TPT7aT_FvbgxA.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><a class="ae lr" href="https://pixabay.com/photos/coil-high-voltage-technology-4320892/" rel="noopener ugc nofollow" target="_blank">线圈高压技术电源，由analog us-pix abay上的免费照片</a></p></figure><h1 id="fcd3" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">2.属国</h1><p id="f381" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">在Darts模型中，我们现在还在第8行中导入了TCNModel子类。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="41e3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们对昨天与RNN相关的脚本做了一个小小的改动，对三个rnn和TCN进行了不同于0.1的<em class="le">漏失</em>水平的实验。<em class="le"> Dropout </em> level表示打开或关闭网络中节点的选项。这是为了防止过度拟合。节点不容易越来越深地陷入连接节点的特定配置中。卷积网络具有更高的过拟合倾向，因此我们不会关闭压差。</p><p id="49ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Darts集成了一些经典的数据源，其中包括Box &amp; Jenkins的<em class="le"> airline passenger </em>数据集，我们可以从库中加载该数据集，而无需导入文件。</p><p id="7667" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在航空公司乘客的例子中，我选择1958年8月1日作为测试周期的开始，用常量FC_START表示。我们将预测12个月，输入常量FC_N。</p><h1 id="6706" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">3.准备数据</h1><p id="22df" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">Darts的<em class="le"> load() </em>函数允许我们将时间序列读入一个<em class="le"> timeseries </em>对象<em class="le">。</em></p><p id="d3fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数<em class="le"> pd_dataframe() </em>可以将timeseries对象转换为“正常”序列和dataframe，使其与pandas提供的数据争论方法兼容。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/5514890dbbb9c1a1fae87f4f1daf568e.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*6UgvF8aevlC55u5MJQmmiQ.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a7ad5f8e8b995e9798e5d6874832517e.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*mYmefN_xcrEJjJGtqgaYxw.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/14fecb4491385a5f045847dccced78ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJHBe9sbs0UhpKJm2bIDwQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="7339" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该图表揭示了一个非常类似于一个日历年中12个月的季节性。为了证实这一点，我们应用了Darts的<em class="le">check _ seasonity()</em>检验，该检验评估自相关函数ACF。测试证实时间序列的周期正好是12.0个月。就像图表一样，这表明时间序列具有相对简单的模式。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/4fba6884d93db5170c1ddde9013d8693.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*ekWhMvr9dtbrY0e2TaiO8g.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nn"><img src="../Images/aaed437b4cccbe07c8ea80e99c36161b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQeL4wQLT9nUV4iAQZLWmA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="96f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将时间序列拆分为一个训练数据集和一个验证数据集，时间段FC_START是我们在dependencies单元格中选择的常量:19580801。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c758" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在将源数据输入神经网络之前，我们需要通过应用一个<em class="le"> Scaler() </em>函数来规范化它们。归一化抵消了前一篇文章提到的<em class="le">爆炸梯度问题</em>。缩放还将使神经网络更容易运行梯度下降来搜索最小预测误差。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b5e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">目前，时间序列的日期是用字符串编码的。为了使TCN能够识别时间步长，我们从这些字符串中提取月份，并通过应用Darts '<em class="le">datetime _ attribute _ time series()</em>函数将它们定义为第二列—协变量或外生回归变量。然后我们用一个定标器将协变量标准化。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h1 id="e0d6" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">4.模型的设置</h1><p id="89ac" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">列表<em class="le">模型</em>排列了我们想要在时间序列上释放的四个神经网络:我们今天介绍的TCN模型；以及我们在昨天的教程中设计的三种类型的递归神经网络:LSTM、GRU和香草RNN。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="799e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第5行，我们准备了一个条件列表理解，它将一个接一个地读取四个模型，并将它们传递给我们将在下面编写的设置函数。</p><p id="36bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意列表理解中的'<em class="le"> if — else' </em>条件。TCN和RNN的参数设置不同，因此list comprehension为它们调用了不同的函数——<em class="le">run _ TCN()</em>和<em class="le"> run_RNN() </em>。它将在变量<em class="le"> res_models </em>中收集它们的结果——预测准确性指标。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/075fdd906969c33737d8e2458578b822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*9AuxkHZZ7J32vgmEYJHj_g.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="a6d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RNN模型的训练函数，<em class="le"> run_RNN() </em>，基本上与我们在昨天的文章中讨论的相同。我将跳过RNNs的部分，重点放在TCN。</p><p id="cb05" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">函数<em class="le"> run_TCN() </em>具有类似的形状，但是在某些方面与RNNs不同。</p><p id="7250" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将<em class="le"> input_chunk_length — </em>用于预测的过去时间段的数量—设置为13个月，比<em class="le">check _季节性</em>测试返回的周期多1个月。RNN将回顾过去13个月，一个完整的季节周期，来计算预测。</p><p id="b31a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们选择的<em class="le"> output_chunk_length </em>包含一个完整的季节周期的12个月。它必须严格小于input_chunk_length，因此输入为13个月。预测范围受限于输出长度。</p><p id="f5ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了进行实验，我们将<em class="le">辍学</em>水平设置为0.1，而不是我们之前使用的零比率。下降水平将有助于模拟不同的网络架构。在每个时期，网络会选择一组不同的神经元，并暂时移除。不同的神经元组合然后做出预测。这些重组将防止TCN过度适应同一组神经元。</p><p id="94c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">过滤器的<em class="le">数量</em>应该反映时间序列中固有模式的假定复杂性。我们从折线图中获得的视觉线索表明了一个相对简单的时间序列，具有趋势和季节性的单一顺序。因此，三到五个过滤器应该足以反映其复杂性。</p><p id="797b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">布尔参数<em class="le"> weight_norm </em>确定TCN是否将使用权重归一化。归一化具有权重向量的长度与其方向解耦的效果，这将加速朝向最小误差的梯度下降(<a class="ae lr" href="https://proceedings.neurips.cc/paper/2016/file/ed265bc903a5a097f61d3ec064d96d2e-Paper.pdf" rel="noopener ugc nofollow" target="_blank">权重归一化:加速深度神经网络训练的简单重新参数化(neurips.cc) </a>)。然而，一项研究发现，一种替代方法，批量归一化，可能会导致更好的测试准确性(<a class="ae lr" href="https://arxiv.org/abs/1709.08145" rel="noopener ugc nofollow" target="_blank">【1709.08145】大规模图像分类的批量归一化和权重归一化算法的比较(arxiv.org)</a>)。因此，重量定额是一个用户可以选择调整的超参数。</p><p id="acf5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">膨胀基数</em>因子<em class="le"> </em>使TCN延伸到时间上更早的节点。这扩展了一个节点的感受域以包含更多的历史时期。它为TCN提供了记忆。<em class="le">内核大小</em>应设置为至少与选择的膨胀因子一样大。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="a346" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第6行到第18行建立模型之后，我们将它与第23行到第28行的训练数据相匹配。拟合器参考训练和验证数据集，并使用它们的时间序列值和我们定义为协变量的月份系列。</p><p id="29dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第35到37行得出12个月的预测值。</p><p id="d52d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第40行，我们调用了与RNN模型相同的绘图仪函数<em class="le"> plot_fitted() </em>。</p><p id="e746" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第43行将预测值和实际值提供给<em class="le"> accuracy_metrics() </em>函数，该函数将计算平均绝对百分比误差和一些其他预测质量指标。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e119" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当脚本拟合四个模型时，它会显示其进度，然后报告结果准确性指标:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/e3f88c91ccbd4853cdaa40dda4faff9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*kLLpyepbj-haxP5QvB3WYw.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/69449bdb6e4c3800df4df52fc40efc1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtwfOVRPaC-yjZzOCl2TnA.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="3126" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">绘图仪功能绘制实际观测值和12个月的预测值。蓝色预测值的线条与黑色实际曲线相对接近。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nr"><img src="../Images/3ea0a17a85d07e86e0f3a222c21251c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ipd9k7TGMMuOrAK0QPlAnw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi ns"><img src="../Images/ff08f74966f400f4d60457bb9a643c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKDqzo9XEMOtYT4MbrupFQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="1e16" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">递归神经网络的LSTM变体拥有最低的MAPE，为5.38%，其次是香草味，为5.95%。在本例中，TCN无法发挥其优势，报告的MAPE明显高于三个rnn，为7.99%。</p><p id="7b1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们昨天所做的，我们通过应用非神经网络预测器(Theta方法)准备了一个快速基准预测，它将在几秒钟内运行，并将该基准与TCN和RNNs进行比较。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nt"><img src="../Images/9f25aed151d22275b66c0256f1be5578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyObBAEuqNsjVmADE0ItXQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><h1 id="dd00" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">5.结论</h1><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/510cfc09bf4ecb13303a9505d12688da.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*Ax4K2Y0J5_6Y7TdudhXwQA.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">作者图片</p></figure><p id="9313" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Theta预测的预测误差排在所有三种RNN风味之后，尽管它的MAPE和均方根百分比误差RMSPE低于TCN。</p><p id="d2e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本例中，TCN的绝对RMSE和R平方(预测中的运动份额与实际观测中的运动一致)优于θ。但是三个rnn仍然胜过TCN和西塔。</p><p id="fa9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个特殊的例子不太适合TCN，但对更复杂模式的时间序列问题的研究——例如厄尔尼诺-南方涛动的预测，太平洋表面的周期性、非季节性变暖——发现TCN的准确性优于递归神经网络(【times提前预测的时间卷积网络|(nature.com) )。</p><p id="8965" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Jupyter笔记本可在GitHub下载:<a class="ae lr" href="https://github.com/h3ik0th/Darts_TCN_RNN" rel="noopener ugc nofollow" target="_blank">h3ik0th/Darts _ TCN _ RNN:Darts(github.com)中用TCN和RNN神经网络进行时间序列预测</a></p></div></div>    
</body>
</html>