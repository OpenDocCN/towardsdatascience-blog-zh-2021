<html>
<head>
<title>A day in the life of a blockchain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区块链人生活中的一天</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-day-in-the-life-of-a-blockchain-eb352980ee16?source=collection_archive---------40-----------------------#2021-08-13">https://towardsdatascience.com/a-day-in-the-life-of-a-blockchain-eb352980ee16?source=collection_archive---------40-----------------------#2021-08-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="015c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">…从数据科学家的角度来看</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/14f972d369d0c53ee9806eab4fe62757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XxusVC4adCZK27tR"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@zinebfafa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Zineb Fafa </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="3772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">正如我在<a class="ae ky" rel="noopener" target="_blank" href="/data-science-for-blockchain-understanding-the-current-landscape-c136154c367e">之前的一篇文章</a>中所讨论的那样，区块链产生了大量高质量的数据，数据科学家可以用这些数据来回答一系列具有学术和实践重要性的问题。特别令人感兴趣的是支持高吞吐量<a class="ae ky" href="https://en.wikipedia.org/wiki/Smart_contract" rel="noopener ugc nofollow" target="_blank">智能契约</a>的区块链，它支持可扩展的<a class="ae ky" href="https://blog.chain.link/44-ways-to-enhance-your-smart-contract-with-chainlink/" rel="noopener ugc nofollow" target="_blank">分散式应用</a> (dApps)的开发和部署。</span></p><p id="00de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样的区块链平台之一是<a class="ae ky" href="https://tron.network/" rel="noopener ugc nofollow" target="_blank"> TRON </a>。它在游戏和金融相关应用的开发者中特别受欢迎。在这里，我将使用从TRON收集的事务数据来说明它们可以揭示的一些模式。本文是面向希望了解更多有关区块链数据及其分析方法的数据科学家的技术教程。所有的例子都是用R实现的。我们假设读者对区块链技术有很高的理解，并且熟悉R及其<code class="fe me mf mg mh b"><a class="ae ky" href="https://www.tidyverse.org/" rel="noopener ugc nofollow" target="_blank">tidyverse</a></code>工具。这篇文章的代码可以在<a class="ae ky" href="https://github.com/next-game-solutions/day-on-tron" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。为了节省空间，我省略了用于生成大多数图表的代码。</p><p id="f730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mi">免责声明</em> </strong> <em class="mi">:本文任何部分均不构成理财建议。使用或依赖此处提供的材料完全由您自行承担风险和判断。我既不附属于也不支持此处提到的任何公司。提及这些公司及其产品仅用于说明目的。</em></p><h1 id="c2ac" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">本研究中使用的数据</h1><p id="d9d4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">与其他现象一样，人们可以在不同的时间尺度上研究区块链交易。涵盖更长时期的粒度数据往往描绘出一幅更加微妙的画面。然而，收集大量链上数据会产生巨大的技术开销(查询时间、存储和计算资源等)。).为简单起见，我们将使用覆盖一天数据的数据集，即2021年7月2日。没有理由选择这个特定的日期，这只是一个例子。</p><p id="dbbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据已通过函数<code class="fe me mf mg mh b"><a class="ae ky" href="https://levelup.gitconnected.com/how-to-query-blocks-on-the-tron-blockchain-2ee3c46156ec" rel="noopener ugc nofollow" target="_blank">get_block_info()</a></code>从R包<code class="fe me mf mg mh b"><a class="ae ky" href="https://levelup.gitconnected.com/introducing-tronr-an-r-package-to-explore-the-tron-blockchain-f0413f38b753" rel="noopener ugc nofollow" target="_blank">tronr</a></code>中收集。该函数获取感兴趣的块的编号，并以嵌套tible的形式返回数据。2021年7月2日在TRON区块链上产生了28，730个区块，其数量从31，570，498到31，599，227不等。这些区块共包含7，819，547项交易。交易ID ( <code class="fe me mf mg mh b">tx_id</code>)、执行给定交易的系统智能合约调用的类型(<code class="fe me mf mg mh b">contract_type</code>)以及该交易的发起者(<code class="fe me mf mg mh b">from_address</code>)和接收者(<code class="fe me mf mg mh b">to_address</code>)的账户地址存储在由<code class="fe me mf mg mh b">get_block_info()</code>返回的tibble的列表列<code class="fe me mf mg mh b">tx</code>中。该数据集中第一个数据块的数据如下所示:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="b778" class="nk mk it mh b gy nl nm l nn no">require(dplyr)<br/>require(tidyr)<br/>require(tronr)<br/>#&gt; R toolbox to explore the TRON blockchain<br/>#&gt; Developed by Next Game Solutions (http://nextgamesolutions.com)</span><span id="ae09" class="nk mk it mh b gy np nm l nn no">block_data &lt;- get_block_info(<br/>    <!-- -->latest = FALSE, block_number = "<!-- -->31570498<!-- -->"<br/>)</span><span id="4718" class="nk mk it mh b gy np nm l nn no">glimpse(<!-- -->block_data<!-- -->)<br/>#&gt; Rows: 1<br/>#&gt; Columns: 11<br/>#&gt; $ request_time    &lt;dttm&gt; 2021-07-26 20:25:24<br/>#&gt; $ block_number    &lt;chr&gt; "31570498"<br/>#&gt; $ timestamp       &lt;dttm&gt; 2021-07-02<br/>#&gt; $ hash            &lt;chr&gt; "0000000001e1ba4267746fce622a90ba6a51f~<br/>#&gt; $ parent_hash     &lt;chr&gt; "0000000001e1ba4135f66566c15b648563d4b6~<br/>#&gt; $ tx_trie_root    &lt;chr&gt; "254pKSrGpmLT3y7xdFAaZfXR93ZrsKgRJoxZH~<br/>#&gt; $ confirmed       &lt;lgl&gt; TRUE<br/>#&gt; $ size            &lt;int&gt; 61119<br/>#&gt; $ witness_address &lt;chr&gt; "TLyqzVGLV1srkB7dToTAEqgDSfPtXRJZYH"<br/>#&gt; $ tx_count        &lt;int&gt; 200<br/>#&gt; $ tx              &lt;list&gt; [&lt;tbl_df[200 x 4]&gt;]</span><span id="3c2d" class="nk mk it mh b gy np nm l nn no">block_data %&gt;% select(tx) %&gt;% unnest(cols = tx)<br/>#&gt; # A tibble: 200 x 4<br/>#&gt;    tx_id           contract_type   from_address    to_address    <br/>#&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;         <br/>#&gt;  1 59ebe232ea5032~ VoteWitnessCon~ TXi4QTAWYGhF4Z~ TTcYhypP8m4ph~<br/>#&gt;  2 aff3e7fb7f277b~ TransferContra~ TRYavwpJnwhr9T~ TQMVcC2adh61t~<br/>#&gt;  3 8661b623b377a2~ TriggerSmartCo~ TRpzBAQHCVKHBW~ TBRs8xwajQVbD~<br/>#&gt;  4 ed437306b65880~ TransferAssetC~ TXAVuHVM1pBnZA~ TYBtHbJiQ2bDa~<br/>#&gt;  5 5a94ce1c7b0390~ TransferAssetC~ TAdqErGeD2CgTp~ TSnjNCyK3r58w~<br/>#&gt;  6 360999180f84eb~ TransferAssetC~ TAFpxz9pKyGDwr~ TPRiphADhwe1g~<br/>#&gt;  7 42a97206891117~ TransferAssetC~ TJABpJLWNXJ2xj~ TX8BumaUQ1bpR~<br/>#&gt;  8 baa45f5a4a18aa~ AccountCreateC~ TEoDHGSTu2Kh97~ TFLnMpKhGBUUo~<br/>#&gt;  9 614032934ce86c~ TransferContra~ TSWHGYtBwzpFXL~ TBy4dMk6nWhWV~<br/>#&gt; 10 01de787975ff49~ TransferContra~ TVU2khdDkUu67F~ TSEnu5xcNMyNi~<br/>#&gt; # ... with 190 more rows</span></pre><p id="6360" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">整个数据集可以下载到R中，如下所示(这个<a class="ae ky" href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/readRDS" rel="noopener ugc nofollow" target="_blank"> RDS文件</a>的大小超过600 Mb，所以请耐心等待——这可能需要一些时间，取决于您的互联网连接的带宽):</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="9bab" class="nk mk it mh b gy nl nm l nn no">dat &lt;- readRDS(url("https://chilp.it/eee138c"))</span><span id="9614" class="nk mk it mh b gy np nm l nn no">dat %&gt;% dim()<br/>#&gt; [1] 28730    11</span><span id="7655" class="nk mk it mh b gy np nm l nn no">names(dat)<br/>#&gt;  [1] "request_time"    "block_number"    "timestamp"      <br/>#&gt;  [4] "hash"            "parent_hash"     "tx_trie_root"   <br/>#&gt;  [7] "confirmed"       "size"            "witness_address"<br/>#&gt; [10] "tx_count"        "tx"</span></pre><h1 id="84d4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">每3秒钟就有一个新的区块</h1><p id="3cd6" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">块类似于分类账中的页面，这些逻辑单元用于分组和记录区块链在一定时期内发生的交易。多亏了<a class="ae ky" href="https://academy.binance.com/en/articles/delegated-proof-of-stake-explained" rel="noopener ugc nofollow" target="_blank">授权利害关系证明</a>共识机制，创区块链上的区块生成速度非常快——每3秒钟一次。然而，每6小时有4个<a class="ae ky" href="https://tronprotocol.github.io/documentation-en/introduction/dpos/" rel="noopener ugc nofollow" target="_blank">维护周期</a>，每个周期耗时6秒。因此，在我们的示例中，块之间的平均时间刚刚超过3秒:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="7cb7" class="nk mk it mh b gy nl nm l nn no">dat$timestamp %&gt;% diff() %&gt;% mean()<br/>#&gt; Time difference of 3.00731 secs</span></pre><p id="9fe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在TRON中，有27个“<a class="ae ky" href="https://tronprotocol.github.io/documentation-en/introduction/dpos/#definition" rel="noopener ugc nofollow" target="_blank">见证人</a>”，也称为“超级代表”(SR)，即可以创建和确认新块的网络节点:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="7359" class="nk mk it mh b gy nl nm l nn no">dat$witness_address %&gt;% unique() %&gt;% length()<br/>#&gt; [1] 27</span><span id="5002" class="nk mk it mh b gy np nm l nn no">dat$witness_address %&gt;% unique() %&gt;% head()<br/>#&gt; [1] "TLyqzVGLV1srkB7dToTAEqgDSfPtXRJZYH"<br/>#&gt; [2] "TJBtdYunmQkeK5KninwgcjuK1RPDhyUWBZ"<br/>#&gt; [3] "TTjacDH5PL8hpWirqU7HQQNZDyF723PuCg"<br/>#&gt; [4] "TWkpg1ZQ4fTv7sj41zBUTMo1kuJEUWTere"<br/>#&gt; [5] "TCEo1hMAdaJrQmvnGTCcGT2LqrGU4N7Jqf"<br/>#&gt; [6] "TAAdjpNYfeJ2edcETNpad1QpQWJfyBdB9V"</span></pre><p id="b88a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在大多数情况下，可以在<a class="ae ky" href="https://tronscan.org/" rel="noopener ugc nofollow" target="_blank"> TRONScan网站</a>上找到证人身份或其假名。例如，上面列出的六个地址属于以下实体:</p><ul class=""><li id="3d5b" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated"><code class="fe me mf mg mh b">TLyqzVGLV1srkB7dToTAEqgDSfPtXRJZYH</code>:币安跑马圈地</li><li id="73f4" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><code class="fe me mf mg mh b">TJBtdYunmQkeK5KninwgcjuK1RPDhyUWBZ</code>:京东投资</li><li id="580c" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><code class="fe me mf mg mh b">TTjacDH5PL8hpWirqU7HQQNZDyF723PuCg</code>:新赌注</li><li id="055e" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><code class="fe me mf mg mh b">TWkpg1ZQ4fTv7sj41zBUTMo1kuJEUWTere</code> : TRONLink</li><li id="5f8e" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><code class="fe me mf mg mh b">TCEo1hMAdaJrQmvnGTCcGT2LqrGU4N7Jqf</code>:特龙斯坎</li><li id="53af" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><code class="fe me mf mg mh b">TAAdjpNYfeJ2edcETNpad1QpQWJfyBdB9V</code>:蚂蚁投资集团</li></ul><p id="97a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">证人每天生成的区块总数变化不大，从1050到1067，平均为1064:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="197e" class="nk mk it mh b gy nl nm l nn no">dat$witness_address %&gt;% table() %&gt;% range()<br/>#&gt; [1] 1050 1067</span><span id="1503" class="nk mk it mh b gy np nm l nn no">dat$witness_address %&gt;% table() %&gt;% mean()<br/>#&gt; [1] 1064.074</span></pre><h1 id="9d23" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">每个区块平均包含274个交易</h1><p id="63e8" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">每个块的事务数量有一个稍微不对称的分布，有一个长的右尾巴(图1)。平均而言，每个块包含274个事务。然而，一些区块有多达1126笔交易，而另一些则根本没有记录:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="c17c" class="nk mk it mh b gy nl nm l nn no">dat$tx_count %&gt;% summary()<br/>#&gt; Min. 1st Qu.  Median    Mean 3rd Qu.    Max. <br/>#&gt;  0.0   229.0   274.0   272.2   316.0  1126.0</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/7199949effd510937d387e5e4a794b95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzLa5Jg2CHZuqwLe1U5TjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图一。2021年7月2日TRON区块链上每个区块的交易数分布。</p></figure><p id="dbd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然很少，“空”块对于创区块链来说是完全正常的。当事务太少而无法打包到一个块中时，会生成这些事件。</p><h1 id="32ea" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">资产转移和智能合同触发是最普遍的交易类型</h1><p id="b201" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在创区块链上可以进行30多种交易。这些类型通过各自的“<a class="ae ky" href="https://tronprotocol.github.io/documentation-en/mechanism-algorithm/system-contracts/" rel="noopener ugc nofollow" target="_blank">系统智能合同</a>实现。在我们的数据集中，ca。所有交易的65%与各种代币(<code class="fe me mf mg mh b">"TransferAssetContract"</code>)和ca的转移相关。13% —用特龙(<code class="fe me mf mg mh b">TransferContract</code>)的本币<a class="ae ky" href="https://tron.network/trx?lng=en" rel="noopener ugc nofollow" target="_blank">特龙尼斯</a> (TRX)转账。超过19%的交易涉及触发其他智能合同(<code class="fe me mf mg mh b">TriggerSmartContract</code>)，例如那些在分散应用中实现逻辑的合同。其他类型的交易(例如，创建新账户、代币等。)的频率要低得多:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="df6f" class="nk mk it mh b gy nl nm l nn no">dat %&gt;%<br/>  select(tx) %&gt;%<br/>  unnest(cols = c(tx)) %&gt;%<br/>  group_by(contract_type) %&gt;%<br/>  summarise(n = n()) %&gt;%<br/>  mutate(percent = round(n / sum(n) * 100, 3)) %&gt;%<br/>  arrange(-n)</span><span id="4777" class="nk mk it mh b gy np nm l nn no">#&gt; # A tibble: 13 x 3<br/>#&gt;    contract_type                         n percent<br/>#&gt;    &lt;chr&gt;                             &lt;int&gt;   &lt;dbl&gt;<br/>#&gt;  1 TransferAssetContract           5071888  64.9  <br/>#&gt;  2 TriggerSmartContract            1508562  19.3  <br/>#&gt;  3 TransferContract                1041006  13.3  <br/>#&gt;  4 AccountCreateContract            166234   2.13 <br/>#&gt;  5 FreezeBalanceContract             10321   0.132<br/>#&gt;  6 VoteWitnessContract                8643   0.111<br/>#&gt;  7 WithdrawBalanceContract            6857   0.088<br/>#&gt;  8 UnfreezeBalanceContract            5119   0.065<br/>#&gt;  9 CreateSmartContract                 829   0.011<br/>#&gt; 10 AccountPermissionUpdateContract      77   0.001<br/>#&gt; 11 AccountUpdateContract                 8   0    <br/>#&gt; 12 AssetIssueContract                    2   0    <br/>#&gt; 13 ParticipateAssetIssueContract         1   0</span></pre><h1 id="3323" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">每个块的事务越多，块就越大</h1><p id="a9c6" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">假设数据块用于“捆绑”一组连续的事务，那么自然会期望数据块大小(以Mb为单位)与此类事务的数量正相关。图2证实了这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/98b158419c72427115524a93cb0c10f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YGC7-NLu0xr4X-wXqc3iGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图二。每个块的事务数量和块大小之间的关系。</p></figure><p id="5c9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这种关系的强度并不一致。当数据低于每块90笔交易时，关系是线性的，非常紧密。之后，相关性仍然是强的和正的，但是块大小方差增加了。此外，在ca上方的图上出现了两组独立的点。每个块450个事务。总体而言，图2显示，2021年7月2日，区块链在几个不同的制度下运作。</p><h1 id="c15c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">区块链上的活动全天变化很大</h1><p id="61ee" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">每个区块的交易数量表现出适度的每日季节性，即从午夜到大约。09:00 ( <a class="ae ky" href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" rel="noopener ugc nofollow" target="_blank"> UTC时区</a>，这里和其他地方)，然后再次类似地缓慢下降。然而，全天有许多局部波峰和波谷(图3)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/c003171afb230962206a4f18332f45bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RD10m-rMq3L3e3kZx_h-yA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3。每个块中事务数量的时间变化。在本文的这里和其他地方，红线是一个基于<a class="ae ky" href="https://en.wikipedia.org/wiki/Generalized_additive_model" rel="noopener ugc nofollow" target="_blank"> GAM </a>的平滑器，用来突出趋势。</p></figure><p id="767c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些峰值持续了连续几个街区，反映了区块链活动中的短期<a class="ae ky" href="https://en.wikipedia.org/wiki/Regime_shift#:~:text=Regime%20shifts%20are%20large%2C%20abrupt,systems%20or%20other%20complex%20systems.&amp;text=When%20regime%20shifts%20are%20associated,referred%20to%20as%20critical%20transitions." rel="noopener ugc nofollow" target="_blank">政权转移</a>。让我们更仔细地看看这种转变中最显著的，发生在公元。03:00和03:06。在此期间，每个块的事务数量在平均水平和方差方面都有所增加(图4)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/96b8c66193b00cd95002f6a2025beb36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YILOybW0V3OK_oj6LINPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4。区块链上的活动在03:00到03:06之间发生了变化。为了比较，显示了轮班前后的五分钟间隔。</p></figure><p id="fb76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如下图所示，这种明显的政权转移是由一个特定的地址(<code class="fe me mf mg mh b">THtbMw6byXuiFhsRv1o1BQRtzvube9X1jx</code>，一个<a class="ae ky" href="https://tronscan.org/#/address/THtbMw6byXuiFhsRv1o1BQRtzvube9X1jx" rel="noopener ugc nofollow" target="_blank"> TRON账户</a>，其身份不明)开始向另一个地址(<code class="fe me mf mg mh b">TSQyuZowokRp3TMRCcrbsDnhnnDSg7gtMT</code>，一个<a class="ae ky" href="https://tronscan.org/#/contract/TSQyuZowokRp3TMRCcrbsDnhnnDSg7gtMT" rel="noopener ugc nofollow" target="_blank">智能合同</a>与一个大型赌博网站相关联)发起大量交易引起的。为了简化符号，我将第一个实体称为“地址<em class="mi"> A </em>”，第二个实体称为“地址<em class="mi"> B </em>”。</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="d8fe" class="nk mk it mh b gy nl nm l nn no"># Addresses that interacted between 03:00 and 03:06,<br/># ordered by the number of transactions:</span><span id="59dd" class="nk mk it mh b gy np nm l nn no">dat %&gt;%<br/>  filter(<br/>    timestamp &gt;= as.POSIXct("2021-07-02 03:00:00", tz = "UTC"),<br/>    timestamp &lt; as.POSIXct("2021-07-02 03:06:00", tz = "UTC")<br/>  ) %&gt;%<br/>  select(tx) %&gt;%<br/>  unnest(cols = tx) %&gt;%<br/>  group_by(from_address, to_address) %&gt;%<br/>  count() %&gt;% arrange(-n) %&gt;% head()</span><span id="a4ed" class="nk mk it mh b gy np nm l nn no">#&gt; # A tibble: 6 x 3<br/>#&gt; # Groups:   from_address, to_address [6]<br/>#&gt;   from_address                 to_address                      n<br/>#&gt;   &lt;chr&gt;                        &lt;chr&gt;                       &lt;int&gt;<br/>#&gt; 1 THtbMw6byXuiFhsRv1o1BQRtzvu~ TSQyuZowokRp3TMRCcrbsDnhnn~ 26897<br/>#&gt; 2 TCd4rituYSmbeEDxXpDVF7ordH3~ TFJDc5RmS5HuLRujYSFwHadHQb~  1198<br/>#&gt; 3 TCd4rituYSmbeEDxXpDVF7ordH3~ TSvin3om2vWuw5stbxTeDQrpqH~   647<br/>#&gt; 4 TCd4rituYSmbeEDxXpDVF7ordH3~ TTagN2hiUpt7HBbLTgLWi8qQoS~   374<br/>#&gt; 5 TAUN6FwrnwwmaEqYcckffC7wYmb~ TR7NHqjeKQxGTCi8q8ZY4pL8ot~   184<br/>#&gt; 6 TH4RjfiSXxz71fNP3U3p6XwKYZ8~ TVj7RNVHy6thbM7BWdSe9G6gXw~   149</span></pre><p id="bae1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在03:06之后不久，每个块的事务数量再次变得不那么不稳定，尽管其平均水平仍然有所提高(图4)。相互作用的地址对<em class="mi"> A </em> — <em class="mi"> B </em>仍然是最活跃的一个，尽管这些地址之间的事务数量大幅下降:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="63b2" class="nk mk it mh b gy nl nm l nn no"># Addresses that interacted between 03:06 and 03:11,<br/># ordered by the number of transactions:</span><span id="d084" class="nk mk it mh b gy np nm l nn no">dat %&gt;%<br/>  filter(<br/>    timestamp &gt;= as.POSIXct("2021-07-02 03:06:00", tz = "UTC"),<br/>    timestamp &lt;= as.POSIXct("2021-07-02 03:11:00", tz = "UTC")<br/>  ) %&gt;%<br/>  select(tx) %&gt;%<br/>  unnest(cols = tx) %&gt;%<br/>  group_by(from_address, to_address) %&gt;%<br/>  count() %&gt;% arrange(-n) %&gt;% head()</span><span id="fd49" class="nk mk it mh b gy np nm l nn no">#&gt; # A tibble: 6 x 3<br/>#&gt; # Groups:   from_address, to_address [6]<br/>#&gt;   from_address                 to_address                      n<br/>#&gt;   &lt;chr&gt;                        &lt;chr&gt;                       &lt;int&gt;<br/>#&gt; 1 THtbMw6byXuiFhsRv1o1BQRtzvu~ TSQyuZowokRp3TMRCcrbsDnhnn~  6713<br/>#&gt; 2 TCd4rituYSmbeEDxXpDVF7ordH3~ TFJDc5RmS5HuLRujYSFwHadHQb~  2223<br/>#&gt; 3 TCd4rituYSmbeEDxXpDVF7ordH3~ TSvin3om2vWuw5stbxTeDQrpqH~   396<br/>#&gt; 4 TCd4rituYSmbeEDxXpDVF7ordH3~ TTagN2hiUpt7HBbLTgLWi8qQoS~   367<br/>#&gt; 5 TH4RjfiSXxz71fNP3U3p6XwKYZ8~ TVj7RNVHy6thbM7BWdSe9G6gXw~   199<br/>#&gt; 6 TAUN6FwrnwwmaEqYcckffC7wYmb~ TR7NHqjeKQxGTCi8q8ZY4pL8ot~   171</span></pre><p id="e3c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为比较，在政权转移前几分钟，前6个相互作用的地址对列表如下:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="bdf4" class="nk mk it mh b gy nl nm l nn no"># Addresses that interacted between 02:55 and 03:00,<br/># ordered by the number of transactions:</span><span id="509c" class="nk mk it mh b gy np nm l nn no">dat %&gt;%<br/>  filter(<br/>    timestamp &gt;= as.POSIXct("2021-07-02 02:55:00", tz = "UTC"),<br/>    timestamp &lt; as.POSIXct("2021-07-02 03:00:00", tz = "UTC")<br/>  ) %&gt;%<br/>  select(tx) %&gt;%<br/>  unnest(cols = tx) %&gt;%<br/>  group_by(from_address, to_address) %&gt;%<br/>  count() %&gt;% arrange(-n) %&gt;% head()</span><span id="1f9d" class="nk mk it mh b gy np nm l nn no">#&gt; # A tibble: 6 x 3<br/>#&gt; # Groups:   from_address, to_address [6]<br/>#&gt;   from_address                 to_address                      n<br/>#&gt;   &lt;chr&gt;                        &lt;chr&gt;                       &lt;int&gt;<br/>#&gt; 1 TCd4rituYSmbeEDxXpDVF7ordH3~ TSvin3om2vWuw5stbxTeDQrpqH~   517<br/>#&gt; 2 TCd4rituYSmbeEDxXpDVF7ordH3~ TTagN2hiUpt7HBbLTgLWi8qQoS~   253<br/>#&gt; 3 TH4RjfiSXxz71fNP3U3p6XwKYZ8~ TVj7RNVHy6thbM7BWdSe9G6gXw~   200<br/>#&gt; 4 TAUN6FwrnwwmaEqYcckffC7wYmb~ TR7NHqjeKQxGTCi8q8ZY4pL8ot~   176<br/>#&gt; 5 TNMQ6BJyycCSMuVmVWH2Re4FySm~ TAQuJmiy83mcnyAtB6wMST6bSY~   136<br/>#&gt; 6 TNaRAoLUyYEV2uF7GUrzSjRQTU8~ TR7NHqjeKQxGTCi8q8ZY4pL8ot~   114</span></pre><p id="88f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">政权更迭期间，地址<em class="mi"> A </em>向地址<em class="mi"> B </em>发送了哪些交易？为了回答这个问题，我们使用<code class="fe me mf mg mh b">tronr</code>包中的<code class="fe me mf mg mh b"><a class="ae ky" href="https://levelup.gitconnected.com/how-to-query-transactions-on-the-tron-blockchain-7e646ee546fd" rel="noopener ugc nofollow" target="_blank">get_tx_info_by_id()</a></code>函数收集了一个更详细的数据集(详见<a class="ae ky" href="https://github.com/next-game-solutions/day-on-tron" rel="noopener ugc nofollow" target="_blank"> Github </a>)。该数据集可以如下加载到R中:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="d33c" class="nk mk it mh b gy nl nm l nn no">shift_tx &lt;- readRDS(url("https://chilp.it/969333f"))</span><span id="b155" class="nk mk it mh b gy np nm l nn no">shift_tx %&gt;% dim()<br/>#&gt; [1] 26897    19</span><span id="3bfe" class="nk mk it mh b gy np nm l nn no">names(shift_tx)<br/>#&gt;  [1] "request_time"             "tx_id"                   <br/>#&gt;  [3] "block_number"             "timestamp"               <br/>#&gt;  [5] "contract_result"          "confirmed"               <br/>#&gt;  [7] "confirmations_count"      "sr_confirm_list"         <br/>#&gt;  [9] "contract_type"            "from_address"            <br/>#&gt; [11] "to_address"               "is_contract_from_address"<br/>#&gt; [13] "is_contract_to_address"   "costs"                   <br/>#&gt; [15] "trx_transfer"             "trc10_transfer"          <br/>#&gt; [17] "trc20_transfer"           "internal_tx"             <br/>#&gt; [19] "info"</span></pre><p id="5d43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于地址<em class="mi"> B </em>属于智能合约，因此毫不奇怪，在政权转移期间，它从地址<em class="mi"> A </em>接收的所有26，897笔交易都属于类型<code class="fe me mf mg mh b">"TriggerSmartContract"</code>:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="90f9" class="nk mk it mh b gy nl nm l nn no">shift_tx$contract_type %&gt;% unique()<br/>#&gt; [1] "TriggerSmartContract"</span></pre><p id="4324" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些交易都没有直接涉及任何资产的转让，无论是TRX、<a class="ae ky" href="https://developers.tron.network/docs/trc10" rel="noopener ugc nofollow" target="_blank"> TRC-10 </a>还是<a class="ae ky" href="https://developers.tron.network/docs/trc20" rel="noopener ugc nofollow" target="_blank"> TRC-20 </a>代币:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="83a8" class="nk mk it mh b gy nl nm l nn no">shift_tx$trx_transfer %&gt;% sum()<br/>[1] 0<br/><br/>shift_tx$trc10_transfer %&gt;% sum(na.rm = TRUE)<br/>[1] 0</span><span id="92cf" class="nk mk it mh b gy np nm l nn no">shift_tx$trc20_transfer %&gt;% sum(na.rm = TRUE)<br/>[1] 0</span></pre><p id="e30d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，TRON区块链上的智能合约调用通常会触发所谓的“<a class="ae ky" href="https://developers.tron.network/docs/vm-introduction" rel="noopener ugc nofollow" target="_blank">内部事务</a>”，这些事务在“幕后”实施各种操作，包括资产转移。关于这些交易的信息可以在<code class="fe me mf mg mh b">shift_tx</code>表格的列表栏<code class="fe me mf mg mh b">internal_tx</code>中找到。例如，以下是与03:03发生的“正常”交易之一相关的内部交易数据:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="a41b" class="nk mk it mh b gy nl nm l nn no">shift_tx$internal_tx[[1]] %&gt;% glimpse()</span><span id="93fe" class="nk mk it mh b gy np nm l nn no">#&gt; Rows: 9<br/>#&gt; Columns: 12<br/>#&gt; $ internal_tx_id           &lt;chr&gt; "3c4c8d286b643d1a7e0b23e2dd~<br/>#&gt; $ from_address             &lt;chr&gt; "TBPrJYARpfAe9kmnHvMAWcqimn~<br/>#&gt; $ to_address               &lt;chr&gt; "TCcrsGF9PdLxJF869dQsK4V5QE~<br/>#&gt; $ is_contract_from_address &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRU~<br/>#&gt; $ is_contract_to_address   &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRU~<br/>#&gt; $ confirmed                &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRU~<br/>#&gt; $ rejected                 &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE,~<br/>#&gt; $ token_id                 &lt;chr&gt; "TRX", "TRX", "TRX", "TRX",~<br/>#&gt; $ token_name               &lt;chr&gt; "Tronix", "Tronix", "Tronix~<br/>#&gt; $ token_abbr               &lt;chr&gt; "TRX", "TRX", "TRX", "TRX",~<br/>#&gt; $ vip                      &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE,~<br/>#&gt; $ amount                   &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.~</span></pre><p id="17c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">汇总所有内部事务，我们可以看到，实际上总共有185，113个TRX(相当于大约由于在政权转移期间从<em class="mi"> A </em>到<em class="mi"> B </em>的智能合约调用，当日12，032美元)易手；</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="f390" class="nk mk it mh b gy nl nm l nn no">shift_tx %&gt;% <br/>  select(internal_tx) %&gt;%<br/>  unnest(internal_tx) %&gt;% <br/>  filter(amount &gt; 0) %&gt;% <br/>  group_by(token_id) %&gt;% <br/>  summarise(total_amount = sum(amount))</span><span id="37e3" class="nk mk it mh b gy np nm l nn no">#&gt; # A tibble: 1 x 2<br/>#&gt;   token_id total_amount<br/>#&gt;   &lt;chr&gt;           &lt;dbl&gt;<br/>#&gt; 1 TRX           185113.</span></pre><p id="5e5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种内部交易分析的下一个合乎逻辑的步骤将涉及更好地理解不同账户之间的TRX流动，确定这些账户所属的实体等。我将把这作为一个练习留给读者。</p><h1 id="a9d3" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">相互作用的区块链地址形成一个网络</h1><p id="392b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">通常将区块链交易数据表示为网络(图)，其中地址作为节点，交易作为连接节点的边(参见示例<a class="ae ky" href="https://medium.com/elliptic/the-elliptic-data-set-opening-up-machine-learning-on-the-blockchain-e0a343d99a14" rel="noopener">这里</a>和<a class="ae ky" href="https://appliednetsci.springeropen.com/articles/10.1007/s41109-019-0249-6" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="b472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们看一下在研究的当天产生的第10个块的交易:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="710b" class="nk mk it mh b gy nl nm l nn no">dat$tx[[10]]<br/>#&gt; # A tibble: 278 x 4<br/>#&gt;    tx_id           contract_type   from_address    to_address   <br/>#&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;        <br/>#&gt;  1 85e2dc35e095d5~ TransferContra~ THXPAPiRd62EWk~ TV8oyJ4VEQgE~<br/>#&gt;  2 0733b9aea36aa5~ TransferAssetC~ TCjeJWKkiEgih2~ TA9uJrWuTueK~<br/>#&gt;  3 0c841ce6d571da~ TransferAssetC~ TP8BWU6dYD1fHc~ TSpnfuhALfLJ~<br/>#&gt;  4 51802e2f59cb7b~ TransferAssetC~ TAdTQUqsumn1NG~ TX6HKSS5VnUr~<br/>#&gt;  5 9e3b34b7f99a8f~ TransferContra~ TWq5u64ic279j8~ TM9H9cS6wZox~<br/>#&gt;  6 0820513585ac7b~ TriggerSmartCo~ TJZziktTWeCXgR~ TBRs8xwajQVb~<br/>#&gt;  7 5cc4dd58b3c25c~ TransferAssetC~ TLmqHdqkD5shgj~ TUrCM9mV41FN~<br/>#&gt;  8 a526124805cb6e~ TransferAssetC~ TEpyCakhKtwvtY~ TGmgoGskK3pX~<br/>#&gt;  9 4449d115da5c13~ TransferAssetC~ TWoJEZhqpJxzu7~ TNLAoWMw6WTk~<br/>#&gt; 10 03df1b68f2d7fa~ TransferAssetC~ TJFhAVZjBaCMvt~ TQ8M5KzRJRZi~<br/>#&gt; # ... with 268 more rows</span></pre><p id="0839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将通过(I)找到所有唯一的发送(<code class="fe me mf mg mh b">from_address</code>)和接收(<code class="fe me mf mg mh b">to_address</code>)地址对，以及(ii)计算每对的交易数量(边权重)来总结上述数据:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="fc73" class="nk mk it mh b gy nl nm l nn no">nb &lt;- dat$tx[[10]] %&gt;%<br/>  group_by(from_address, to_address) %&gt;%<br/>  summarise(weight = n()) %&gt;% <br/>  ungroup() %&gt;%<br/>  arrange(-weight)</span><span id="e5bb" class="nk mk it mh b gy np nm l nn no">nb<br/>#&gt; # A tibble: 238 x 3<br/>#&gt;    from_address                to_address                 weight<br/>#&gt;    &lt;chr&gt;                       &lt;chr&gt;                       &lt;int&gt;<br/>#&gt;  1 TCd4rituYSmbeEDxXpDVF7ordH~ TSvin3om2vWuw5stbxTeDQrpq~     33<br/>#&gt;  2 TEoDHGSTu2Kh97HjCbbcEUaCTm~ TCcjjJ4v7zu6W4F1wwBhuc7EB~      2<br/>#&gt;  3 TJP3A9agR5CP31UE29mhFXK1wk~ TCXeYmM1g44qtRVEHbf9ehwgB~      2<br/>#&gt;  4 TNXscxfqxNtpaeUZKoEUkvEY5e~ TGsyWcVkFBxTknYzXGWvrZPaX~      2<br/>#&gt;  5 TP7NeoT2sM1hkpTuqNrvHorrRz~ TNmiCAm7Q38jKvWsrSRReREuy~      2<br/>#&gt;  6 TPaGwxVw7q26DCxRSGG9b2BNRB~ TTmdBHmoPqXE7EC22QtzPi2Ag~      2<br/>#&gt;  7 TTAct3jgaabAhxSvoZW9SAGVu4~ TWMiYQvrXuyQw5pk6Yt2L6oQF~      2<br/>#&gt;  8 TTfGseRet2nHfvi5KhPx9vCf6Q~ TA7oywPknyAewrq9bss7AzGGs~      2<br/>#&gt;  9 TTfGseRet2nHfvi5KhPx9vCf6Q~ TYYoV3GVuwjHkCYKfYRYwLjBb~      2<br/>#&gt; 10 TA1EHWb1PymZ1qpBNfNj9uTaxd~ TDyoqH6N91PAYrihFzE1VER7H~      1<br/>#&gt; # ... with 228 more rows</span></pre><p id="939e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">产生的tibble现在可以被转换成类<code class="fe me mf mg mh b">"igraph"</code>的对象，正如在流行的包<code class="fe me mf mg mh b">igraph</code>中实现的:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="f839" class="nk mk it mh b gy nl nm l nn no">require(igraph) # popular R package for network analysis</span><span id="e531" class="nk mk it mh b gy np nm l nn no">nb_graph &lt;- nb %&gt;%<br/>  graph_from_data_frame(., directed = TRUE)</span><span id="1597" class="nk mk it mh b gy np nm l nn no">summary(nb_graph)<br/>#&gt; IGRAPH c55f992 DNW- 350 238 -- <br/>#&gt; + attr: name (v/c), weight (e/n)</span></pre><p id="7d81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">得到的对象是一个有350个节点和238条边的图。为了可视化这个图，我们可以使用<code class="fe me mf mg mh b"><a class="ae ky" href="https://cran.r-project.org/web/packages/ggnetwork/vignettes/ggnetwork.html" rel="noopener ugc nofollow" target="_blank">ggnetwork</a></code>，一个R包，它为<code class="fe me mf mg mh b">ggplot2</code>实现了几个方便的网络几何图形(另一个很棒的网络可视化R包是<code class="fe me mf mg mh b"><a class="ae ky" href="https://ggraph.data-imaginist.com/" rel="noopener ugc nofollow" target="_blank">ggraph</a></code>)。结果如图5所示:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="1b0d" class="nk mk it mh b gy nl nm l nn no">require(ggplot2)<br/>require(ggnetwork)</span><span id="96b1" class="nk mk it mh b gy np nm l nn no"># Figure 5:<br/>ggplot(fortify(nb_graph, arrow.gap = 0.007),<br/>       aes(x = x, y = y, xend = xend, yend = yend)) +<br/>  geom_edges(<br/>    color = "#57cbcc",<br/>    arrow = arrow(length = unit(3, "pt"), type = "closed")<br/>  ) +<br/>  geom_nodes(color = "#343a40") +<br/>  theme_blank()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/f8ec744f74638dcdd5a9db0c926df287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-WIIUQDm4oAFt9CHftwZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5。31570507块中记录的TRON地址(黑点)和交易(蓝绿色箭头)的网络。一些地址在一天内向同一个接收地址发出了几笔交易。然而，为了清楚起见，在该图中忽略了边缘权重。</p></figure><p id="3f2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图5揭示了区块链交易网络的典型模式:</p><ul class=""><li id="b8c1" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">网络主要由小的<em class="mi">断开元件</em>组成，每个元件有2-4个相互作用的地址；</li><li id="46b7" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">有几个<em class="mi">星形组件</em>，要么一个地址接收来自许多其他地址的事务，要么一个地址向许多其他地址发出事务。</li></ul><p id="c17b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">交易网络的结构属性可以使用各种度量标准进行定量表征，例如:</p><ul class=""><li id="e609" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated"><em class="mi">直径</em>:从一个节点到达另一个节点必须经过的最大节点数。</li><li id="8088" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><em class="mi">入度</em>和<em class="mi">出度</em>:分别是与一个节点相关的传入或传出事务的数量。表征整个有向网络时，感兴趣的通常是最小和最大的入度和出度。</li><li id="7076" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><em class="mi">平均度</em>:边数除以节点数。</li><li id="359b" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><em class="mi">边缘密度</em>:边缘数量与最大可能边缘数量之比。</li><li id="e8e8" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated"><em class="mi">相似性</em>:一种<a class="ae ky" href="https://en.wikipedia.org/wiki/Preferential_attachment" rel="noopener ugc nofollow" target="_blank">优先依附</a>的度量，即节点倾向于依附在其他在某些方面相似的节点上的现象。分类度通常被计算为成对链接节点之间的皮尔逊相关度系数。</li></ul><p id="2068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe me mf mg mh b">igraph</code>中的各个函数可以很容易地计算出所有这些指标。对于图5所示的网络，我们得到:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="6fd3" class="nk mk it mh b gy nl nm l nn no"># Diameter:<br/>diameter(nb_graph, directed = TRUE)<br/>#&gt; [1] 33</span><span id="e22d" class="nk mk it mh b gy np nm l nn no"># Max in-degree:<br/>degree(nb_graph, mode = "in", loops = FALSE) %&gt;% max()<br/>#&gt; [1] 32</span><span id="3c04" class="nk mk it mh b gy np nm l nn no"># Max out-degree:<br/>degree(nb_graph, mode = "out", loops = FALSE) %&gt;% max()<br/>#&gt; [1] 9</span><span id="3a00" class="nk mk it mh b gy np nm l nn no"># Average degree:<br/>gsize(nb_graph) / gorder(nb_graph)<br/>#&gt; [1] 0.68</span><span id="2085" class="nk mk it mh b gy np nm l nn no"># Edge density:<br/>edge_density(nb_graph, loops = FALSE)<br/>#&gt; [1] 0.001948424</span><span id="0632" class="nk mk it mh b gy np nm l nn no"># Assortativity:<br/>assortativity_degree(nb_graph)<br/>#&gt; [1] -0.228756</span></pre><p id="47df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，这些结果与我们之前通过观察图5发现的模式一致。</p><h1 id="5117" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">交易网络的结构全天变化很大</h1><p id="0b03" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">人们很自然地会认为，特定区块交易网络的结构是动态的，与区块链正在发生的事情保持一致。让我们为每个块计算前面提到的结构度量，看看它们是如何随时间变化的。</p><p id="47f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将每个块的事务列表转换成类<code class="fe me mf mg mh b">igraph</code>的图形对象，并将结果存储在嵌套的tibble中:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="51c4" class="nk mk it mh b gy nl nm l nn no">require(purrr)</span><span id="d632" class="nk mk it mh b gy np nm l nn no">nw_stats &lt;- dat %&gt;%<br/>  select(timestamp, tx) %&gt;%<br/>  group_by(timestamp) %&gt;%<br/>  unnest(tx) %&gt;%<br/>  select(-c(tx_id, contract_type)) %&gt;%<br/>  mutate(to_address = if_else(<br/>    is.na(to_address), from_address, to_address)<br/>  ) %&gt;%<br/>  group_by(timestamp, from_address, to_address) %&gt;%<br/>  summarise(weight = n()) %&gt;%<br/>  group_by(timestamp) %&gt;%<br/>  nest(nw = c(from_address, to_address, weight)) %&gt;%<br/>  mutate(nw = map(nw, graph_from_data_frame))</span><span id="3737" class="nk mk it mh b gy np nm l nn no"># The resultant tibble contains a list-column `nw`, where<br/># each element is an `igraph` object:<br/>nw_stats<br/>#&gt; # A tibble: 28,719 x 2<br/>#&gt; # Groups:   timestamp [28,708]<br/>#&gt;    timestamp           nw      <br/>#&gt;    &lt;dttm&gt;              &lt;list&gt;  <br/>#&gt;  1 2021-07-02 00:00:00 &lt;igraph&gt;<br/>#&gt;  2 2021-07-02 00:00:09 &lt;igraph&gt;<br/>#&gt;  3 2021-07-02 00:00:12 &lt;igraph&gt;<br/>#&gt;  4 2021-07-02 00:00:15 &lt;igraph&gt;<br/>#&gt;  5 2021-07-02 00:00:18 &lt;igraph&gt;<br/>#&gt;  6 2021-07-02 00:00:21 &lt;igraph&gt;<br/>#&gt;  7 2021-07-02 00:00:24 &lt;igraph&gt;<br/>#&gt;  8 2021-07-02 00:00:27 &lt;igraph&gt;<br/>#&gt;  9 2021-07-02 00:00:30 &lt;igraph&gt;<br/>#&gt; 10 2021-07-02 00:00:33 &lt;igraph&gt;<br/>#&gt; # ... with 28,698 more rows</span><span id="5023" class="nk mk it mh b gy np nm l nn no">summary(nw_stats$nw[[1]])<br/>#&gt; IGRAPH 7f07025 DNW- 270 189 -- <br/>#&gt; + attr: name (v/c), weight (e/n)</span></pre><p id="9ce0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们编写一个计算网络度量的实用函数，然后使用来自<code class="fe me mf mg mh b">purrr</code>的<code class="fe me mf mg mh b">map()</code>函数将它应用于存储在<code class="fe me mf mg mh b">nw_stats</code>中的每个<code class="fe me mf mg mh b">igraph</code>对象:</p><pre class="kj kk kl km gt ng mh nh ni aw nj bi"><span id="2724" class="nk mk it mh b gy nl nm l nn no"># Function to calculate network metrics:<br/>get_nw_stats &lt;- function(g) {<br/>  tibble(<br/>    n_nodes = gorder(g),<br/>    n_edges = gsize(g),<br/>    diameter = diameter(g, directed = TRUE),<br/>    max_in_degree = degree(g, mode = "in",<br/>                           loops = FALSE) %&gt;% max(),<br/>    max_out_degree = degree(g, mode = "out",<br/>                            loops = FALSE) %&gt;% max(),<br/>    avg_degree = n_edges / n_nodes,<br/>    edge_density = edge_density(g, loops = FALSE),<br/>    assortativity = assortativity_degree(g)<br/>  )<br/>}</span><span id="f0e6" class="nk mk it mh b gy np nm l nn no"># Calculate network metrics for each block:<br/>nw_stats &lt;- nw_stats %&gt;%<br/>  mutate(stats = map(nw, get_nw_stats))</span><span id="ec9a" class="nk mk it mh b gy np nm l nn no">glimpse(nw_stats$stats[[1]])<br/>#&gt; Rows: 1<br/>#&gt; Columns: 8<br/>#&gt; $ n_nodes        &lt;int&gt; 270<br/>#&gt; $ n_edges        &lt;dbl&gt; 189<br/>#&gt; $ diameter       &lt;dbl&gt; 3<br/>#&gt; $ max_in_degree  &lt;dbl&gt; 20<br/>#&gt; $ max_out_degree &lt;dbl&gt; 10<br/>#&gt; $ avg_degree     &lt;dbl&gt; 0.7<br/>#&gt; $ edge_density   &lt;dbl&gt; 0.00260223<br/>#&gt; $ assortativity  &lt;dbl&gt; -0.1411257</span><span id="b4a9" class="nk mk it mh b gy np nm l nn no"># Unnest `nw_stats` for easier plotting:<br/>nw_stats_flat &lt;- nw_stats %&gt;%<br/>  ungroup() %&gt;%<br/>  select(timestamp, stats) %&gt;%<br/>  unnest(cols = stats)</span><span id="5862" class="nk mk it mh b gy np nm l nn no">glimpse(nw_stats_flat)<br/>#&gt; Rows: 28,719<br/>#&gt; Columns: 9<br/>#&gt; $ timestamp      &lt;dttm&gt; 2021-07-02 00:00:00, 2021-07-02 0~<br/>#&gt; $ n_nodes        &lt;int&gt; 270, 409, 525, 555, 28, 680, 658, ~<br/>#&gt; $ n_edges        &lt;dbl&gt; 189, 293, 398, 436, 27, 535, 485, ~<br/>#&gt; $ diameter       &lt;dbl&gt; 3, 4, 8, 6, 1, 8, 3, 52, 46, 33, 3~<br/>#&gt; $ max_in_degree  &lt;dbl&gt; 20, 30, 78, 98, 27, 135, 63, 64, 2~<br/>#&gt; $ max_out_degree &lt;dbl&gt; 10, 10, 8, 9, 1, 12, 8, 10, 5, 9, ~<br/>#&gt; $ avg_degree     &lt;dbl&gt; 0.7000000, 0.7163814, 0.7580952, 0~<br/>#&gt; $ edge_density   &lt;dbl&gt; 0.002602230, 0.001755837, 0.001446~<br/>#&gt; $ assortativity  &lt;dbl&gt; -0.1411257, -0.2274452, -0.3283519~</span></pre><p id="cca7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图6显示了每个块的节点数(左图)和边数(右图)随时间的变化。不出所料，这两个指标的动态与每个块的事务数量相似(见图3)。此外，考虑到特定区块交易网络的高度不连接性，节点数量与边的数量密切相关(图6，底部面板)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/8b6dc86e72180f87a94bd3dc130608ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-zeQ7eAntC5TqC4QQ_BRPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6。每块事务网络中节点数量(左上图)和边数量(右上图)的时间变化。底部面板说明了这两个指标之间的相关性。</p></figure><p id="e325" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最大出度显示了与节点和边数相似的日内变化，而最大出度尽管有多个局部波峰和波谷，但平均而言几乎没有趋势(图7)。这一发现表明，交易网络的结构主要是由同时与给定接收地址交互的发送者数量驱动的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/5e575ae49ce2a6106fc9290b71df7f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JgUN2-d-3tPozeFOQ1HPOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7。每块交易网络的最大入度(左图)和最大出度(右图)的时间变化。注意Y轴的对数刻度。</p></figure><p id="e25a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">边密度有一个温和的U型趋势，因此与节点和边的数量负相关。尽管程度要小得多，但它也与最大入度负相关(图8)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/abd74189fce4df60b3726ec693d05963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPGlgW-gGpfPtqGGYPEuWQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8。<em class="of">上图</em>:每块交易网络的边密度的时间变化。下图:边密度分别与节点数、边数和最大入度之间的关系。</p></figure><p id="ef3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">全天平均网络度相对稳定，在0.7左右震荡(图9)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/b2147c6389dadfad02832ec8a18b2184.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*osSdYAq4aSfdtsGt3d64SQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9。每块交易网络平均度的时间变化。</p></figure><p id="1782" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每块交易网络的直径在一天中的大部分时间里显示出一致的高变化(从1到大约。80;图8)。然而，这一指标的方差急剧下降，其平均水平同时在ca。03:00和05:00，即在上文详细描述的区块链活动中的明显政权转移之后不久。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/8cc65fecf45447bf6a974dcdf79df375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XpyULccXevF90SlG3FLEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10。特定区块交易网络直径的时间变化。注意Y轴的对数刻度。</p></figure><p id="c686" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在大多数情况下，分类系数为中等负值(图11)，表明低度节点倾向于附着于高度节点。这一发现与在其他非常不连通的交易网络中存在的一些大型星形组件非常一致，这些组件通常可以在TRON区块链上观察到(例如，参见图5)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/449b923753f4ad5a17a6ec03fdb6249c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqnyAasNHTdQmxpE1iMobQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11。按块交易网络的分类性。</p></figure><p id="a11a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在一天中有多个峰值。这种峰值的频率在一天结束时会增加。图12比较了两个交易网络——一个最低(-0.53)，一个最高(0.79)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/221c152c114bb314026f26ca348f9196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1oxs8WE0oxEzUH1MwELrw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12。2021年7月2日在TRON区块链上记录的具有最低和最高分类系数的每块交易网络。</p></figure><h1 id="9c7c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="62c9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">本文展示了一些模式，这些模式可以从支持高吞吐量智能契约的区块链上生成的数据中提取出来。然而，它仅仅触及了表面。例如，其他值得探讨的有趣方面包括区块链实体的去匿名化、各类账户之间的资产转移、连锁活动与区块链托管的代币价格之间的联系等。我将在以后的文章中讨论这些和其他研究问题。</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><h1 id="e50f" class="mj mk it bd ml mm oo mo mp mq op ms mt jz oq ka mv kc or kd mx kf os kg mz na bi translated">您可能还喜欢:</h1><div class="ot ou gp gr ov ow"><a rel="noopener follow" target="_blank" href="/data-science-for-blockchain-understanding-the-current-landscape-c136154c367e"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">区块链的数据科学:了解当前形势</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">数据科学和区块链技术是天生的一对。但是有多少和什么样的真实世界…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk ks ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a href="https://levelup.gitconnected.com/introducing-tronr-an-r-package-to-explore-the-tron-blockchain-f0413f38b753" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">介绍tronr，一个探索TRON区块链的R包</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">查询账户余额、交易、代币转账等等。</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="pf l"><div class="pl l ph pi pj pf pk ks ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a href="https://medium.com/geekculture/market-data-for-8000-cryptocurrencies-at-your-fingertips-c76d7e8f43ca" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">8000种加密货币的市场数据，触手可及</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">介绍geckor，一个查询CoinGecko API的R包</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">medium.com</p></div></div><div class="pf l"><div class="pm l ph pi pj pf pk ks ow"/></div></div></a></div></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><h1 id="a217" class="mj mk it bd ml mm oo mo mp mq op ms mt jz oq ka mv kc or kd mx kf os kg mz na bi translated">在你走之前</h1><p id="b4e5" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我提供数据科学咨询服务。<a class="ae ky" href="mailto:sergey@nextgamesolutions.com" rel="noopener ugc nofollow" target="_blank">取得联系</a>！</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><p id="b24d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mi">来自《走向数据科学》编辑的提示:</em> </strong> <em class="mi">虽然我们允许独立作者根据我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="mi">规则和指导方针</em> </a> <em class="mi">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="mi">读者术语</em> </a> <em class="mi">。</em></p></div></div>    
</body>
</html>