<html>
<head>
<title>Deploy a Python Visualization Panel App to Google Cloud App Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Python 可视化面板应用程序部署到谷歌云应用程序引擎</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploy-a-python-visualization-panel-app-to-google-cloud-cafe558fe787?source=collection_archive---------6-----------------------#2021-12-18">https://towardsdatascience.com/deploy-a-python-visualization-panel-app-to-google-cloud-cafe558fe787?source=collection_archive---------6-----------------------#2021-12-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f6a7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">谷歌云应用引擎和 Github 操作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eef3f5fcbb78762dc5eacf8efee87aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-z0AgXhi-Q479Ea9mJ6rDg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@blackpoetry?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">pix poeties</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="a5b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关文章:<a class="ae ky" href="https://sophiamyang.medium.com/deploy-a-python-visualization-panel-app-to-google-cloud-ii-416e487b44eb?sk=aac35055957ba95641a6947bbb436410" rel="noopener"> Python 可视化面板 App to Google Cloud Run:Google Cloud Run、Google Cloud Build、Terraform </a></p><p id="b249" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在不了解 Docker 或 Kubernetes 以及不使用 Docker 文件的情况下，有可能将 Python 应用程序或仪表板部署到云上吗？是的，这是可能的，而且使用谷歌云应用引擎非常简单！本文将向您展示如何使用三个简短的脚本将 Panel 应用程序部署到 Google Cloud，并展示如何使用 Github 操作自动化您的工作流程。</p><p id="5c66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的非常简单的示例应用程序的样子。这里托管<a class="ae ky" href="https://panel-gcp-demo.ue.r.appspot.com/" rel="noopener ugc nofollow" target="_blank"/>(我会保持 3 个月的直播)。关于面板应用的更多例子和灵感，请查看<a class="ae ky" href="http://awesome-panel.org" rel="noopener ugc nofollow" target="_blank">awesome-panel.org</a>、<a class="ae ky" href="https://panel.holoviz.org/" rel="noopener ugc nofollow" target="_blank">panel.holoviz.org</a>，以及我之前关于<a class="ae ky" rel="noopener" target="_blank" href="/visualization-and-interactive-dashboard-in-python-c2f2a88b2ba3?sk=c78ed971426bbccb89798759779aa303"> HoloViz 工具</a>的博文。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/6f1bee0bfcbe16b242073dd27a957673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9hOFb0ipRcSfRQOV"/></div></div></figure><p id="d044" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章中提到的所有代码都可以在这个回购:<a class="ae ky" href="https://github.com/sophiamyang/panel_gcp" rel="noopener ugc nofollow" target="_blank">https://github.com/sophiamyang/panel_gcp</a>。</p><h1 id="7c2f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak"> 1。设置</strong></h1><h2 id="2645" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated"><strong class="ak">设置您的 Google Cloud 帐户以启用应用程序引擎:</strong></h2><p id="d415" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">应用引擎文档(<a class="ae ky" href="https://cloud.google.com/appengine/docs/standard/python3/quickstart" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/App Engine/docs/standard/python 3/quick start</a>)描述了运行项目所需的四个步骤:</p><ul class=""><li id="6235" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated"><a class="ae ky" href="https://console.cloud.google.com/projectselector2/home/dashboard" rel="noopener ugc nofollow" target="_blank">选择或创建一个 Google Cloud 项目</a>(我们假设项目名称和 ID 都是“您的项目”)</li><li id="6aba" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><a class="ae ky" href="https://console.cloud.google.com/apis/library/appengine.googleapis.com" rel="noopener ugc nofollow" target="_blank">启用应用引擎 API </a></li><li id="152f" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><a class="ae ky" href="https://console.cloud.google.com/flows/enableapi?apiid=cloudbuild.googleapis.com" rel="noopener ugc nofollow" target="_blank">启用云构建 API </a></li><li id="984c" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><a class="ae ky" href="https://console.cloud.google.com/billing/projects" rel="noopener ugc nofollow" target="_blank">启用计费</a></li></ul><h2 id="de64" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">在本地机器上安装并初始化 Google Cloud SDK:</h2><ul class=""><li id="03de" class="nf ng it lb b lc na lf nb li nt lm nu lq nv lu nk nl nm nn bi translated"><a class="ae ky" href="https://cloud.google.com/sdk/docs/install" rel="noopener ugc nofollow" target="_blank">安装 Google Cloud SDK </a>:操作系统不同，说明也会有所不同，或者您可以简单地</li></ul><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="c3a5" class="mo lx it nx b gy ob oc l od oe">conda install -c conda-forge google-cloud-sdk</span></pre><ul class=""><li id="20ea" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">初始化 gcloud: <code class="fe of og oh nx b">gcloud init</code></li><li id="3102" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">将项目设置为“您的项目”(或您用于您的项目的任何名称/ID):</li></ul><p id="60f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe of og oh nx b">gcloud config set project your-project</code></p><h1 id="0456" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">2.<strong class="ak">创建面板应用</strong></h1><p id="e436" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">创建一个新目录，或者在这个目录中创建以下三个文件，或者从我的 repo 中获取:<a class="ae ky" href="https://github.com/sophiamyang/panel_gcp" rel="noopener ugc nofollow" target="_blank">https://github.com/sophiamyang/panel_gcp</a></p><h2 id="53b5" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated"><strong class="ak"> app.py </strong></h2><p id="7590" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">这是创建 Panel 应用程序的 Python 文件。要在本地运行这个应用程序，你可以简单地做<code class="fe of og oh nx b">conda install panel hvplot</code>并运行<code class="fe of og oh nx b">panel serve app.py</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><h2 id="4751" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated"><strong class="ak"> requirements.txt </strong></h2><p id="1fe7" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">该文件列出了我们的 Panel 应用程序的所有包依赖项。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><h2 id="45d0" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated"><strong class="ak"> app.yml </strong></h2><p id="c780" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">这是应用程序引擎配置文件。面板应用是散景应用的一种，散景应用需要指定<code class="fe of og oh nx b">env:flex</code>和<code class="fe of og oh nx b">entrypoint: panel serve app.py --adddress 0.0.0.0 --port 8080 --allow-websocket-origin="*"</code>，因为应用引擎灵活环境支持 WebSockets。其他类型的应用可能不需要 flex 环境和入口点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><h1 id="b114" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak"> 3。将 Panel 应用部署到谷歌云应用引擎</strong></h1><ul class=""><li id="19c5" class="nf ng it lb b lc na lf nb li nt lm nu lq nv lu nk nl nm nn bi translated">初始化您的应用引擎应用:<code class="fe of og oh nx b">gcloud app create</code></li><li id="3604" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">部署您的应用:<code class="fe of og oh nx b">gcloud app deploy</code></li></ul><p id="a288" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 gcloud 努力设置好你的项目几分钟后，你应该可以在<code class="fe of og oh nx b">your-project.ue.r.appspot.com</code>上看到你的仪表盘直播了。</p><p id="cbfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！现在，你可以与任何想使用你的应用的人共享该网址。<br/>如果您的部署有任何问题，检查日志和调试可能会有所帮助:<a class="ae ky" href="https://console.cloud.google.com/debug?project=panel-gcp" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/debug</a></p><p id="1387" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看整体信息:<a class="ae ky" href="https://console.cloud.google.com/appengine/" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/appengine</a></p><p id="ac6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看版本:<a class="ae ky" href="https://console.cloud.google.com/appengine/versions" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/appengine/versions</a></p><h1 id="c1fe" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">4.<strong class="ak">为自动化设置 Github 动作</strong></h1><p id="35a5" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">在实践中，当您开发和改进 Panel 应用程序时，您通常会希望随着时间的推移重新部署它的不同版本，同时保留文件的每个版本的记录。为了简化这个过程，您可能会发现 Github 动作非常有用。有了 Github Actions，我们可以建立一个工作流，每当我们推送变更、标记发布或获得 PR 时，一些构建、测试或部署流程就会运行。</p><ul class=""><li id="50b1" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">首先，我们需要按照这些<a class="ae ky" href="https://cloud.google.com/iam/docs/creating-managing-service-accounts" rel="noopener ugc nofollow" target="_blank">文档</a>到<a class="ae ky" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create" rel="noopener ugc nofollow" target="_blank">中的步骤创建一个服务帐户</a>，向您的服务帐户添加一个<a class="ae ky" href="https://cloud.google.com/iam/docs/creating-managing-service-account-keys" rel="noopener ugc nofollow" target="_blank">密钥</a>，并将密钥下载到一个 JSON 文件中。</li><li id="630e" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><a class="ae ky" href="https://console.developers.google.com/apis/api/appengine.googleapis.com/overview" rel="noopener ugc nofollow" target="_blank">启用应用引擎管理 API </a></li><li id="c56c" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">现在，如果您还没有这样做，创建一个新的 Github repo，并将第 3 节中的所有三个文件添加到这个 repo 中，并将其推送到 Github。</li><li id="3c62" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">进入你的 Github repo-Settings-Secrets，添加两个秘密</li></ul><p id="dc00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GCP 凭据:从您刚刚下载的 JSON 文件中复制并粘贴密钥</p><p id="bffc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GCP 项目:你的项目的名字，在上面的例子中是“你的项目”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/3b2b4b79af7d3abcde34d0f1ba7ab1d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1A38VDSkYeclhHy8"/></div></div></figure><ul class=""><li id="5905" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">增加一个<a class="ae ky" href="https://github.com/sophiamyang/panel_gcp/tree/main/.github" rel="noopener ugc nofollow" target="_blank">。您目录中的 github </a> / <a class="ae ky" href="https://github.com/sophiamyang/panel_gcp/tree/main/.github/workflows" rel="noopener ugc nofollow" target="_blank">工作流</a> /python-app.yml 文件</li></ul><p id="f6ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个 Github 操作配置文件。在这个例子中，每当有主分支的推送时，我们将应用部署到 Google Cloud 应用引擎。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="69d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您的 Github 操作应该已经准备好了。您可以在“操作”选项卡上查看跑步信息。在这里，我尝试添加另一个应用程序，工作流程自动开始运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/37061a0db3cd2f709416841a3cc9c5f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rQrRVPbZ9ysLMW2V"/></div></div></figure><p id="860b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以看到我们有两个应用程序正在运行</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/6105d4be91de34447d710ff94396217e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fkHfgWfFf5MK4tgo"/></div></div></figure><p id="d690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，本文使用三个简单的脚本将可视化面板应用程序部署到 Google Cloud App Engine，并使用另一个配置文件来设置 Github 操作。你可能会想，为什么我不用 Google Cloud Run 或者 AWS？我写了另一篇关于 Google Cloud Run 的文章。来看看:<a class="ae ky" href="https://sophiamyang.medium.com/deploy-a-python-visualization-panel-app-to-google-cloud-ii-416e487b44eb?sk=aac35055957ba95641a6947bbb436410" rel="noopener"> Python 可视化面板应用到 Google Cloud Run: Google Cloud Run，Google Cloud Build，和 Terraform </a>。就 AWS 而言，我在 Anaconda 的朋友们正在研究一些非常酷的东西，以帮助简化 AWS 的部署过程，预计将在 2022 年的某个时候推出。敬请期待！</p><p id="c654" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于那些对视频教程感兴趣的人，这里是本文的视频版本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok oj l"/></div></figure><p id="05a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">参考文献</strong>:</p><ul class=""><li id="5b5c" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated"><a class="ae ky" href="https://cloud.google.com/appengine/docs/standard/python3/runtime#application_startup" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/app engine/docs/standard/python 3/runtime # application _ startup</a></li><li id="f2e9" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated"><a class="ae ky" href="https://cloud.google.com/appengine/docs/flexible/python/quickstart" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/app engine/docs/flexible/python/quick start</a></li></ul><p id="7d1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">鸣谢</strong>:感谢 Jim Bednar 和 Philipp Rudiger 的支持和指导。</p><p id="9c52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作者索菲亚·杨 2021 年 12 月 18 日</p></div></div>    
</body>
</html>