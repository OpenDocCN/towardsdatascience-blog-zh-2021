<html>
<head>
<title>R for Beginners: Learn How To Visualize Data Like a Pro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者:学习如何像专家一样可视化数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/r-for-beginners-learn-how-to-visualize-data-like-a-pro-840d1828c09c?source=collection_archive---------10-----------------------#2021-07-13">https://towardsdatascience.com/r-for-beginners-learn-how-to-visualize-data-like-a-pro-840d1828c09c?source=collection_archive---------10-----------------------#2021-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6868" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">r教程</h2><div class=""/><div class=""><h2 id="3b69" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">基于案例研究的介绍，将引导您开始使用ggplot2库创建高质量的图形并了解世界</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b62fec9b471398871f2d705599ce10fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCUnfJdXc34SNGntYPzxig.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="a2b8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你曾经想分析数据，并想在你的技能组合中添加一个新的工具包，供专业数据科学家使用，那么请继续阅读。</p><p id="439c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本教程不会给出一个枯燥的命令列表，而是使用一个具体的案例研究作为一个激励性的例子，向您介绍您需要了解的关于ggplot2的一切，gg plot 2是在r中创建高质量图形的事实上的标准。它是一个由<a class="ae md" href="https://www.tidyverse.org/" rel="noopener ugc nofollow" target="_blank"> tidyverse </a>生态系统支持的第三方库。虽然您可以使用基本库在R中绘图，但您最有可能在任何实际项目中使用ggplot2。因此，我强烈建议您可以直接使用这个库进行绘图。</p><p id="64f5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本教程适合任何希望为他们的数据科学项目学习R的人。它不需要任何编程或R方面的背景知识。唯一的先决条件是您有一台可以上网的计算机，并且已经安装了R和RStudio。然而，如果他们还没有安装，你可以查看我的简短视频教程<a class="ae md" href="https://www.youtube.com/watch?v=mKXkVi-UiSw" rel="noopener ugc nofollow" target="_blank">这里</a>，这将帮助你设置R，然后RStudio在任何时间。一旦你设置好你的电脑，回到本教程，让我们开始破解。</p><h2 id="0aa2" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">如果我是Python用户怎么办？</h2><p id="94ca" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">如果您习惯于Python，您可能不太熟悉图形范式的语法，图形范式提供了一种更系统的可视化数据呈现方式。这类似于语言中的语法，我们通过结合名词、动词、冠词等来造句。使用特定的规则。因此，我仍然鼓励你通读并理解这个新的范例。你再也不会以同样的方式看待图形了。</p><p id="26a9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">ggplot2是图形范例语法的一个R实现。它的对等物在Python中有一个不太出名的库，<a class="ae md" href="https://plotnine.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> plotnine </a>。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="b6bc" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">案例研究动机</h1><p id="2341" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">我想向你们介绍已故的瑞典统计学家汉斯·罗斯林，他最著名的演讲是他试图用实际数据来辩论普遍持有的世界观。</p><p id="d290" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在他的全球健康课上，他让他的学生在给定的两个国家中找出哪个国家的死亡率更高。平均而言，学生们得到了1.8分的正确答案(满分为5分)。然后，他对一组精选的教授(他们有诺贝尔奖)重复了这个测试，他们的平均分数是2.4分。教授们比学生们做得稍微好一点，但是这个分数仍然比那些对世界一无所知的随机回答的人(例如黑猩猩)差。</p><p id="abbb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为什么一只黑猩猩会比成绩优异的学生和少数教授做得更好？</p><p id="04aa" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是因为我们的世界观被关注负面事件的耸人听闻的媒体所主导，给了我们一个扭曲的世界观。汉斯·罗斯林创立的Gapminder基金会的使命就是用数据来纠正这种扭曲的世界观。我们有包括联合国各部门在内的各种组织收集的关于世界的大量数据。然而，到目前为止的挑战是访问隐藏在不知名的服务器的表中的数据，并适当地呈现这些数据。</p><p id="4170" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在本案例研究中，我们将使用Gapminder基金会的数据来回答3个关键问题:</p><p id="a75d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="nt"> 1:人均寿命和人均GDP有关系吗？</em></p><p id="90f6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="nt"> 2:在过去的50年里，全世界的预期寿命有什么变化？</em></p><p id="08f6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">世界真的分成了两个截然不同的群体吗，西方和其他国家(发展中国家)？</p><p id="987c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">使用这个案例研究，我们将创建六种图:散点图、折线图、箱线图、直方图、密度图和条形图。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="6396" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">图形语法</h1><p id="6b7e" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">在我们进入情节之前，这里有一个非常简短的关于ggplot2实现的图形语法的迂回，这是帮助你开始的最低要求。</p><p id="6429" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">图形是数据的可视化表示。它帮助我们将<strong class="lj jd"> <em class="nt">数据</em> </strong>映射到<strong class="lj jd"> <em class="nt">审美</em> </strong>属性的<strong class="lj jd"> <em class="nt">几何对象</em> </strong>中。前面提到的每种图形类型都是一个“几何对象”。每个“几何物体”都会有一些美学属性。例如，折线图是一个几何对象，而x或y位置以及颜色是相关联的美感。每个数据图形都需要三个基本组件:</p><ul class=""><li id="9872" class="nu nv it lj b lk ll ln lo lq nw lu nx ly ny mc nz oa ob oc bi translated">数据</li><li id="2f49" class="nu nv it lj b lk od ln oe lq of lu og ly oh mc nz oa ob oc bi translated">几何对象(由<em class="nt"> geom </em>指定)</li><li id="4eb3" class="nu nv it lj b lk od ln oe lq of lu og ly oh mc nz oa ob oc bi translated">属性(由<em class="nt"> aes </em>指定)</li></ul><p id="fafa" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你有以上三个，你可以把它们结合在一起，形成一个有意义的图形对象。如果这感觉有点抽象，不要担心。一旦您看到相关的代码，并意识到通过组合这三个组件来绘制复杂的图形是多么简单，这一切都将变得有意义。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="1733" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">散点图</h1><p id="cc41" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">我们将从绘制散点图开始。散点图是帮助我们可视化两个数字量之间关系的基本绘图类型之一。我们将使用散点图来回答我们的第一个问题，人均GDP和预期寿命之间的关系。这两个量都是数字，因此这是一个合适的图，可以让我们了解两者之间的关系。</p><h2 id="be8f" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">数据加载和检查</h2><p id="2f10" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">让我们从导入数据开始。我们将使用来自Gapminder基金会的数据。你可以直接从他们的网站上获取数据。然而，对于本教程，我们将使用一个名为gapminder的第三方库。(这个库是由Jenny Bryan开发的，她现在在RStudio的tidyverse团队工作)。</p><p id="b289" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">打开R Studio，创建一个新的R脚本文件。让我们从安装第三方包开始。你只需要第一次这样做。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="b223" class="me mf it oj b gy on oo l op oq">install.packages("gapminder")</span></pre><p id="184b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">安装后，加载软件包。每次打开新的R Studio会话时，您都需要这样做。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="b1e8" class="me mf it oj b gy on oo l op oq">library(gapminder)</span></pre><p id="474c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">还要加载tidyverse包，它加载了几个包，作为包括ggplot2在内的整个生态系统的一部分(如果您愿意，也可以单独加载每个单独的包)。如果这是您的第一次，那么首先安装tidyverse包。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="1e61" class="me mf it oj b gy on oo l op oq">install.packages(tidyverse) # required only the first time<br/>library(tidyverse)</span></pre><p id="bd8c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">gapminder包中有几个数据集。我们将使用的是“gapminder”。继续检查数据集。有几个命令可以检查数据。您可以使用head和tail命令来提供数据集中的前几行或后几行。但是，我强烈推荐使用的命令是summary命令。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="9bdf" class="me mf it oj b gy on oo l op oq">head(gapminder, n=8) # list the first 8 rows in the dataset<br/>tail(gapminder, n=10) # list the last 10 rows in the dataset<br/>summary(gapminder) # recommended method</span></pre><p id="1493" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">summary命令返回数据集中所有列的总体摘要。这为您提供了数据集的良好鸟瞰图。如下面的输出所示，我们可以看到gapminder数据集有6列，我们还可以看到分类列的每个类别的行数，以及汇总统计数据(平均值/中值/最大值/最小值等。)用于数字列</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/bf44a2ee605c158cd97933f18e2ee4d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQVW6Ij49p1qbBGanFycmA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">summary命令的输出提供了数据集的鸟瞰图(图片由作者提供)</p></figure><h2 id="88fe" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">基本情节</h2><p id="c7a1" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">现在让我们创建我们的第一个散点图。我们将使用ggplot函数，然后传递三个基本组件:</p><ul class=""><li id="32e8" class="nu nv it lj b lk ll ln lo lq nw lu nx ly ny mc nz oa ob oc bi translated">数据(我们希望绘制的数据)</li><li id="f46d" class="nu nv it lj b lk od ln oe lq of lu og ly oh mc nz oa ob oc bi translated">geom(我们期望在图中看到的对象类型，如线、条、点)</li><li id="1a30" class="nu nv it lj b lk od ln oe lq of lu og ly oh mc nz oa ob oc bi translated">aes(几何对象的美学属性，如位置、颜色、形状和大小)</li></ul><p id="9b80" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">让我们将这三个组件传递给ggplot函数，并将结果对象赋给一个新变量，<em class="nt"> p </em>。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="0c22" class="me mf it oj b gy on oo l op oq">p &lt;- ggplot( data=gapminder, aes(x = gdpPercap, y = lifeExp)) + geom_point()<br/>p</span></pre><p id="f970" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是你的第一个情节，p应该是这样的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/285b550ccf6e011b7a491cbaa842bfbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*-v5o1o9D-PtW-PcY7VSkDw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">你的第一个散点图(图片由作者提供)</p></figure><p id="b2ae" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> <em class="nt">我们现在将通过添加额外的层来逐步构建这个图形，很快你就会看到它用最少的代码带来了多大的变革。</em> </strong></p><h2 id="e677" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">将x轴缩放到对数刻度</h2><p id="15cb" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">虽然人均国内生产总值和预期寿命之间似乎确实存在联系，但x轴的刻度似乎被压缩了。我们可以简单地通过向现有的<em class="nt"> p </em>对象添加一个额外的命令，将x轴刻度改为对数刻度。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="410b" class="me mf it oj b gy on oo l op oq">p &lt;- p + scale_x_log10()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/0dc3f06861f11eeb1a9d5233340818ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*KQmUN9XsB4VjzzD3qVRBgg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">将x轴转换为对数标度后的散点图(图片由作者提供)</p></figure><p id="931d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这样看起来更好，我们现在可以看到一个清晰的关系。</p><h2 id="b94e" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">分类数据的颜色属性</h2><p id="0cbb" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">虽然散点图显示了数值之间的关系，但我们仍然可以通过使用颜色属性来包含分类数据信息。让我们分别代表各大洲。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="a0a1" class="me mf it oj b gy on oo l op oq">p &lt;- p + aes(color=continent)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d0f33a198a9a27d9e4a3b45650a04104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*He7IsR02IlbXTHOR3UJ_QQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">散点图现在用不同的颜色显示每个大陆(图片由作者提供)</p></figure><h2 id="e406" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">其他美学</h2><p id="74ef" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">有几种额外的美学可以用来将数据映射到视觉提示中。一般来说，我不会指望有人记得他们。你可以从RStudio网站上获得一份官方的<a class="ae md" href="https://www.rstudio.com/resources/cheatsheets/" rel="noopener ugc nofollow" target="_blank">备忘单</a>。一旦你习惯了这一点并加以练习，它就会成为你的第二天性。您将记住您经常使用的美学，并且您将更有能力查看官方文档或备忘单来使用适合您的应用程序的任何美学。</p><p id="a2a6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们的例子中，让我们尝试使用另一种美学，size属性，并使用它来表示人口数量。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="ebc0" class="me mf it oj b gy on oo l op oq">p + aes(size=pop)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/f00e4c3f7e6ea3ad0bb446c71d668245.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4vrns4xzJanPJibK4scmw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">散点图现在显示大小属性(图片由作者提供)</p></figure><h2 id="c1e9" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">添加抖动以显示重叠点</h2><p id="965c" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">散点图的一个局限性是它不能区分一个位置的大量重叠点和具有少量点的不同位置。处理这类案件的两种方法是:</p><ul class=""><li id="cf9d" class="nu nv it lj b lk ll ln lo lq nw lu nx ly ny mc nz oa ob oc bi translated">更改散点图中每个数据点的透明度。这由名为alpha的变量控制，该变量可以传递给geom_point()命令。默认情况下，alpha的值为1，对应于100%的不透明度。您现在可以尝试更改geom_point中的alpha值，看看会得到什么。</li></ul><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="9c18" class="me mf it oj b gy on oo l op oq">Hint: geom_point(alpha = 0.1)</span></pre><ul class=""><li id="022f" class="nu nv it lj b lk ll ln lo lq nw lu nx ly ny mc nz oa ob oc bi translated">向点添加抖动，这相当于给每个数据点一个小的推动，让它在随机方向上稍微移动。要创建抖动图，我们只需用geom_jitter替换命令geom_point，并使用宽度和高度属性指定抖动量。下面是一个将抖动与指定给身高和体重的特定值结合使用的示例。继续使用这些值，看看当你在抖动中改变高度和宽度属性时会有多大的不同。请理解，添加抖动只是为了视觉外观。</li></ul><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="9a71" class="me mf it oj b gy on oo l op oq">p + geom_jitter(width=2,height=2)</span></pre><h2 id="5f88" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">添加趋势线</h2><p id="873d" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">虽然您可以通过查看数据点来直观地了解趋势，但是您也可以绘制一条与数据点拟合的实际直线。你所需要做的就是简单地添加一个额外的层叫做geom_smooth()。在下面的代码中，我们向“line width”参数传递了一个额外的值，这导致为每组数据点拟合一条粗线。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="aa1e" class="me mf it oj b gy on oo l op oq">p+geom_smooth(lwd=3)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/38b6a7292d94b95d1d0ee985f0a8d5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vhRX237Kk1bbiIuLkR6Feg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">向每组数据点添加趋势线(图片由作者提供)</p></figure><p id="2f08" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有了上面的散点图，我们可以清楚地回答我们的第一个问题。<strong class="lj jd"> <em class="nt">人均寿命和人均GDP有很强的关系。</em> </strong> <strong class="lj jd"> <em class="nt">这对于所有5大洲都是如此。</em> </strong></p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="debf" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">折线图</h1><p id="9b67" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">像散点图一样，线图也显示两个数值之间的关系。当其中一个变量被排序时(例如时间线)，它们通常更有用。我们将使用折线图来调查预期寿命在过去40年中是如何变化的。</p><p id="28ef" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们需要做的就是使用geom_line()参数，而不是geom_point()。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="7134" class="me mf it oj b gy on oo l op oq">p &lt;- ggplot( data=gapminder, aes(x = year, y = lifeExp)) + geom_line()</span></pre><p id="1e2e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这就给了我们下面的剧情。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/2e1711c25fb613ad9383bf40cb97e37d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qmuCxsBK9NBbHMXx6ToIDA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">没有任何分组并使用所有数据的线图(图片由作者提供)</p></figure><p id="7a86" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">但是，我们希望为每个国家分别绘制数据。因此，我们可以使用“组”的美学参数按国家对数据进行“分组”。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="0c64" class="me mf it oj b gy on oo l op oq">p&lt;-p+aes(group=country)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/862b83dfe6c1d50537fccaf13792901f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17a50MNR30hYXlzx8BSCZg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">线形图，每个国家一个(图片由作者提供)</p></figure><p id="5496" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这看起来更好，我们可以看到从1950年到2010年的增长。然而，我们希望看到每个大陆的趋势，因为图表目前看起来很混乱。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="bb4b" class="me mf it oj b gy on oo l op oq">p &lt;- p +  aes(color=continent)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/f8ddd5e24eb9a4e0f35e93151e6d6d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BMo82ryOtB0LI2e7SC94dQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每个国家的线图，按洲分开(图片由作者提供)</p></figure><h2 id="5b67" class="me mf it bd mg mh mi dn mj mk ml dp mm lq mn mo mp lu mq mr ms ly mt mu mv iz bi translated">刻面</h2><p id="93aa" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">除了用颜色来区分不同的类别，我们还可以把它们分成小的支线剧情。我们可以通过刻面层做到这一点。下图是我们在原始命令中添加了一个小平面层后生成的。然后对每个由“大陆”分隔的子情节使用相同的x和y，变量传递给faceting。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="b567" class="me mf it oj b gy on oo l op oq">p &lt;- p +  facet_wrap(~continent)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/1d17ba39128167e9cb6bf20cbd48cb56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7G0jTJUpZZhBtr0fycJ70A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">多年来的预期寿命，每个大陆一个分图使用刻面(图片由作者提供)</p></figure><p id="11cf" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">您还可以使用“子集”功能对数据进行子集化，并查看选定的国家列表。让我们比较一组精选的国家，画出这些年来它们的预期寿命。我任意选择了阿富汗、中国、日本、科威特、马拉维、巴基斯坦、瑞典和美国。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="20ab" class="me mf it oj b gy on oo l op oq">ggplot(subset(gapminder, country=='Afghanistan' | country=='China' | country=='United States' | country=='Sweden' | country=='Japan' | country=='Kuwait' | country=='Malawi' | country=='Pakistan'), aes(x=year,y=lifeExp,colour=country))+geom_line(lwd=1.5)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/71646edea83020c75094667c3f28a58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jHCJi7dowMjQUl9Fd4SKOA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">过去40多年来一些选定国家的预期寿命(图片由作者提供)</p></figure><p id="9dd2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上面的线图清楚地向我们显示，在过去的几十年里，各大洲所有国家的预期寿命都有所增加。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="83dc" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">箱线图</h1><p id="e9e2" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">箱线图给我们一种数值变量分布的感觉，通过并排绘制箱线图来比较多个变量是非常有用的。让我们用箱线图来形象化各大洲的预期寿命分布。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="de38" class="me mf it oj b gy on oo l op oq">ggplot(data=gapminder, aes(x=continent, y=lifeExp))+geom_boxplot()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/49c6184283f984944fd668da31c7f8eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEmKfPwxThCan1dtpox25g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">显示五大洲预期寿命分布的基本箱线图(图片由作者提供)</p></figure><p id="cdfc" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">您可以使用geom_point()或geom_jitter()在箱线图顶部添加原始点。下面是一个使用geom_jitter()函数并更改异常值颜色的示例，这样我们就可以将这些异常值与剩余的原始数据区分开来。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="88a9" class="me mf it oj b gy on oo l op oq">ggplot(data=gapminder, aes(x=continent, y=lifeExp))+geom_boxplot(outlier.colour = "red")+geom_jitter(width=0.2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pb"><img src="../Images/5b50464d52fcaf8a6dbeea76f7844d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u1TPlSeeQbts_YEYWF-i8A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">显示五大洲预期寿命分布的基本箱线图，以及带有抖动的原始点(图片由作者提供)</p></figure><p id="c253" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">该图清楚地表明，虽然欧洲和大洋洲的平均预期寿命高于其他大陆，但其他大陆的一些国家的预期寿命比欧洲和大洋洲的一些国家要高得多。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="a83f" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">柱状图</h1><p id="5d9b" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">另一个能说明变量分布的图表是直方图。我们可以使用geom_histogram创建一个直方图，并为洲指定“fill”属性，这样我们就可以使用不同的颜色来比较洲。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="d390" class="me mf it oj b gy on oo l op oq">ggplot(data=gapminder, aes(fill=continent, x=lifeExp))+geom_histogram()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/fb9c1970fee2de1b655bd7f579c6318f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qLcRsBGOmAZDJDN0GsgETA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">显示各大洲预期寿命分布的柱状图(图片由作者提供)</p></figure><p id="a81c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">与直方图密切相关的图是使用概率密度图。这里，我们将使用geom_density并指定一个alpha值来调整透明度，以便更好地查看重叠的地块。让我们也使用xlab和ylab函数来适当地标记这两个轴。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="00a8" class="me mf it oj b gy on oo l op oq">ggplot(data=gapminder, aes(fill=continent, x=lifeExp))+ geom_density(alpha = 0.2)+xlab('Life Expectancy')+ylab('Probability Density Function')</span></pre><p id="05f2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这将给我们以下情节:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pd"><img src="../Images/38b722facc94d159315b1884e6de0679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u7USkfCmVozNM-ujNUZLSA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">显示各大洲预期寿命分布的概率密度函数图(图片由作者提供)</p></figure><p id="32a4" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">箱线图、直方图和密度图越来越清楚地表明，东西方之间似乎是一个连续体，而不是二分法。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="0f56" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">条形图</h1><p id="556c" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">箱线图和直方图都有助于我们可视化数值变量的分布。然而，我们有时可能需要了解分类数据的分布。这相当于计算给定分类变量中类别的数量。geom_boxplot()允许我们绘制条形图，默认情况下，它计算给定变量中类别的数量。让我们使用continental变量绘制一个条形图，它将给出每个洲的记录数。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="e338" class="me mf it oj b gy on oo l op oq">ggplot(data=gapminder, aes(x=continent))+ geom_bar()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/db450de7e4e53c609c4a0d4144952908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qmReWBtpEd7cB9maM2lTQw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">柱状图显示了我们在各大洲的记录总数(图片由作者提供)</p></figure><p id="4c0a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">最后，我们还可以修改上面的代码来查找给定年份(2007年)的记录数，并翻转坐标，这样我们就可以看到水平的条形。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="2776" class="me mf it oj b gy on oo l op oq">ggplot(data=subset(gapminder, year==2007), aes(x=continent))+ geom_bar() +coord_flip()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/01e4dbd3276486f0a8f0d459e4e0fbd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3N0qYTMbaK8vCmQYng9ng.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">水平条形图显示了给定年份我们在各大洲的记录总数(图片由作者提供)</p></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="84aa" class="ni mf it bd mg nj nk nl mj nm nn no mm ki np kj mp kl nq km ms ko nr kp mv ns bi translated">摘要</h1><p id="9b5c" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">本教程向您介绍了ggplot2库，以帮助您用六种不同类型的图来可视化您的数据(下面提供了可视化摘要)。使用来自Gapminder基金会的数据向您提供了一个完整的演示。上面列出的所有代码在我的<a class="ae md" href="https://github.com/syedahmar/BlogTutorials/blob/main/ggplot2_introduction.R" rel="noopener ugc nofollow" target="_blank"> github </a>中也有。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/b1036183f3110fb875b6f29008c8c70b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3gsqkLAFIndf4XAU0kNt_A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">散点图、折线图、箱线图、直方图、密度图和条形图，每个的用途，以及相关的几何对象命令(图片由作者提供)</p></figure><div class="ph pi gp gr pj pk"><a href="https://ahmarshah.medium.com/membership" rel="noopener follow" target="_blank"><div class="pl ab fo"><div class="pm ab pn cl cj po"><h2 class="bd jd gy z fp pp fr fs pq fu fw jc bi translated">阅读艾哈迈尔·沙阿博士(牛津)的每一个故事(以及媒体上成千上万的其他作家)</h2><div class="pr l"><h3 class="bd b gy z fp pp fr fs pq fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ps l"><p class="bd b dl z fp pp fr fs pq fu fw dk translated">ahmarshah.medium.com</p></div></div><div class="pt l"><div class="pu l pv pw px pt py lb pk"/></div></div></a></div></div></div>    
</body>
</html>