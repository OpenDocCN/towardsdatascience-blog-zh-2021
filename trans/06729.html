<html>
<head>
<title>Working with DateTime in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中使用日期时间</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-datetime-in-python-e032b8d2f512?source=collection_archive---------17-----------------------#2021-06-17">https://towardsdatascience.com/working-with-datetime-in-python-e032b8d2f512?source=collection_archive---------17-----------------------#2021-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="781b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">编程；编排</h2><div class=""/><div class=""><h2 id="b332" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">立刻成为日期和时间的主人</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/424861c95c521236e6895b42ad0a16a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dht5kbd4Htb94Qk9ElGaVA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:<a class="ae lh" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank">Undraw.co</a></p></figure><h1 id="7d91" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="6a9b" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在您作为数据科学家的职业生涯中，不可避免地会遇到包含日期和时间的数据。出于这个原因，这篇内容丰富的指南旨在帮助使用Python的<code class="fe mw mx my mz b">datetime</code>模块轻松操作日期和时间数据。我们将涉及一系列主题，比如处理日期和时间字符串、测量时间跨度以及在<code class="fe mw mx my mz b">pandas</code>中使用datetime对象。</p><h1 id="9e13" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">Python的日期时间类</h1><p id="d235" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">为了向您介绍<code class="fe mw mx my mz b">datetime</code>模块，有五个主要的对象类可以方便地用于不同的目的。它们如下:</p><ul class=""><li id="ef62" class="na nb it mc b md nc mg nd mj ne mn nf mr ng mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">datetime</code> —允许我们一起操作日期和时间(月、日、年、小时、秒、微秒)。</li><li id="fa4a" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">date</code> —仅允许我们操作日期(月、日、年)。</li><li id="e7cf" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">time</code> —你大概猜到了；这个类只允许我们操纵时间(小时、分钟、秒、微秒)。</li><li id="8f03" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">timedelta</code> —用于测量持续时间，即两个日期或时间之间的差异。</li><li id="8d5f" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">tzinfo</code> —用于处理时区。我们不会在本教程中涉及这一点。</li></ul><p id="8178" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">让我们来看看何时以及如何使用这些类。</p><h1 id="b937" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">使用日期时间</h1><p id="2cde" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">首先，重要的是要注意到<code class="fe mw mx my mz b">datetime</code>既是一个模块，也是该模块中的一个类，用于编写您的导入。</p><p id="0919" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">我们将演示使用<code class="fe mw mx my mz b">datetime</code>对象的两种方法。</p><p id="1db3" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">首先，您可以将参数传递给<code class="fe mw mx my mz b">datetime</code>，从最大的时间单位开始，以最小的时间单位结束(年、月、日、小时、分钟、秒)。值得一提的是，你在现实生活中不会经常遇到这种方法，因为你很可能会发现自己正在使用现成的数据，但尽管如此，知道这一点还是有好处的。</p><p id="b35d" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">第二，如果你想得到当前的<code class="fe mw mx my mz b">datetime</code>，你可以很容易地使用<code class="fe mw mx my mz b">.now()</code>函数。</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="6366" class="nx lj it mz b gy ny nz l oa ob"># import datetime<br/>import datetime from datetime</span><span id="8a2a" class="nx lj it mz b gy oc nz l oa ob"># create datetime object <br/># datetime_object1 = datetime(2021, 6, 1, 15, 23, 25)</span><span id="e343" class="nx lj it mz b gy oc nz l oa ob"># get current date<br/>datetime_object2 = datetime.now()</span></pre><p id="7299" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">使用<code class="fe mw mx my mz b">datetime</code>很酷的一点是，我们可以对不同的<code class="fe mw mx my mz b">datetime</code>对象进行运算。例如，让我们假设我们想要找出前两个日期时间之间经过的秒数。我们可以这样做:</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="050f" class="nx lj it mz b gy ny nz l oa ob">duration = <!-- -->datetime_object2<!-- --> - datetime_object1<br/>duration.total_seconds()</span></pre><h2 id="e489" class="nx lj it bd lk od oe dn lo of og dp ls mj oh oi lu mn oj ok lw mr ol om ly iz bi translated">访问单个组件</h2><p id="2d82" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">您可以使用日期时间的属性访问<code class="fe mw mx my mz b">datetime</code>对象的单个组件；例如年、日和小时属性。</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="842c" class="nx lj it mz b gy ny nz l oa ob"># extract data<br/>datetime_object2<!-- -->.year<br/>datetime_object2<!-- -->.day <br/>datetime_object2<!-- -->.hour</span></pre><p id="b951" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">此外，您还可以使用<code class="fe mw mx my mz b">.weekday()</code>功能找到星期几。</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="dbaf" class="nx lj it mz b gy ny nz l oa ob">datetime_object2<!-- -->.weekday()</span></pre><p id="b1bb" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">运行前一行得到的结果是<code class="fe mw mx my mz b">2</code>，这是一个星期三。请注意，Python从0开始计算工作日，从星期一开始。这意味着:</p><ul class=""><li id="913b" class="na nb it mc b md nc mg nd mj ne mn nf mr ng mv nh ni nj nk bi translated">0 =星期一</li><li id="8ee7" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated">1 =星期二</li><li id="fce6" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated">2 =星期三</li><li id="d7c1" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi">…</li><li id="2b57" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated">6 =星期日</li></ul><p id="025d" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">既然我们已经介绍了<code class="fe mw mx my mz b">datetime</code>对象的来龙去脉，你也可以很容易地使用<code class="fe mw mx my mz b">date</code>和<code class="fe mw mx my mz b">time</code>对象，因为它们使用相同的方法。</p><h1 id="bd32" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">使用时间增量</h1><p id="702f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在我们想要测量持续时间的情况下,<code class="fe mw mx my mz b">timedelta</code>类很方便，因为它表示两个日期或时间之间的时间量。当我们想要从日期或时间中加减时，这特别有用。</p><p id="3242" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">我们将继续演示如何一起使用<code class="fe mw mx my mz b">timedelta</code>对象和<code class="fe mw mx my mz b">datetime</code>对象进行数学运算。例如，我们将在当前时间上增加27天。</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="8935" class="nx lj it mz b gy ny nz l oa ob"># import timedelta<br/>from datetime import timedelta</span><span id="066d" class="nx lj it mz b gy oc nz l oa ob"># create a 27 day timedelta<br/>td = timedelta(days=27)</span><span id="85d1" class="nx lj it mz b gy oc nz l oa ob">#add 27 days to current date<br/>27_days_later = datetime_object2 + td</span></pre><p id="dbd7" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">类似于我们上面所做的，我们也可以使用<code class="fe mw mx my mz b">timedelta</code>从当前日期或任何其他日期中减去。</p><p id="135d" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">注意<code class="fe mw mx my mz b">timedelta</code>可用于任意周数、天数、小时数、分钟数等。它可以使用小到一微秒的时间单位，大到<em class="on">270万年</em>！令人印象深刻。</p><h1 id="c54e" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">使用日期和时间字符串</h1><p id="f40c" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">通常，我们会发现我们想要将对象从字符串转换成<code class="fe mw mx my mz b">datetime</code>对象，反之亦然。<code class="fe mw mx my mz b">datetime</code>包括两个有用的方法，可以帮助我们实现这一点；也就是说，<code class="fe mw mx my mz b">strptime()</code>和<code class="fe mw mx my mz b">strftime().</code>我们可以使用<code class="fe mw mx my mz b">strptime()</code>读取包含日期和时间信息的字符串并将它们转换成<code class="fe mw mx my mz b">datetime</code>对象，使用<code class="fe mw mx my mz b">strftime()</code>将<code class="fe mw mx my mz b">datetime</code>对象转换回字符串。</p><p id="fada" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">当使用<code class="fe mw mx my mz b">strptime()</code>时，我们必须考虑到它不能将任何字符串转换成日期和时间，因此我们必须自己指示时间格式。最好用一个例子来说明这一点:</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="b6b5" class="nx lj it mz b gy ny nz l oa ob">date_string = '2020-11-27'<br/><br/># Create date object with time format yyyy-mm-dd<br/>date = datetime.strptime(date_string, "%Y-%m-%d")</span></pre><p id="3785" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">注意<code class="fe mw mx my mz b">strptime()</code>有两个参数:</p><ul class=""><li id="037c" class="na nb it mc b md nc mg nd mj ne mn nf mr ng mv nh ni nj nk bi translated">字符串-字符串格式的时间</li><li id="1277" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated">格式—字符串中时间的特定格式</li></ul><p id="9d5f" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">如果你不熟悉帮助<code class="fe mw mx my mz b">strptime()</code>解释我们的字符串输入所需的格式化代码，你可以在这里找到<a class="ae lh" href="https://strftime.org/" rel="noopener ugc nofollow" target="_blank">有用的参考</a>。</p><h1 id="f23f" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">使用熊猫日期时间对象</h1><p id="61c6" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><code class="fe mw mx my mz b">pandas</code>是最受欢迎的Python模块之一，这是有充分理由的。其中之一是它使处理时间序列数据变得轻而易举。与<code class="fe mw mx my mz b">datetime</code>模块相似，pandas也有与<code class="fe mw mx my mz b">datetime</code>模块功能相似的<code class="fe mw mx my mz b">datetime</code>和<code class="fe mw mx my mz b">timedelta</code>对象。</p><p id="fd0e" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">简单介绍一下，我们可以使用以下函数将日期时间和持续时间字符串转换为pandas日期时间对象:</p><ul class=""><li id="e2bb" class="na nb it mc b md nc mg nd mj ne mn nf mr ng mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">to_datetime()</code> —将字符串格式的日期和时间转换为Python <code class="fe mw mx my mz b">datetime</code>对象。</li><li id="dbbc" class="na nb it mc b md nl mg nm mj nn mn no mr np mv nh ni nj nk bi translated"><code class="fe mw mx my mz b">to_timedelta()</code> —用于测量持续时间。</li></ul><p id="baeb" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">这些函数在将字符串转换成Python <code class="fe mw mx my mz b">datetime</code>时做得很好，因为它们自动检测日期的格式，而不需要我们像对<code class="fe mw mx my mz b">strptime()</code>那样定义它。</p><p id="f597" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">让我们用一个具体的例子来检验这一点:</p><pre class="ks kt ku kv gt nt mz nu nv aw nw bi"><span id="deeb" class="nx lj it mz b gy ny nz l oa ob"># import pandas <br/>import pandas as pd</span><span id="63d9" class="nx lj it mz b gy oc nz l oa ob"># create date object <br/>date = pd.to_datetime("4th of oct, 2020")</span></pre><p id="84fd" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">即使我们的输入看起来是一个复杂的字符串，<code class="fe mw mx my mz b">pandas</code>仍然能够正确地解析该字符串并返回一个<code class="fe mw mx my mz b">datetime</code>对象。</p><h2 id="31aa" class="nx lj it bd lk od oe dn lo of og dp ls mj oh oi lu mn oj ok lw mr ol om ly iz bi translated">提取单个组件</h2><p id="ac22" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">假设我们想从日期中提取月、小时或分钟，并将其作为一个新列存储在pandas数据帧中。我们使用<code class="fe mw mx my mz b">dt</code>属性很容易做到这一点。</p><p id="36b9" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">例如，我们可以使用<code class="fe mw mx my mz b">df['date'].dt.month</code>从包含完整日期的pandas列中提取月份，并将其存储在一个新列中。这个例子当然也可以扩展到不同的时间单位。</p><p id="3195" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">类似于我们之前使用的<code class="fe mw mx my mz b">datetime</code>类，pandas也能够提取元素，例如星期几。我们再次使用<code class="fe mw mx my mz b">dt</code>属性来完成这项工作。</p><p id="2855" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">比如我们可以用<code class="fe mw mx my mz b">df['date'].dt.weekday</code>提取一天的数字，0代表星期一等等。如果我们想直接提取工作日的名称，我们可以方便地使用<code class="fe mw mx my mz b">df['date'].dt.weekday_name</code>来完成。</p><h1 id="a3eb" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结论</h1><p id="3632" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在本指南中，我们介绍了如何通过处理字符串、使用<code class="fe mw mx my mz b">timedelta</code>测量持续时间和进行简单的算术运算以及使用<code class="fe mw mx my mz b">pandas</code>中的日期时间对象来成功地浏览日期和时间的世界。</p><p id="0515" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">如果你有任何问题，我很乐意在评论中回答！</p><p id="d56d" class="pw-post-body-paragraph ma mb it mc b md nc kd mf mg nd kg mi mj nq ml mm mn nr mp mq mr ns mt mu mv im bi translated">我希望这个指南对你有所帮助。如果你这样做了，你可能会发现我的其他一些文章也很有趣:</p><div class="oo op gp gr oq or"><a rel="noopener follow" target="_blank" href="/a-machine-learning-approach-to-credit-risk-assessment-ba8eda1cd11f"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd jd gy z fp ow fr fs ox fu fw jc bi translated">信用风险评估的机器学习方法</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">预测贷款违约及其概率</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">towardsdatascience.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf lb or"/></div></div></a></div><div class="oo op gp gr oq or"><a rel="noopener follow" target="_blank" href="/a-quick-and-easy-guide-to-code-profiling-in-python-58c0ed7e602b"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd jd gy z fp ow fr fs ox fu fw jc bi translated">Python中代码剖析的快速简易指南</h2><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">towardsdatascience.com</p></div></div><div class="pa l"><div class="pg l pc pd pe pa pf lb or"/></div></div></a></div><div class="oo op gp gr oq or"><a href="https://medium.com/codex/web-scraping-using-scrapy-and-python-7ad6d1cd63d0" rel="noopener follow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd jd gy z fp ow fr fs ox fu fw jc bi translated">使用Scrapy和Python进行Web抓取</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">收集网络数据的初学者友好指南</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">medium.com</p></div></div><div class="pa l"><div class="ph l pc pd pe pa pf lb or"/></div></div></a></div></div></div>    
</body>
</html>