<html>
<head>
<title>A Data Collection Guide For CSV, JSON, XML and SQL Formats From Websites and APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从网站和API收集CSV、JSON、XML和SQL格式数据的指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-data-extraction-python-review-of-json-xml-apis-sql-and-csv-formats-a5470afc27b6?source=collection_archive---------12-----------------------#2021-06-08">https://towardsdatascience.com/what-is-data-extraction-python-review-of-json-xml-apis-sql-and-csv-formats-a5470afc27b6?source=collection_archive---------12-----------------------#2021-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9222" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何为您的数据科学和机器学习投资组合收集不同格式数据集的指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7cc13a2eb8987d105101322e0fe46a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0Er16he6QY2euLtGAt6dA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1307227" rel="noopener ugc nofollow" target="_blank"> Gerd Altmann </a>从<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1307227" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</p></figure><p id="4a4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据收集和提取包括从不同来源提取数据，并将其转换为有用的格式，以便进一步处理或分析。它是数据工程过程中提取-转换-加载管道(<a class="ae ky" href="https://en.wikipedia.org/wiki/Extract,_transform,_load" rel="noopener ugc nofollow" target="_blank"> ETL </a>)的第一步。</p><p id="ed52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家，您可能需要组合多种文件格式的数据，如JSON、XML、CSV和SQL。</p><p id="ab6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将使用python库，如pandas、JSON和requests来读取不同来源的数据，并将它们作为pandas数据帧加载到Jupyter笔记本中。</p><h2 id="650d" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">1.CSV文件</h2><p id="067e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这指的是“逗号分隔值”文件，用于以表格格式存储数据，类似于电子表格。文件中的每一行都是一个观察(或记录)，每个记录都有一个或多个用逗号分隔的属性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/c87918b3080da62abd6379c3f8650bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swyq0GhJRoAM_gkLT2zJ3A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文本编辑器中csv文件的图像</p></figure><p id="7bca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，但不总是，第一行代表特性(列)名称。</p><p id="ad5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将从data.gov网站下载<a class="ae ky" href="https://catalog.data.gov/dataset/2006-2012-math-test-results-district-all-students" rel="noopener ugc nofollow" target="_blank">数学成绩数据</a>并保存在我们的工作目录中。推出新的Jupyter笔记本。</p><p id="408d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们从数据中创建熊猫数据帧之前，首先使用python的内置读取库来查看文件是很重要的。下面的代码显示了下载文件的前5行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="8404" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要注意的事项:</p><ul class=""><li id="c101" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">如果第一行包含列名，使用不带附加参数的<code class="fe nf ng nh ni b">pd.read_csv(file)</code>，这假定第一行包含列标题。如果没有，我们就用<code class="fe nf ng nh ni b">pd.read_csv(file, header=None)</code>。在这里，Pandas为您创建了索引列名，您可以稍后使用<code class="fe nf ng nh ni b">df.columns = &lt;list_of_names&gt;</code>添加名称。</li><li id="0d05" class="mw mx it lb b lc nj lf nk li nl lm nm lq nn lu nb nc nd ne bi translated">如果顶部有任何空行，我们需要使用<code class="fe nf ng nh ni b">pd.read_csv(file, skip_rows=n)</code>跳过它们。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/0cc81a53fa27c4bba06e9866d3383cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0BQh5IOgD7zZeusQ5KR-Q.png"/></div></div></figure><p id="6e95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码直接从网站下载文件<em class="np">并创建一个熊猫数据框架。</em></p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="c603" class="lv lw it ni b gy nu nv l nw nx">file_link = '<a class="ae ky" href="https://data.cityofnewyork.us/api/views/7yig-nj52/rows.csv'" rel="noopener ugc nofollow" target="_blank">https://data.cityofnewyork.us/api/views/7yig-nj52/rows.csv'</a><br/>df_csv = pd.read_csv(file_link)</span></pre><h2 id="7848" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">2.XML数据</h2><p id="5dcb" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">可扩展标记语言，简称XML，是一种与HTML非常相似的标记语言。您可以识别XML格式的数据，因为它是由特定于数据的唯一标签标记的，不像HTML的预定义标签。</p><p id="2922" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将继续使用来自data.gov网站的<a class="ae ky" href="https://catalog.data.gov/dataset/2006-2012-math-test-results-district-all-students" rel="noopener ugc nofollow" target="_blank">数学结果数据</a>，该网站提供了一个下载XML格式数据的选项。</p><p id="4f86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Jupyter笔记本中运行下面的代码将打印前20行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/734ff5f2142ec25ea0502be1717d7db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yC_wItF1xKLS5oC5l62F9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码编辑器上XML文件的图像</p></figure><p id="6305" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了提取XML数据，我们使用一个名为<a class="ae ky" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>的python库。要安装BeautifulSoup，请将下面的代码粘贴到Jupyter笔记本中。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="0b35" class="lv lw it ni b gy nu nv l nw nx">!pip install bs4</span></pre><p id="a153" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后导入库，打开文件并将其内容加载到BeautifulSoup中。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="b6ec" class="lv lw it ni b gy nu nv l nw nx">from bs4 import BeautifulSoup</span><span id="4ccc" class="lv lw it ni b gy nz nv l nw nx">with open("math results.xml") as f:<br/>    soup = BeautifulSoup(f, "lxml")</span></pre><p id="4988" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从收集的XML数据中，我们将使用BeautifulSoup的<code class="fe nf ng nh ni b">find_all()</code>方法，该方法将标签作为列表返回。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/915c23f8a3073b40bc57138075453040.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*2qevJxHnf52ldkdYGaWwMw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者查找全部的图片</p></figure><p id="07fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的例子，感兴趣的标签是<code class="fe nf ng nh ni b">‘district’, ‘grade’, ‘number_tested’, and ‘mean_scale_score’.</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="e16a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们将遍历这些行，对于每个标记，使用<code class="fe nf ng nh ni b">get_text</code>方法检索其中的值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="a715" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">名为“数据”的列表代表我们所有的记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/c2b32cc5696e4f014db3c9a62c81321d.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*AH8n0kkoKXhu4ehhYZesmg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者排列的前5条记录的图像</p></figure><p id="d0a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是创建一个pandas数据框架，并传递将用于数据的列。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="447b" class="lv lw it ni b gy nu nv l nw nx">df_xml = pd.DataFrame(data, columns=['district', 'grade','number_tested', 'mean_scale_score'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/81dbf1db49268572b0165e1cade0bc08.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*W-TwH40wA91zIrOTnpJP4g.png"/></div></figure><h2 id="1f2b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">3.JSON数据</h2><p id="22a0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">JavaScript Object Notation，或称<a class="ae ky" href="https://www.json.org/json-en.html" rel="noopener ugc nofollow" target="_blank"> JSON </a>，以字典风格的格式压缩数据。数学结果的JSON文件可以在<a class="ae ky" href="https://data.cityofnewyork.us/api/views/7yig-nj52/rows.json?accessType=DOWNLOAD" rel="noopener ugc nofollow" target="_blank">这个</a>链接中找到。下面是使用代码编辑器的文件截图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/eb1e4738cdb04d4b62c70a83ffd18afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*a0kgW3eoc8jJ5ui9yVtmyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的json文件截图</p></figure><p id="8b5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">JSON是在XML之后开发的，但是随着时间的推移，它变得越来越流行了。这两种格式经常用于通过web APIs发送数据，这将在下面的第5点中讨论。</p><p id="306b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas库提供了一种简单的方法来读取JSON文件；<code class="fe nf ng nh ni b">pd.read_json()</code>。您可以根据数据的格式传递<code class="fe nf ng nh ni b">‘orient’</code>选项。<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_json.html" rel="noopener ugc nofollow" target="_blank">熊猫文档</a>解释了<code class="fe nf ng nh ni b">‘orient’</code>选项。</p><p id="5dd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的JSON数据格式不同，<code class="fe nf ng nh ni b">pd.read_json()</code>返回一个错误。它有很多元信息；920行。实际数据从第921行开始。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/68b9f38cbc44af2e823bc45cded9bff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*N-q689u7pBVjVMBZT8TcCQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者json文件的折叠元和数据标签的图像</p></figure><p id="195a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图显示了使用<a class="ae ky" href="https://notepad-plus-plus.org/" rel="noopener ugc nofollow" target="_blank">记事本++ </a>代码编辑器的<strong class="lb iu">数据</strong>的截图。注意每行的前8个字段是没有用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/be9c376966a51152d6b5fa38b46d3017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W5di1IGQqFPnEXn9FdKzVg.png"/></div></div></figure><p id="450f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://docs.python.org/3/library/json.html" rel="noopener ugc nofollow" target="_blank"> json库</a>，它将json数据作为字典加载。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="230b" class="lv lw it ni b gy nu nv l nw nx">import json</span><span id="5289" class="lv lw it ni b gy nz nv l nw nx">with open('math results.json') as f:<br/>    json_data = json.load(f)</span><span id="86ff" class="lv lw it ni b gy nz nv l nw nx">type(json_data)<br/>###dict</span></pre><p id="97df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，将有两个字典条目；元数据和数据。因此，我们可以使用<code class="fe nf ng nh ni b">dict.get(key).</code>获得<strong class="lb iu">数据</strong>信息</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="b0cd" class="lv lw it ni b gy nu nv l nw nx">data = json_data.get('data')<br/>data = [x[8:] for x in data]</span></pre><p id="fe50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图显示了我们的数据列表。右图使用<a class="ae ky" rel="noopener" target="_blank" href="/a-gentle-introduction-to-flow-control-loops-and-list-comprehensions-for-beginners-3dbaabd7cd8a">列表理解</a>只返回每个列表中第8个元素的项目。</p><div class="kj kk kl km gt ab cb"><figure class="og kn oh oi oj ok ol paragraph-image"><img src="../Images/62c23cfae7015d127cdb11e05183bed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*sQdR_dQyd_ke72-Q-5rK9Q.png"/></figure><figure class="og kn om oi oj ok ol paragraph-image"><img src="../Images/1d5f224cff825804247eddf1f276e062.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*Cyo7d_LllEvryc8CKlg2DA.png"/></figure></div><p id="42e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是创建一个熊猫数据框架。根据我们对数据集的了解，我们将把列名作为参数传递。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/281c4fa1edca2d65eff02bca19960cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YK2l3WmoKhxAno6bMOg5_A.png"/></div></div></figure><h2 id="a0ec" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">4.SQL数据库</h2><p id="cf1b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">结构化查询语言，或SQL，使我们能够访问和操作数据库。您可以使用Pandas库从SQL文件和数据库中收集数据。这是通过打开数据库或运行SQL查询实现的。</p><p id="744e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据数据库的类型，可以使用两个python库来建立连接；<a class="ae ky" href="https://docs.python.org/3/library/sqlite3.html" rel="noopener ugc nofollow" target="_blank"> sqlite3 </a>库或<a class="ae ky" href="https://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"> sqlalchemy </a>库。</p><p id="ce9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们有一个<a class="ae ky" href="https://www.sqlite.org/index.html" rel="noopener ugc nofollow" target="_blank"> SQLite </a>数据库文件，其中包含我们一直在处理的数学结果。SQLite为个人应用和设备提供本地数据存储。点击阅读更多关于何时使用SQLite <a class="ae ky" href="https://www.sqlite.org/whentouse.html" rel="noopener ugc nofollow" target="_blank">的信息。因此，我们将使用<strong class="lb iu"> sqlite3库</strong>。数据库文件只有一个表。</a></p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="c53d" class="lv lw it ni b gy nu nv l nw nx">import sqlite3<br/>import pandas as pd</span><span id="79ba" class="lv lw it ni b gy nz nv l nw nx"># connect to the database<br/>conn = sqlite3.connect('maths_results.db')</span><span id="f568" class="lv lw it ni b gy nz nv l nw nx"># run a query<br/>data_sql = pd.read_sql('SELECT * FROM maths_results', conn)</span><span id="ddb7" class="lv lw it ni b gy nz nv l nw nx"># display 5 rows<br/>data_sql.head()</span></pre><p id="d963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用大型<em class="np">客户端/服务器</em> SQL数据库如MySQL和PostgreSQL时，使用<strong class="lb iu"> sqlalchemy库</strong>。查看<a class="ae ky" href="https://docs.sqlalchemy.org/en/14/core/engines.html" rel="noopener ugc nofollow" target="_blank"> SQLAlchemy文档</a>，了解如何加载不同的数据库<a class="ae ky" href="https://docs.sqlalchemy.org/en/14/core/engines.html#sqlite" rel="noopener ugc nofollow" target="_blank">，包括我们将使用以下代码实现的SQLite </a>。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="8758" class="lv lw it ni b gy nu nv l nw nx">import pandas as pd<br/>from sqlalchemy import create_engine</span><span id="66ed" class="lv lw it ni b gy nz nv l nw nx">#create a db engine<br/>engine = create_engine('sqlite:///maths_results.db')</span><span id="3aa9" class="lv lw it ni b gy nz nv l nw nx">#run query<br/>df_sql = pd.read_sql("SELECT * FROM maths_results", engine)</span></pre><h2 id="0d61" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">5.使用API从web中提取数据</h2><p id="af81" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">应用编程接口，或称API，为脸书、威特、谷歌等公司提供了一种与用户共享数据的方式。这阻碍了构成法律灰色地带的网络抓取。</p><p id="8c95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些公司提供面向公众的API的网址，开发者可以从这些网址访问数据，并将其用于分析或创建自己的应用程序。有些在发送请求时需要登录凭证，而有些则是公开的。它们还提供了如何格式化URL请求的文档。</p><p id="9021" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本节中，我们将从<a class="ae ky" href="https://datacatalog.worldbank.org/" rel="noopener ugc nofollow" target="_blank">世界银行</a>数据目录中提取数据。该网站不需要登录凭据。API文档可在<a class="ae ky" href="https://datahelpdesk.worldbank.org/knowledgebase/articles/898581-api-basic-call-structure" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="eb11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://datacatalog.worldbank.org/search/indicators" rel="noopener ugc nofollow" target="_blank">该</a>页面有一个指示器列表，带有使用API下载的选项。我们将关注“女性企业主的数量”,它显示了每个国家每年的结果。</p><p id="f2ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">向下滚动到您想要的指标数据，然后单击“API”访问选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/15ab823b32b22867c352e9341a008530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luiVGqUCWF4zNJ7ckIoLEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图来自<a class="ae ky" href="https://datacatalog.worldbank.org/search/indicators" rel="noopener ugc nofollow" target="_blank">世界银行</a>目录</p></figure><p id="0dc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把您重定向到一个包含原始JSON数据的新网页。从地址栏复制网址，打开一个新的Jupyter笔记本。编写下面的代码，并用复制的文本替换<code class="fe nf ng nh ni b">url</code>文本。</p><p id="5596" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python有一个<a class="ae ky" href="https://pypi.org/project/requests/" rel="noopener ugc nofollow" target="_blank">请求库</a>，用于使用python发送HTTP请求。下面的代码返回一个响应对象。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="640c" class="lv lw it ni b gy nu nv l nw nx">import requests<br/>import pandas as pd</span><span id="02df" class="lv lw it ni b gy nz nv l nw nx">url = '<a class="ae ky" href="https://api.worldbank.org/v2/en/country/all/indicator/IC.WEF.LLCO.FE?format=json&amp;per_page=20000&amp;source=14'" rel="noopener ugc nofollow" target="_blank">https://api.worldbank.org/v2/en/country/all/indicator/IC.WEF.LLCO.FE?format=json&amp;per_page=20000&amp;source=14'</a></span><span id="adeb" class="lv lw it ni b gy nz nv l nw nx">r = requests.get(url)</span></pre><p id="fc50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于数据是JSON格式的，我们将调用<code class="fe nf ng nh ni b">response.json()</code>返回提取的JSON数据。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="35bc" class="lv lw it ni b gy nu nv l nw nx">r.json()</span></pre><p id="f9ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回一个包含两个字典部分的列表。第一部分包含元信息。第二部分保存实际数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/aad9ce2ae4b231e3ac1bf26658ecccbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Y9IrNIczqKIHP-6iFMwpqg.png"/></div></figure><p id="6e12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建数据框，请使用list[1]来索引列表的第二个元素。</p><pre class="kj kk kl km gt nq ni nr ns aw nt bi"><span id="06bb" class="lv lw it ni b gy nu nv l nw nx">data_api = pd.DataFrame(r.json()[1])</span><span id="7da3" class="lv lw it ni b gy nz nv l nw nx">data_api.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/7499f610539c765d2391f391d0883ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O57glQpe9SElAEz0uW80eg.png"/></div></div></figure></div><div class="ab cl or os hx ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="im in io ip iq"><h2 id="82c0" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">结论</h2><p id="afed" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在这篇文章中，我们探索了数据收集，并提取了5种不同格式的数据，将其加载到熊猫的数据框中。完整的代码可以在Github的这里<a class="ae ky" href="https://github.com/suemnjeri/medium-articles/blob/main/data%20extraction/Data%20extraction%20for%20medium.ipynb" rel="noopener ugc nofollow" target="_blank">找到。</a></p><p id="1337" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于希望提取和分析真实世界数据集的数据科学家来说，收集数据的技能非常有价值。提取后的下一步是<a class="ae ky" href="https://www.stitchdata.com/resources/data-transformation/" rel="noopener ugc nofollow" target="_blank">将数据转换</a>为结构化和有组织的格式。</p><p id="687e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的资源列出了可用于项目的公共数据集。</p><ul class=""><li id="3462" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><a class="ae ky" href="https://github.com/awesomedata/awesome-public-datasets" rel="noopener ugc nofollow" target="_blank">Github上令人惊叹的公共数据集列表</a></li><li id="08e9" class="mw mx it lb b lc nj lf nk li nl lm nm lq nn lu nb nc nd ne bi translated"><a class="ae ky" href="https://www.quora.com/Where-can-I-find-large-datasets-open-to-the-public" rel="noopener ugc nofollow" target="_blank">一个Quora问题</a></li><li id="fe6e" class="mw mx it lb b lc nj lf nk li nl lm nm lq nn lu nb nc nd ne bi translated">elite data science的这篇<a class="ae ky" href="https://elitedatascience.com/datasets" rel="noopener ugc nofollow" target="_blank">博客文章</a></li></ul></div></div>    
</body>
</html>