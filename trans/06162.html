<html>
<head>
<title>Building an Artificial Neural Network in One Line of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用一行代码构建一个人工神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-an-artificial-neural-network-in-one-line-of-code-9addc414c5e9?source=collection_archive---------17-----------------------#2021-06-02">https://towardsdatascience.com/building-an-artificial-neural-network-in-one-line-of-code-9addc414c5e9?source=collection_archive---------17-----------------------#2021-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4725" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">TensorFlow 2最简单的神经网络</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/bb3bf84ecae85e69d7adc7134fdbd219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*pj58UJEa3eRyf-3c502N6w.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由维基媒体上的<a class="ae ku" href="https://commons.wikimedia.org/w/index.php?search=Artificial+neural+network&amp;title=Special:MediaSearch&amp;go=Go&amp;type=image" rel="noopener ugc nofollow" target="_blank"> mikemacmarketing </a>提供</p></figure><p id="02d9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">关于人工神经网络的解剖和数学有大量的理论文章，所以我将采用另一种方法来撰写和教授这个主题。在这篇文章中，我们要马上动手了！</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="8da4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们直接开始吧。如果您想跳过安装部分，可以选择下面的部分。</p><p id="341c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><a class="ae ku" href="#f418" rel="noopener ugc nofollow">安装</a> <br/> ∘ <a class="ae ku" href="#4078" rel="noopener ugc nofollow">选项1 </a> <br/> ∘ <a class="ae ku" href="#d671" rel="noopener ugc nofollow">选项2 </a> <br/> <a class="ae ku" href="#7b19" rel="noopener ugc nofollow">数据</a> <br/> <a class="ae ku" href="#1566" rel="noopener ugc nofollow">模型</a> <br/> <a class="ae ku" href="#e664" rel="noopener ugc nofollow">为什么要TensorFlow？</a></p><h1 id="f418" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">装置</h1><blockquote class="mq mr ms"><p id="0337" class="kv kw mt kx b ky kz ju la lb lc jx ld mu lf lg lh mv lj lk ll mw ln lo lp lq im bi translated">如果您已经安装了需求，那么您可以跳过这一节。</p></blockquote><h2 id="4078" class="mx lz it bd ma my mz dn me na nb dp mi le nc nd mk li ne nf mm lm ng nh mo ni bi translated">选项1</h2><p id="6441" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">我们需要做的第一件事是确保我们已经安装了Python编程语言，如果你还没有，那么就在这里<a class="ae ku" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">安装它</a>。</p><p id="ed43" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">请注意，如果在安装过程中询问您是否要将Python添加到PATH变量中，请务必同意。接下来要做的是打开终端或CMD，这取决于您的操作系统。</p><p id="24f3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果您使用的是windows，请按Windows按钮并键入“cmd”。然后双击结果顶部显示“命令提示符”的黑色图标。</p><p id="cda6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在只需输入:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="979e" class="mx lz it np b gy nt nu l nv nw">pip install numpy<br/>pip install matplotlib</span></pre><p id="e865" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">和</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="12fb" class="mx lz it np b gy nt nu l nv nw">pip install tensorflow</span></pre><p id="619a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">请注意，如果您在Mac或Linux上，您可能必须键入“pip3”而不是“pip”。</p><p id="6635" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">接下来你需要做的就是打开某种文本编辑器或IDE，比如nodepad、Pycharm、VSCode、Sublime或其他编辑器。</p><h2 id="d671" class="mx lz it bd ma my mz dn me na nb dp mi le nc nd mk li ne nf mm lm ng nh mo ni bi translated">选项2</h2><p id="6c53" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">在你的谷歌硬盘中安装谷歌的合作实验室。你可以在网站上获得这样做所需的所有信息。</p><div class="nx ny gp gr nz oa"><a href="https://colab.research.google.com/notebooks/intro.ipynb#recent=true" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">谷歌联合实验室</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">编辑描述</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">colab.research.google.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ko oa"/></div></div></a></div><p id="0d1c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Google Colab的一个好处是你可以免费使用大量的计算能力。具体来说，你可以在云中的GPU上训练你的模型，这使得它成为一个很好的研究框架。</p><h1 id="7b19" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">数据</h1><p id="465a" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">当我们训练有监督的机器学习算法时，我们需要标记的数据。也就是说，我们需要一个数据集，其中对于每个示例<strong class="kx iu"> <em class="mt"> x </em> </strong>我们需要一个标签<strong class="kx iu"> <em class="mt"> y </em> </strong>，模型应该预测它何时被馈送<strong class="kx iu"> <em class="mt"> x </em> </strong>。</p><p id="444c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在本文中，我们将尽可能做最简单的事情。我们不会考虑测试，所以这是关于最佳实践的<strong class="kx iu">而不是</strong>！我们将简单地考虑一种线性关系，并通过在谷歌的机器学习库<strong class="kx iu"> TensorFlow </strong>中建立一个只有一个神经元的神经网络来尝试拟合该模型。</p><p id="a4f5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们打开我们选择的编辑器，输入</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="33c1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这段代码确保加载了所有相关的库。对于某些x ≥ 0的情况，您可能希望TensorFlow的版本是2.x，所以尝试一个简单的</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="b71a" class="mx lz it np b gy nt nu l nv nw">print(tf.__version__)</span></pre><p id="6f46" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">您应该会看到类似2.5.0的内容。</p><p id="fef5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们创建数据。我们将创建自己的数据。简单地像这样自己创造一个线性关系。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="7c4a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">作为一个聪明的人，你可能已经注意到了这个模式。</p><blockquote class="mq mr ms"><p id="6f04" class="kv kw mt kx b ky kz ju la lb lc jx ld mu lf lg lh mv lj lk ll mw ln lo lp lq im bi translated">如果你猜对了<em class="it"> f(x) = 1/2 + x/2 </em>，你就猜对了。</p></blockquote><h1 id="1566" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">模型</h1><p id="3d62" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">想法是这样的:我们将显示来自<strong class="kx iu"> xs </strong>数组的网络值，并以<strong class="kx iu"> <em class="mt"> ys </em> </strong>数组的形式告诉模型正确的答案，以便对于x的每个值，模型将做出猜测，并通过查看真实的对应y值来纠正自己。</p><p id="3620" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">然后，该模型将通过称为反向传播的东西来调整自己(我们将使用<strong class="kx iu">随机梯度下降</strong>)，并且对于每个示例，该模型将会改进。</p><p id="d68d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们没有太多的数据，所以这当然会限制模型的准确性，但本文的唯一目标是捕捉神经网络的思想，并了解张量流的一些简单语法。</p><p id="898c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们将在一行代码中创建单个节点的人工神经网络，即:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="0aed" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们已经建立了网络，让我们来训练它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="a309" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">优化器确保网络改进其猜测，并且损失函数测量单个猜测的好坏。</p><p id="eb0f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们来做个预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="652d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们大约得到了<strong class="kx iu"> 4.12 </strong>。现在让我们策划一些预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="9fbd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们得到的输出是下图，绿色显示地面实况，红色显示模型预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/65e200b32ecd612c44aca171644855f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*gBQZcP6x8797mdP1-BaqfA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="daaa" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">请注意，这是<strong class="kx iu">而不是</strong>线性回归，因为这与“最佳拟合”没有任何关系，而是每次尝试都试图自我修正的模型的结果。数据的缺乏和模型的简单很能说明问题，但我们仍然设法在这个简单的任务中捕捉到了神经网络的本质。</p><p id="777a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了充分理解这一点，请尝试再次运行此代码。你不会得到完全相同的预测，因为这是一个新模型，而机器学习模型本质上是概率性的。</p><p id="b9cf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例如，当我第二次运行它时，当我给模型输入数字7时，我得到了一个新的预测。我大概弄了<strong class="kx iu"> 4.08 </strong>。你会得到与我不同的东西！</p><p id="052d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">您可以尝试使用这段代码来熟悉(hyper)参数的语法和效果。</p><p id="f84d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例如，尝试将纪元设置为200或1000。试试其他线性关系。</p><h1 id="e664" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">为什么是TensorFlow？</h1><p id="fea4" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">如果你想学习如何建立机器学习模型，TensorFlow是一个非常好的选择，有几个原因。</p><p id="4628" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">TensorFlow是当今最受欢迎的深度学习框架之一。</p><p id="16f8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">它是一个非常成熟的库，因为它是由Google构建的，并且它可以与Python一起使用，这是两个重要的原因，但是我们为什么不看看一些使用它的公司，感受一下它在行业中的重要性。</p><p id="db1b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">使用TensorFlow的公司包括</p><ul class=""><li id="05e7" class="os ot it kx b ky kz lb lc le ou li ov lm ow lq ox oy oz pa bi translated">爱彼迎（美国短租平台）</li><li id="eefe" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">空中巴士</li><li id="8182" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">可口可乐</li><li id="c779" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">谷歌</li><li id="762b" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">美国英特尔公司(财富500强公司之一ˌ以生产CPU芯片著称)</li><li id="279f" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">联想（电脑的品牌名）</li><li id="9ccb" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">贝宝</li><li id="b815" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">Spotify</li><li id="5862" class="os ot it kx b ky pb lb pc le pd li pe lm pf lq ox oy oz pa bi translated">推特</li></ul><p id="b972" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这样的例子不胜枚举…</p><p id="a091" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">所以TensorFlow将会一直存在，如果你想在未来成为一名数据科学家或ML工程师，有很多公司会雇佣TensorFlow开发人员，所以学习这个伟大的框架绝对值得你花时间。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="6a07" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们到了这个关于张量流和神经网络的小而简单的介绍的结尾。</p><p id="25c6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在未来，我会发布越来越多的高级机器学习帖子，但我们需要从简单开始。</p><p id="2c4b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果您有任何问题、意见或顾虑，请联系LinkedIn。</p><div class="nx ny gp gr nz oa"><a href="https://www.linkedin.com/in/kasper-m%C3%BCller-96ba95169/" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">Kasper Müller -高级顾问，数据和分析，金融服务，技术咨询- EY | LinkedIn</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">编程、数学和教学是我最大的兴趣。数据科学、机器学习和…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">www.linkedin.com</p></div></div><div class="oj l"><div class="pg l ol om on oj oo ko oa"/></div></div></a></div><p id="fef9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">下次见。</p></div></div>    
</body>
</html>