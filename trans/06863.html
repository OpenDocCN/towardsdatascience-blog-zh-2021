<html>
<head>
<title>How to use Q-Q plot for checking the distribution of our data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Q-Q图检查数据的分布</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-q-q-plot-for-checking-the-distribution-of-our-data-c798d0577369?source=collection_archive---------28-----------------------#2021-06-21">https://towardsdatascience.com/how-to-use-q-q-plot-for-checking-the-distribution-of-our-data-c798d0577369?source=collection_archive---------28-----------------------#2021-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1a3f078ba262e5f0f775d0e145153f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hOQx_2F5gAe9aQpB.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="178e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">数据科学家通常需要检查他们的数据集的统计数据，特别是针对已知的分布或与其他数据集进行比较。我们可以为此目标运行几个假设测试，但我通常更喜欢使用简单的图形表示。我说的是Q-Q情节。</p><h1 id="edf4" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">什么是Q-Q情节？</h1><p id="9c3b" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">Q-Q图通常被称为分位数图。这是一个2D图，我们在其中将分布的理论分位数与数据集的样本分位数进行比较。如果数据集是根据该分布生成的，我们预计该图表将接近45度线，因为样本分位数将与理论分位数相似。如果样本是从不同的分布中生成的，我们就不会得到45线。</p><p id="61f3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">通过这种方式，我们可以很容易地想象数据集是否类似于理论分布。我们甚至可以使用Q-Q图来比较两个数据集，只要它们具有相同的点数。</p><h1 id="1a6a" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">Python中的一个例子</h1><p id="c0bf" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">现在让我们看看Python中的Q-Q plot是如何工作的。你可以在我的<a class="ae mg" href="https://github.com/gianlucamalato/machinelearning/blob/master/QQ_plot.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>上找到完整的代码。</p><p id="df57" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">首先，让我们导入一些库，并设置随机数种子，以使我们的模拟可重复。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="feba" class="mq le it mm b gy mr ms l mt mu">from statsmodels.graphics.gofplots import qqplot <br/>from matplotlib import pyplot as plt </span><span id="f39c" class="mq le it mm b gy mv ms l mt mu">plt.rcParams['figure.figsize'] = [10, 7] <br/>plt.rc('font', size=14) <br/>from scipy.stats import norm, uniform <br/>import numpy as np <br/>np.random.seed(0)</span></pre><p id="4f57" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，让我们模拟0和1之间的1000个均匀分布的点，并将该数据集与具有相同均值和方差的正态分布进行比较。我们期望得到一个与45度线非常不同的Q-Q图，因为这两个分布非常不同。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="e14f" class="mq le it mm b gy mr ms l mt mu">x = np.random.uniform(1,2,1000)</span></pre><p id="00ff" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了根据最佳拟合正态分布绘制该数据集的Q-Q图，我们可以编写以下代码:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="78b9" class="mq le it mm b gy mr ms l mt mu">qqplot(x,norm,fit=True,line="45") <br/>plt.show()</span></pre><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/8ef5c6d332ec5bc2e77502e8f8a76f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aBKPdcz6L5XB-9nt.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="27fb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="mx"> fit=True </em>参数试图根据最大似然来拟合数据集的正态分布。正如我们所见，样本分位数与理论分位数有很大不同，因为蓝点离红线非常远，红线是45度线。</p><p id="31b9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在让我们尝试使用正态分布的数据集。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="f814" class="mq le it mm b gy mr ms l mt mu">x = np.random.normal(1,2,1000) <br/>qqplot(x,norm,fit=True,line="45") <br/>plt.show()</span></pre><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ea5a7397725aada5f319fb04d546be9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4TMfwf7c_HoFZ3hY.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="2f46" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在结果大不一样了。样本分位数与理论分位数非常相似(即蓝色点靠近红线)。有一些异常值会在此图表的下限和上限产生一些噪音，但这不是一个大问题，因为样本分布的最大部分与理论值非常吻合。</p><p id="4c9f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">当然，改变<em class="mx"> qqplot </em>函数的第二个参数，我们可以将我们的样本数据集与另一个分布进行比较。例如，我们可以将正态分布的数据集与均匀分布的数据集进行比较。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="96f9" class="mq le it mm b gy mr ms l mt mu">qqplot(x,uniform,fit=True,line="45") <br/>plt.show()</span></pre><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/5d5272d8b4f4e8bc41aee653f67844fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fEprirnF7KmY1SQq.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="8825" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">正如预期的那样，结果不太好，因为生成数据集的分布与最佳拟合的均匀分布非常不同。</p><h1 id="19d2" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">两个数据集的Q-Q图</h1><p id="5dbf" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">Q-Q图甚至可以用于2个数据集，只要它们具有相同的点数。为了获得两个数据集的样本分位数，我们只需对它们进行升序排序并绘制它们。</p><p id="84c7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们从两个正态分布生成两个正态分布数据集，具有相同的均值和相同的方差。</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="1654" class="mq le it mm b gy mr ms l mt mu">x1 = np.random.normal(1,2,1000) <br/>x2 = np.random.normal(1,2,1000)</span></pre><p id="bc7f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在我们可以对数据进行排序:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="d747" class="mq le it mm b gy mr ms l mt mu">x1.sort() <br/>x2.sort()</span></pre><p id="51a9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后我们可以画出来:</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="047e" class="mq le it mm b gy mr ms l mt mu">plt.scatter(x1,x2) <br/>plt.plot([min(x1),max(x1)],[min(x1),max(x1)],color="red") <br/>plt.xlabel("1st dataset's quantiles") <br/>plt.ylabel("2nd dataset's quantiles") <br/>plt.show()</span></pre><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/2575b323a996e3f19c3e0ece093a08c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LzvCrriDMxbv8U2n.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="c9a4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如我们所见，尾部仍有一些噪声，但分布的中心部分匹配得相当好。</p><h1 id="9847" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">结论</h1><p id="137d" class="pw-post-body-paragraph kf kg it kh b ki mb kk kl km mc ko kp kq md ks kt ku me kw kx ky mf la lb lc im bi translated">在本文中，我展示了如何使用Q-Q图来检查样本分布和理论分布之间或两个样本之间的相似性。尽管可以执行一些假设检验来实现这一目标(例如Kolmogorov-Smirnov检验)，但我更喜欢使用数据可视化，以便对我们的数据集中的现象进行可视化表示。这样，我们的解释不会受到任何假设检验的影响，甚至对非技术人员来说也更加清晰。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><p id="a2ce" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="mx">原载于2021年6月21日</em><a class="ae mg" href="https://www.yourdatateacher.com/2021/06/21/how-to-use-q-q-plot-for-checking-the-distribution-of-our-data/" rel="noopener ugc nofollow" target="_blank"><em class="mx">【https://www.yourdatateacher.com】</em></a><em class="mx">。</em></p></div></div>    
</body>
</html>