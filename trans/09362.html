<html>
<head>
<title>Gantt charts with Python’s Matplotlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python的Matplotlib制作甘特图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gantt-charts-with-pythons-matplotlib-395b7af72d72?source=collection_archive---------2-----------------------#2021-08-31">https://towardsdatascience.com/gantt-charts-with-pythons-matplotlib-395b7af72d72?source=collection_archive---------2-----------------------#2021-08-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed6e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python可视化项目进度指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b7375b8aafd48bad1a35d55742223795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYRX5DdY3SA_GIO84JN6nw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b0eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种可视化已经有100多年的历史，对于项目管理来说仍然非常有用。</p><p id="868c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">亨利·甘特最初创建了用于分析已完成项目的图表。更具体地说，他设计了这种可视化方法来衡量生产率和识别表现不佳的员工。随着时间的推移，它变成了一个计划和跟踪的工具，一旦项目结束，它就被抛弃了。</p><p id="6595" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不可否认的是，自最初设计以来，甘特图已经发生了很大的变化。分析师引入了许多编码来显示部门、任务完成度、依赖性、截止日期等之间的区别。</p><p id="68e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文将探讨如何使用Python、Pandas和Matplotlib创建甘特图。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="7cda" class="mb mc it bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">亲自动手</h2><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="1323" class="mb mc it mv b gy mz na l nb nc">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span></pre><p id="f397" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我们需要一些虚拟数据；我们将使用的数据集包含任务名称、部门、开始和结束日期以及完成时间等列。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="52a9" class="mb mc it mv b gy mz na l nb nc">df = pd.read_excel('../data/plan.xlsx')<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/cee0a7135d5e222a7212b46b37f34425.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*ty2Avcj6noOdfNqjpkHRiQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="05da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使我们的绘图更容易，我们需要获得一些措施。</p><p id="1ffd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将从项目开始日期的变量开始。</p><p id="ed27" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们将添加一列从项目开始到每个任务开始的天数；这将有助于在x轴上定位条形。</p><p id="c399" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">任务结束时也是如此；这有助于计算完成任务所需的总天数、条形图的长度，并有助于稍后定位文本。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="361a" class="mb mc it mv b gy mz na l nb nc"># project start date<br/>proj_start = df.Start.min()</span><span id="5b39" class="mb mc it mv b gy ne na l nb nc"># number of days from project start to task start<br/>df['start_num'] = (df.Start-proj_start).dt.days</span><span id="04e0" class="mb mc it mv b gy ne na l nb nc"># number of days from project start to end of tasks<br/>df['end_num'] = (df.End-proj_start).dt.days</span><span id="0224" class="mb mc it mv b gy ne na l nb nc"># days between start and end of each task<br/>df['days_start_to_end'] = df.end_num - df.start_num</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/b1dd188609c68d73b36e36ce1c9978b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBGSvyK4jqiPYvKosvxeBg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3504" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以绘制一个条形图。y将是任务名称，宽度是任务开始和结束之间的天数，左边是项目开始到任务开始之间的天数。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="d4a5" class="mb mc it mv b gy mz na l nb nc">fig, ax = plt.subplots(1, figsize=(16,6))</span><span id="591f" class="mb mc it mv b gy ne na l nb nc">ax.barh(df.Task, df.days_start_to_end, left=df.start_num)</span><span id="7e97" class="mb mc it mv b gy ne na l nb nc">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/410902c49f1281a87b137ec8141fcd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFj0C3gFqCQXpeX0BmbLZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c935" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">酷，我们有最简单的甘特图。</p><p id="581d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以添加许多细节来使我们的图表更有洞察力。我们将从最基本的开始，一个带有日期和颜色的适当的x轴来区分各个部门。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="8b0a" class="mb mc it mv b gy mz na l nb nc"># create a column with the color for each department<br/>def color(row):<br/>    c_dict = {'MKT':'#E64646', 'FIN':'#E69646', 'ENG':'#34D05C', 'PROD':'#34D0C3', 'IT':'#3475D0'}<br/>    return c_dict[row['Department']]</span><span id="fe39" class="mb mc it mv b gy ne na l nb nc">df['color'] = df.apply(color, axis=1)</span></pre><p id="6b34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于x轴，我们将每三天添加一个标签，我们还将为每一天添加一个小刻度。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="9d9c" class="mb mc it mv b gy mz na l nb nc"><strong class="mv iu">from matplotlib.patches import Patch</strong></span><span id="9b68" class="mb mc it mv b gy ne na l nb nc">fig, ax = plt.subplots(1, figsize=(16,6))</span><span id="cd8d" class="mb mc it mv b gy ne na l nb nc">ax.barh(df.Task, df.days_start_to_end, left=df.start_num, <strong class="mv iu">color=df.color</strong>)</span><span id="ae28" class="mb mc it mv b gy ne na l nb nc"><strong class="mv iu">##### LEGENDS #####</strong><br/>c_dict = {'MKT':'#E64646', 'FIN':'#E69646', 'ENG':'#34D05C',<br/>          'PROD':'#34D0C3', 'IT':'#3475D0'}<br/>legend_elements = [Patch(facecolor=c_dict[i], label=i)  for i in c_dict]</span><span id="e89e" class="mb mc it mv b gy ne na l nb nc">plt.legend(handles=legend_elements)</span><span id="bb25" class="mb mc it mv b gy ne na l nb nc"><strong class="mv iu">##### TICKS #####</strong><br/>xticks = np.arange(0, df.end_num.max()+1, 3)<br/>xticks_labels = pd.date_range(proj_start, end=df.End.max()).strftime("%m/%d")<br/>xticks_minor = np.arange(0, df.end_num.max()+1, 1)</span><span id="3d34" class="mb mc it mv b gy ne na l nb nc">ax.set_xticks(xticks)<br/>ax.set_xticks(xticks_minor, minor=True)<br/>ax.set_xticklabels(xticks_labels[::3])</span><span id="7975" class="mb mc it mv b gy ne na l nb nc">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/57768e0f173a905f23db23c85d4542e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBkrDXk73KX-CJPDjmoDkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8319" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">太好了！这张图表比我们之前的版本更有洞察力。</p><p id="b5c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们将项目的完整性编码到我们的可视化中。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="8702" class="mb mc it mv b gy mz na l nb nc"># days between start and current progression of each task<br/>df['current_num'] = (df.days_start_to_end * df.Completion)</span></pre><p id="7e1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将向我们的绘图添加另一个条形，并使用我们刚刚创建的度量作为宽度。</p><p id="8a42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了提高精确度，我们将在条形的末尾写下完整度的百分比。为了区分完成的和未完成的，我们可以使用条形的alpha参数。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2291" class="mb mc it mv b gy mz na l nb nc">from matplotlib.patches import Patch</span><span id="5a6c" class="mb mc it mv b gy ne na l nb nc">fig, ax = plt.subplots(1, figsize=(16,6))</span><span id="4f29" class="mb mc it mv b gy ne na l nb nc"># bars<br/><strong class="mv iu">ax.barh(df.Task, df.current_num, left=df.start_num, color=df.color)</strong><br/>ax.barh(df.Task, df.days_start_to_end, left=df.start_num, color=df.color, <strong class="mv iu">alpha=0.5</strong>)</span><span id="aa7e" class="mb mc it mv b gy ne na l nb nc"># texts<br/><strong class="mv iu">for idx, row in df.iterrows():<br/>    ax.text(row.end_num+0.1, idx, <br/>            f"{int(row.Completion*100)}%", <br/>            va='center', alpha=0.8)</strong></span><span id="dced" class="mb mc it mv b gy ne na l nb nc">##### LEGENDS #####<br/>c_dict = {'MKT':'#E64646', 'FIN':'#E69646', 'ENG':'#34D05C', 'PROD':'#34D0C3', 'IT':'#3475D0'}<br/>legend_elements = [Patch(facecolor=c_dict[i], label=i)  for i in c_dict]<br/>plt.legend(handles=legend_elements)</span><span id="991c" class="mb mc it mv b gy ne na l nb nc">##### TICKS #####<br/>xticks = np.arange(0, df.end_num.max()+1, 3)<br/>xticks_labels = pd.date_range(proj_start, end=df.End.max()).strftime("%m/%d")<br/>xticks_minor = np.arange(0, df.end_num.max()+1, 1)</span><span id="c04e" class="mb mc it mv b gy ne na l nb nc">ax.set_xticks(xticks)<br/>ax.set_xticks(xticks_minor, minor=True)<br/>ax.set_xticklabels(xticks_labels[::3])</span><span id="a05d" class="mb mc it mv b gy ne na l nb nc">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/4c43345c81263886eaed437046290e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*twfu6HoE46VSYyiUGulgNg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="dba2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样！</p><p id="9f6b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以改进这种可视化，使其更具吸引力，用另一个轴添加更多信息，绘制网格线，添加标题，等等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/0a4fd49b34fc6a861ab7ef973b68f746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VUVLP3O2MEGiCRjUKvLFnA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae nk" href="https://gist.github.com/Thiagobc23/ad0f228dd8a6b1c9a9e148f17de5b4b0" rel="noopener ugc nofollow" target="_blank">代号</a> —图片由作者提供</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/548e533011a80101a4c1237dcd59a188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bFhDQ2JDK4RBinDkdsuURQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae nk" href="https://gist.github.com/Thiagobc23/fc12c3c69fbb90ac64b594f2c3641fcf" rel="noopener ugc nofollow" target="_blank">代号</a> —图片由作者提供</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="3898" class="mb mc it bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">结论</h2><p id="ffe8" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">总的来说，这是可视化项目的一种极好的方式，尽管它可能不适合大多数当前的项目管理方法。</p><p id="e9ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">甘特图在某种意义上是灵活的，它们可以有许多功能。</p><p id="58d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以分解任务、跟踪绩效指标、依赖性、里程碑、截止日期等等。通过更多的编码、工具提示、向下钻取和文本，可以很容易地向甘特图添加更多的信息。</p><p id="1af5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有这些信息很容易使我们的图表难以理解，甚至更难维护。</p><p id="2e1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用敏捷方法，计划是不断变化的。花那么多时间收集和维护这些信息来跟进一个项目需要太多的资源，而且往往会适得其反。</p><p id="c4d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">综上所述，它们擅长可视化已完成的项目，比流程图、表格或看板/ Scrum板更有洞察力，尤其是在审查单个过程或项目时。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="a284" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读我的文章！— <a class="ae nk" href="https://linktr.ee/thiagobc23" rel="noopener ugc nofollow" target="_blank">在这里</a>你可以找到更多Python dataviz教程。</p></div></div>    
</body>
</html>