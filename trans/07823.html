<html>
<head>
<title>Partial Least Squares</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">偏最小二乘法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/partial-least-squares-f4e6714452a?source=collection_archive---------1-----------------------#2021-07-18">https://towardsdatascience.com/partial-least-squares-f4e6714452a?source=collection_archive---------1-----------------------#2021-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c0fa" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="2e86" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">深入探讨偏最小二乘回归和偏最小二乘判别分析，并提供R和Python中的完整示例</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/364a07566c02b26a3bcb2f165e13a4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qjhqslw7Szboh77-oGfCxQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法——应用于橄榄油和肉类的例子——由<a class="ae lh" href="https://unsplash.com/@calumlewis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Calum Lewis </a>在<a class="ae lh" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="acd7" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘法</h1><p id="a04f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在本文中，您将发现关于偏最小二乘您需要知道的一切。顾名思义，偏最小二乘法与普通最小二乘法相关:拟合线性回归的标准数学方法。</p><h2 id="0598" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">抗多重共线性的偏最小二乘</h2><p id="357c" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">线性回归的目标是模拟一个因变量(目标变量)和多个自变量(解释变量)之间的依赖关系。普通的最小二乘法非常适合这种情况，只要你满足线性回归的假设。</p><p id="663a" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在某些领域中，您的模型中可能会有许多独立变量，其中许多变量与其他独立变量相关。如果发生这种情况，如果你使用OLS，你会遇到麻烦:你会有多重共线性，因此违反了线性回归的<a class="ae lh" rel="noopener" target="_blank" href="/assumptions-of-linear-regression-fdb71ebeaa8b">假设。</a></p><p id="aafc" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">偏最小二乘法是这种情况的解决方案:它允许您减少相关变量的维度，并对这些变量的潜在共享信息进行建模(在因变量和自变量中)。</p><h2 id="bced" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">多元结果的偏最小二乘法</h2><p id="22c8" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">偏最小二乘法的第二大优势是它是一种可以模拟多个结果变量的方法。许多统计和机器学习模型不能直接处理多个结果变量。</p><p id="5e3c" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">通常可以为这些模型找到解决方案。例如，为每个变量建立一个模型。然而，特别是对于分析用例，将所有东西都放在一个模型中是非常重要的，因为一个多变量模型的解释将不同于许多单变量模型的解释。</p><h1 id="0e18" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘法与其他模型</h1><p id="c7db" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">您已经看到了使用偏最小二乘法的两个主要原因:有多个因变量和许多相关(独立)变量。</p><p id="6537" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">还有其他方法可以解决这些问题。在深入了解偏最小二乘法的细节之前，让我们先来看几个相互竞争的方法。</p><h2 id="cf62" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">偏最小二乘法与多元多元回归</h2><p id="4b2a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">多元多元回归是多元回归的多元对应物:它对多个自变量进行建模，以解释多个因变量。</p><p id="f619" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">虽然多元多重回归在许多情况下工作良好，但它不能处理多重共线性。如果数据集有许多相关的预测变量，则需要进行偏最小二乘回归。</p><h2 id="bd4c" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">偏最小二乘法与主成分回归</h2><p id="3826" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">主成分回归是一种回归方法，提出了一种替代解决方案，具有许多相关的独立变量。在将独立变量输入普通最小二乘模型之前，PCR对独立变量应用<a class="ae lh" rel="noopener" target="_blank" href="/what-is-the-difference-between-pca-and-factor-analysis-5362ef6fa6f9">主成分分析</a>。</p><p id="e152" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">PCR可以分两步完成，先进行PCA，然后进行线性回归，但也有同时完成这两步的实现。</p><p id="8d4d" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">偏最小二乘法和主成分回归的区别在于，主成分回归在降维的同时更注重方差。另一方面，偏最小二乘侧重于协方差，同时降低维数。</p><p id="8cc2" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在偏最小二乘法中，自变量的已识别分量被定义为与因变量的已识别分量相关。在主成分回归中，在不考虑因变量的情况下创建成分。</p><p id="cd7b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">当目标是找到因变量和自变量之间的依赖关系时，偏最小二乘法在这里具有优势。</p><h2 id="ba47" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">偏最小二乘法与典型相关分析</h2><p id="9920" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/canonical-correlation-analysis-b1a38847219d">典型相关分析</a>是一种专注于研究两个数据集之间相关性的统计方法。这是通过在两个数据集上减少维度并找到具有最大相关量的成分对来获得的。</p><p id="9671" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">偏最小二乘法和典型相关分析之间的思想是相当可比的。这两种方法的主要区别在于，偏最小二乘法侧重于协方差，而典型相关分析侧重于相关性。</p><h1 id="edb6" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">PLS模型</h1><p id="36c4" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在我们已经看到了使用偏最小二乘法的一般原因，让我们来更详细地了解一下。</p><p id="5557" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在偏最小二乘法中，有子类别，关于PLS的文献充满了<strong class="mc jd">令人困惑的术语和类别</strong>。在开始一个示例的实现之前，让我们试着澄清一些你在学习PLS时会遇到的术语，并给出一个不同PLS模型的<strong class="mc jd">列表</strong>。</p><h2 id="3482" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">偏最小二乘回归</h2><p id="2e49" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">绝对最常见的偏最小二乘模型是偏最小二乘回归，或PLS回归。偏最小二乘回归是PLS模型家族中其他模型的基础。由于它是一个回归模型，当你的<strong class="mc jd">因变量是数字</strong>时，它适用。</p><h2 id="77b9" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">偏最小二乘判别分析</h2><p id="4415" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">当您的<strong class="mc jd">因变量是分类变量</strong>时，可以使用偏最小二乘判别分析，或PLS-DA。判别分析是一种分类算法，PLS-DA增加了降维部分。</p><h2 id="c60e" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">PLS1与PLS2</h2><p id="244f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在一些文献和软件实现中，对PLS1和PLS2进行了区分。在这种情况下，PLS1指的是仅具有<strong class="mc jd">一个因变量</strong>的偏最小二乘模型，而PLS2指的是具有<strong class="mc jd">多个因变量</strong>的模型。</p><h2 id="3163" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">SIMPLS vs NIPALS</h2><p id="be97" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">SIMPLS和NIPALS是做PLS的两种方法。SIMPLS是作为早期版本NIPALS的更快和“更简单”的替代方案而发明的。当执行PLS时，这可能并不重要，因为两种方法的结果会非常接近。然而，如果你可以选择的话，最好还是选择更现代的简约风格。</p><h2 id="8e8b" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">KernelPLS</h2><p id="9461" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">如前所述，偏最小二乘法是普通最小二乘法(线性回归)的一种变体。正因为如此，偏最小二乘法不能应用于非线性问题。核PLS解决了这个问题，使得偏最小二乘可用于非线性问题。核PLS拟合高维空间中输入和输出变量之间的关系，使得输入数据集可以被认为是线性的。</p><h2 id="dc27" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">OPLS</h2><p id="6412" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">OPLS是潜在结构正交投影的缩写，是偏最小二乘法的一种改进。OPLS承诺<strong class="mc jd">更容易解读</strong>。PLS仅将变异性分为系统变异性和噪声变异性，而OPLS则更进一步，将系统变异性分为预测变异性和正交变异性。</p><p id="2036" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">对OPLS也有一些批评，因为众所周知这两种方法都获得了<strong class="mc jd">相同的预测性能</strong>(如果不能产生更好的性能，我们可以认为这不是“真正的”改进)，其次，<strong class="mc jd">传统PLS </strong>更快。</p><p id="2dd6" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">对于本文的其余部分，我们将坚持使用传统的PLS，因为它执行起来更简单，性能也一样好。</p><h2 id="901f" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">SPLS</h2><p id="1e81" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">SPLS是稀疏偏最小二乘的缩写，是偏最小二乘模型的一种变体。如前所述，PLS的目标是进行降维:将大量相关变量减少到更少的分量中。</p><p id="a433" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">SPLS的目标不仅仅是降维。此外，它还适用于<strong class="mc jd">变量选择</strong>。SPLS使用著名的<strong class="mc jd">套索惩罚</strong>在X和Y数据集中进行变量选择，目的是获得更容易解释的成分。</p><h2 id="bd4f" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">左旋偏最小二乘法</h2><p id="c220" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">L-PLS是PLS的一个提议变体，可以应用于一些特定的用例。该方法由Martens等人在2005年提出:</p><blockquote class="nm nn no"><p id="eaf3" class="ma mb np mc b md nh kd mf mg ni kg mi nq nj ml mm nr nk mp mq ns nl mt mu mv im bi translated">描述了一种新的方法，用于根据关于矩阵X中给出的Y中的行和矩阵Z中给出的Y中的列的附加信息来提取和可视化数据矩阵Y中的结构。X(I × K)和Z(J × L)不共享矩阵尺寸维度，但通过Y(I × J)相连。</p></blockquote><p id="57b8" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">正如他们在文章中所描述的，L-PLS背后的思想是对同一个回归问题使用三个数据集，以便在行和列上有额外的数据。他们将这种情况描述为具有L形式的数据，这由L-PLS中的L表示。</p><p id="3593" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">这种方法<strong class="mc jd">非常有创意</strong>，当然也有它的使用案例。不幸的是,<strong class="mc jd">在流行的统计库中缺乏实现</strong>,而且它的应用非常特殊，这使得它在实践中还没有被广泛使用。</p><h1 id="093c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘回归示例</h1><p id="876b" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在本例中，我们将使用肉类数据集。应该数据集发布者的要求，以下是数据附带的官方声明:</p><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="f4ed" class="mw lj it nu b gy ny nz l oa ob"><em class="np">Fat, water and protein content of meat samples</em><br/><em class="np">"These data are recorded on a Tecator Infratec Food and Feed Analyzer working in the wavelength range 850 - 1050 nm by the Near Infrared Transmission (NIT) principle. Each sample contains finely chopped pure meat with different moisture, fat and protein contents.</em><br/><br/><em class="np">If results from these data are used in a publication we want you to mention the instrument and company name (Tecator) in the publication.  In addition, please send a preprint of your article to Karin Thente, Tecator AB, Box 70, S-263 21 Hoganas, Sweden</em><br/><br/><em class="np">The data are available in the public domain with no responsibility from the original data source. The data can be redistributed as long as this permission note is attached."</em><br/><br/><em class="np">"For each meat sample the data consists of a 100 channel spectrum of</em><br/><em class="np">absorbances and the contents of moisture (water), fat and protein. The absorbance is -log10 of the transmittance measured by the spectrometer. The three contents, measured in percent, are determined by analytic chemistry." Included here are the traning, monitoring and test sets.</em></span></pre><p id="23a2" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">肉类数据的目标是对肉类进行100次自动近红外测量，并使用它们来预测肉类的水分、脂肪和蛋白质含量。这个例子有多种理由使用偏最小二乘法:</p><ul class=""><li id="2f4e" class="oc od it mc b md nh mg ni mj oe mn of mr og mv oh oi oj ok bi translated">它有许多可以相互关联的独立变量。至少它们是非常不可解释的，这是对它们进行降维的好例子。</li><li id="a76c" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">有多个因变量，它们之间也可能有一些相关性。</li></ul><p id="5382" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">这种模型的目标是能够直接从化学计量测量中推断出肉类的脂肪、水分和蛋白质含量。因此，基本上理想的目标是让您能够避免耗时的测量工作，只需将您的肉放入扫描仪，即可获得估计的脂肪、水分和蛋白质含量。</p><p id="ac7e" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">与大多数偏最小二乘法的化学计量学用例一样，该用例主要关注于获得最佳性能。对模型的分析和解释是次要的。稍后我们将看到第二个例子，其中解释是核心，而不是预测性能。</p><p id="9c89" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在为预测性能建立模型时，用不同的模型进行模型基准测试总是很重要的。你可以参考这个<a class="ae lh" rel="noopener" target="_blank" href="/beginner-guide-to-build-compare-and-evaluate-machine-learning-models-in-under-10-minutes-19a6781830de">机器学习入门指南</a>来了解如何进行这样的基准测试设置，或者查看这篇关于<a class="ae lh" rel="noopener" target="_blank" href="/gridsearch-the-ultimate-machine-learning-tool-6cd5fb93d07">网格搜索的文章:一个调整模型的好方法</a>。</p><h1 id="5aa1" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘回归R</h1><p id="54e8" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">首先，让我们导入r中的数据。这些数据存在于<code class="fe oq or os nu b">modeldata</code>库中，因此您可以使用下面的代码来导入数据:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-导入数据</p></figure><p id="bcc3" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">数据如下所示:100列具有化学计量学测量值，三列提供水、脂肪和蛋白质含量的测量值:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/0971ac8ce20a57718edd4b7af424c028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44ssJ8x2r0xDoM3FgPrO5g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—肉类数据</p></figure><p id="f6e9" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">如前所述，我们将尝试建立一个PLS回归模型，该模型可以从100次测量中预测水、脂肪和蛋白质含量。为了做到这一点，我们希望确定获得样本外的预测性能，而不是解释样本内的最大差异。</p><p id="40bf" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">为此，我们将数据分成三个数据集:</p><ul class=""><li id="9d75" class="oc od it mc b md nh mg ni mj oe mn of mr og mv oh oi oj ok bi translated">用于训练模型的训练数据</li><li id="f91c" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">用于调整模型的验证数据</li><li id="da20" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">对样本外误差进行最终估计的测试数据</li></ul><p id="96a1" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">通常，最好对数据进行随机分割。但是，为了使示例更容易理解，您可以对数据进行非随机分割，如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-分割数据</p></figure><p id="ae5b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">下一步是拟合一个完整的模型。也就是说，具有最大数量组件的模型:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-拟合模型</p></figure><p id="02da" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在我们有了最复杂的模型，我们将使用它来确定应该使用多少个组件来获得最佳预测性能:这是一个重要的决定。</p><p id="4adf" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">我们首先要看的是每个分量和每个因变量的预测均方根误差图。在这个R函数中，使用了内置的留一交叉验证函数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="dc86" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">您将获得以下三个图，以显示预测误差(与预测性能相反)在组件数量非常少的模型中最高，然后逐渐降低，当模型组件过多时，它们再次具有高误差。</p><p id="68bc" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">最佳值应该在15到20之间。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/321396702b1a2e8ad8185e233d515a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-AFFwEuBLpBFMsQjplo2g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—组件数量</p></figure><p id="2cee" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">为了更好地理解当组件更多或更少时会发生什么，我们可以查看下图。它显示了每个变量的回归系数(每个变量对应一个波长)。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—回归系数</p></figure><p id="38a6" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">该图清楚地表明，我们使用的组件越多，模式就变得越难:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/f322f68f7bc0bafcb9f7a5237424d275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Qez3H26A09Qn7uXrcyAkQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—系数图</p></figure><p id="0a23" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">相比之下，包含15个组件的模式要复杂得多:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—拟合15组分模型</p></figure><p id="e5ae" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">从下图中可以看出这种复杂性，因为系数要极端得多(有些低得多，有些高得多):</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/a1d63af1090efd13f751b6ab305d7dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BJz_b9VCzfKhEg5lJQJc4w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-15组分模型的回归系数</p></figure><p id="8f59" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，这些图表可以很好地获得最佳组件数量的估计值。然而，获得一个固定的数字作为输出要实际得多。<a class="ae lh" rel="noopener" target="_blank" href="/gridsearch-the-ultimate-machine-learning-tool-6cd5fb93d07">网格搜索</a>是一个工具，允许您搜索数值网格以获得最佳预测性能。它通常用于调整ML模型的超参数，我们将在这里使用它来调整<code class="fe oq or os nu b">ncomp</code>超参数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法——网格搜索最佳ncomp</p></figure><p id="c16b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">这就为一个<strong class="mc jd"> 19的<code class="fe oq or os nu b">best_ncomp</code>获得了一个<strong class="mc jd"> 0.9483937的<code class="fe oq or os nu b">best_r2</code>。根据网格搜索，这意味着具有19个成分的PLS回归模型是预测肉类水分、脂肪和蛋白质含量的最佳模型。</strong></strong></p><p id="ecfe" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">作为最后的检查，让我们使用下面的代码来验证我们是否也在测试数据集上获得了好的分数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-检查测试数据的R2</p></figure><p id="bbbe" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">最佳模型获得预测平均R2分数<strong class="mc jd"> 0.9726439。</strong>我们现在已经成功调整了PLS回归模型，用于预测水、脂肪和蛋白质含量。如果这种误差幅度对于肉类测量所需的精度来说是可以接受的，我们可以用自动化的化学计量学测量来代替手工测量。然后，我们可以使用PLS回归模型将这些自动测量值转换为水、脂肪和蛋白质含量的估计值。</p><h1 id="67d7" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘回归Python</h1><p id="847e" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">对于那些喜欢Python的人来说，在继续讨论分类数据示例之前，让我们也用Python实现一下。</p><p id="a293" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在Python中，您可以从我的S3存储桶中导入肉类数据，我在那里存储了来自r的数据的副本。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-导入数据</p></figure><p id="200b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">Python中的数据如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/8a06b8e7c377dd5c91f25d1414b572e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Or-3arqngg0gukU9WjP3iA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法Python中的数据</p></figure><p id="2da4" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">要获得与R中相同的训练、验证和测试数据的非随机分割，可以使用下面的代码。如果你不介意结果略有不同，你也可以使用scikitlearn的<code class="fe oq or os nu b">train_test_split</code>函数进行随机抽样。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-在训练、验证和测试中分割数据</p></figure><p id="064e" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，完整的模型可以估计如下:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-估计模型</p></figure><p id="c064" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">就像我们在R中做的一样，您需要调整组件的数量。预测误差作为部件数量的函数的曲线图可以如下创建:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—绘制预测误差与ncomp的函数关系</p></figure><p id="6724" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">它将为您提供以下图表，这些图表显示了15到20个组件的最佳数量。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c4248cd29cfc3aa5a10b02edd64ad23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*iGwDKN5CnT9V9kWw7fwNbQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-绘制组件数量</p></figure><p id="1449" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，可视化不同数量组件的结果差异会很好。由于模型中有100个系数，数字数据很难查看。下图显示了图中的系数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—系数图</p></figure><p id="30c1" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">对于三个因变量(水、脂肪、蛋白质)和成分数量(1 =蓝色，2 =橙色，3 =绿色)，该图从左到右如下所示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/aa82c41c446c2c4e16acbb1714262fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*4BVaNwIiIrOrOaTk6WZf1A.png"/></div></figure><p id="ae66" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">您可以看到，随着更多组件的加入，模型变得更加复杂，就像我们看到的R代码一样。</p><p id="b785" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，让我们继续进行网格搜索，寻找元件数量<code class="fe oq or os nu b">n_comp</code>的最佳值。我们为<code class="fe oq or os nu b">n_comp</code>的每个可能值计算验证数据的R2分数，如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="c604" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">我们可以获得的最佳R2是R2分数<strong class="mc jd">为0.9431952353094432 </strong>，ncomp值为<strong class="mc jd"> 15。</strong></p><p id="cff9" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">作为对我们模型的最后验证，让我们验证我们是否在测试数据集上获得了可比较的分数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="0b10" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">得到的R2分数为<strong class="mc jd"> 0.95628 </strong>，甚至略高于验证误差。我们可以确信模型不会过度拟合，并且我们已经找到了合适数量的组件来制作一个高性能的模型。</p><p id="5a69" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">如果这种误差对于肉类测试来说是可接受的，我们就可以放心地用自动化化学计量学测量结合PLS回归来代替手动测量水分、脂肪和蛋白质。然后，PLS回归将化学计量学测量值转化为水、脂肪和蛋白质含量的估计值。</p><h1 id="b8f7" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘判别分析实例</h1><p id="8ddb" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">对于第二个例子，我们将做<strong class="mc jd">一个解释性模型:一个专注于理解和解释组件</strong>而不是获得预测性能的模型。</p><p id="496c" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">该数据是橄榄油的数据集。目的是看看我们能否根据化学测量和感官测量来预测原产国。这个模型将让我们了解如何根据化学和感官测量来区分不同国家的橄榄油。</p><p id="4458" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">因变量(原产国)是分类的，这使得它成为判别分析的一个很好的例子，因为这是分类模型家族中的一种方法。</p><h1 id="53c6" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘鉴别分析</h1><p id="8a4b" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在R中，只要导入pls库，就可以获得橄榄油数据集。您可以这样做:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-橄榄油数据</p></figure><p id="b70f" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">数据如下所示。它包含两个矩阵:具有5个化学测量变量的化学矩阵和具有6个感官测量变量的感官矩阵:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/9e9fcf4247f675c331672f4bb19f5249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*Po6IJ_1fuVyYXF2sXTT1Zw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-橄榄油数据</p></figure><p id="45a4" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">当然，这种数据格式对于我们的用例来说并不理想，所以我们需要将两个矩阵的数据帧做成仅仅一个矩阵。您可以这样做:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-根据橄榄油数据制作一个矩阵</p></figure><p id="04a7" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">生成的矩阵如下所示。如您所见，它自动包含列名:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pb"><img src="../Images/63171a1b05478a014a769e76421ee8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4tnD5N7MH1REL2qg_B6EQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—正确的橄榄油数据格式</p></figure><p id="92cf" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">国家是行名的第一个字母(G代表希腊，I代表意大利，S代表西班牙)。这里有一个简单的方法来创建Y数据作为因子。因子是r中的分类数据变量。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-创建国家变量</p></figure><p id="7e68" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，我们来看看模型。我们将使用插入符号库来拟合模型。Caret是一个很棒的库，包含了很多机器学习模型和很多模型开发工具。如果你对caret感兴趣，你可以看看这篇文章，它比较了R的caret和Python的scikit-learn。</p><p id="1fab" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">您可以使用caret中的PLSDA函数来拟合模型，如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="dfac" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">下一步是获得双标图，这样我们可以解释组件的含义，同时分析个体的位置。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="1085" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">为了解释双绘图，你需要看方向。为了理解这意味着什么，试着从图的中间画一条假想的线到每个标签。假想线之间的角度使两个物体接近。与中间的距离决定了重量的强弱。</p><p id="c5e1" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated"><em class="np">提示:你可以快速向下滚动到Python biplot来更好地理解假想线的概念！</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/47dcb3193d75252e5cdc07c6bd382bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhiqLcCAUh962tJ8G1GfqQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法—双标图</p></figure><h2 id="5be8" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">解释偏最小二乘双图</h2><p id="7dec" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">当将偏最小二乘法用于解释性用例时，可以从双标图中得出很多结论。为了使事情简单，我们有时会考虑两个以上的维度，但是从第三维度开始，事情会很快变得复杂。这里我们坚持二维。</p><ol class=""><li id="b736" class="oc od it mc b md nh mg ni mj oe mn of mr og mv pc oi oj ok bi translated"><strong class="mc jd">解读第一维度</strong></li></ol><p id="600a" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">我们通常问自己的第一个问题是关于第一维的含义和解释。我们可以通过观察与第一维度密切相关的变量(图上的红色标签)来定义这一点。为了看到这些，我们可以把一个变量放在最左边(比较1的低分)和一个变量放在最右边(比较1的高分)。</p><p id="cc55" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在我们的例子中，第一个组件从左边的<strong class="mc jd">绿色</strong>到右边的<strong class="mc jd">黄色</strong>。显然，<strong class="mc jd">绿色和黄色的分界在橄榄油中很重要！</strong></p><p id="ec58" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">为了证实这一点，我们现在来看看个人是否有趋势(图中黑色标签)。我们在左边看到很多希腊油画，而在右边我们看到很多西班牙油画。这意味着黄色和绿色橄榄油的区别让我们能够区分希腊和西班牙的橄榄油！</p><p id="efcc" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">就变量而言，一个有趣的见解是，橄榄油中从黄色到绿色似乎有一个非常明显的颜色梯度，而棕色不是由第一维度表示的。</p><p id="5fbc" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated"><strong class="mc jd"> 2。解读二次元</strong></p><p id="6ff9" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在，让我们看看我们能从二次元中学到什么。首先，我们来找一些有代表性的变量。要做到这一点，我们需要找到在维度2上得分非常高或非常低的变量。</p><p id="f030" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">我们可以看到，dimension 2从底部的棕色到顶部的光滑透明。显然，<strong class="mc jd">橄榄油有一个重要的梯度，一端是棕色的油，另一端是光滑透明的油</strong>。</p><p id="bf2a" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">为了获得关于国家的知识，让我们看看个体是如何沿着维度2的轴分布的。这种分离没有维度1中的明显。然而，当我们仔细观察时，我们可以清楚地看到<strong class="mc jd">意大利橄榄油通常比其他油更棕色。</strong> <strong class="mc jd">非意大利橄榄油一般也比其他油更有光泽和透明度。</strong></p><p id="b95b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">就变量而言，一个有趣的见解是，从棕色到另一种颜色没有渐变，而是从一侧的棕色到另一侧的光泽和透明。当然，在现实中，橄榄油专家会合作进行这样的研究来帮助解释这些发现。</p><p id="efcb" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated"><strong class="mc jd"> 3。主要组件中变量类型的解释</strong></p><p id="4432" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">我们在这里看到的是被模型定义为最重要的维度。我们可以注意到，最重要的成分大多存在于感觉成分中。这意味着<strong class="mc jd">感官特征似乎可以很好地检测橄榄油的来源国。</strong>这也是一门很有意思的学问！</p><h1 id="c143" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">偏最小二乘判别分析Python</h1><p id="40a6" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">橄榄油数据集内置在R PLS库中。我在我的S3桶上放了一个副本，让它也可以很容易地用Python导入。(如果您想在其他地方分发此数据集，请查看更高一级数据集的通知)。</p><p id="966c" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">您可以使用以下代码将数据导入Python:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法Python中的橄榄油数据</p></figure><p id="c0bf" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">数据是这样的。我添加了国家作为变量，而在原始的R数据集中却不是这样。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pd"><img src="../Images/e7167c1ae8078cfbf74068078e377d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t2Y7fr3Er9ep2rts_4Uu3A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-橄榄油数据</p></figure><p id="a3b8" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">Python中的PLS判别分析实际上是通过对转换成哑元的分类变量进行PLS回归来完成的。虚拟变量将分类变量转换为具有1和0值的每个类别的变量:如果行属于该类别，则为1，否则为0。</p><p id="fd89" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">进行虚拟编码是因为0和1在许多机器学习模型中更容易使用，并且一组虚拟变量包含与原始变量完全相同的信息。</p><p id="5f85" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">在现代机器学习的行话中，创建虚拟人也被称为一热编码。</p><p id="ce6b" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">您可以使用熊猫创建假人，如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-创建虚拟数据</p></figure><p id="f2b8" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">数据现在将包含三个国家变量:每个国家一个。如果该行属于该国家，则值为1，否则为0:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/3e992acf33a5fcbfa173501b2d75d997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QkhOrPUwcG4v4Z19ezK-6g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-虚拟编码国家</p></figure><p id="8792" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">下一步是将数据分割成X数据框和Y数据框，因为这是Python中PLS模型所要求的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-在X和Y方向分割数据</p></figure><p id="cfe5" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">现在我们来看看模型。我们将使用scikitlearn包中的PLSRegression。我们可以直接用两个分量来拟合它，以给出与我们在R示例中所做的相同的解释。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">偏最小二乘法-拟合偏最小二乘法模型</p></figure><p id="a355" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">Python中多元统计的难点往往是图的创建。在下面的代码块中，创建了一个双绘图。它是逐步编码的:</p><ul class=""><li id="2d1c" class="oc od it mc b md nh mg ni mj oe mn of mr og mv oh oi oj ok bi translated">首先我们获得分数。分数代表每种橄榄油在每个维度上的得分。分数将允许我们绘制双标图中的个体。</li><li id="09eb" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">我们需要将分数标准化，以使它们与加载值在同一个图上。</li><li id="4986" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">然后我们得到载荷。载荷包含每个部件上每个变量的权重。它们将允许我们在双图上绘制变量。</li><li id="9c19" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">然后，我们循环遍历每个个体和每个变量，并为它们绘制一个箭头和一个标签。维度1得分或载荷将成为图上的x坐标，维度2得分或载荷将成为图上的y坐标。</li></ul><p id="1e43" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">代码如下所示:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ot ou l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的偏最小二乘法-双标图</p></figure><p id="51dd" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">生成的双绘图如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/62d8b6f580dd82877f686f2506761810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lirnLDdfSm7YiJFlXoQuJQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Python中的偏最小二乘法-双标图</p></figure><h2 id="d7c9" class="mw lj it bd lk mx my dn lo mz na dp ls mj nb nc lu mn nd ne lw mr nf ng ly iz bi translated">结论</h2><p id="23af" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">双标图的R解释将给出与Python双标图相同的发现。快速回顾一下调查结果:</p><ul class=""><li id="2eb2" class="oc od it mc b md nh mg ni mj oe mn of mr og mv oh oi oj ok bi translated">维度1 (x轴)的一边是绿色，另一边是黄色。因此区分黄色和绿色的油是很重要的。</li><li id="95b7" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">在绿色的一边，有很多希腊的油画，在黄色的一边，有很多西班牙的油画。绿色/黄色分离允许区分希腊和西班牙橄榄油。</li><li id="0335" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">尺寸2 (y轴_一侧为棕色，另一侧为光滑透明。很明显，棕色的油和光滑透明的油是有区别的，但两者不能同时存在。</li><li id="31d2" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">意大利的油画倾向于棕色，而西班牙和希腊的油画倾向于光泽和透明。</li></ul><h1 id="ed02" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">关键要点</h1><p id="3646" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在本文中，您首先看到了偏最小二乘法的(许多)变体的概述。此外，您已经看到了使用偏最小二乘法的两种方法的深入解释和实现:</p><ul class=""><li id="b3f6" class="oc od it mc b md nh mg ni mj oe mn of mr og mv oh oi oj ok bi translated">偏最小二乘法作为机器学习算法，用于肉类示例中的<strong class="mc jd">预测性能</strong></li><li id="bc8c" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">橄榄油示例中<strong class="mc jd">解释</strong>的偏最小二乘法</li></ul><p id="1b29" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">您还看到了如何对不同类型的因变量使用偏最小二乘法:</p><ul class=""><li id="4603" class="oc od it mc b md nh mg ni mj oe mn of mr og mv oh oi oj ok bi translated">肉类用例中<strong class="mc jd">数字因变量</strong>的偏最小二乘<strong class="mc jd">回归</strong></li><li id="90ca" class="oc od it mc b md ol mg om mj on mn oo mr op mv oh oi oj ok bi translated">橄榄油用例中<strong class="mc jd">分类因变量</strong>的偏最小二乘法<strong class="mc jd">判别分析</strong></li></ul><p id="f1ae" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated">通过在两个例子中使用R和Python实现，您现在有了在自己的用例中应用偏最小二乘法所需的资源！</p><p id="75ae" class="pw-post-body-paragraph ma mb it mc b md nh kd mf mg ni kg mi mj nj ml mm mn nk mp mq mr nl mt mu mv im bi translated"><em class="np">现在，感谢您的阅读，请继续关注更多数学、统计和数据科学内容！</em></p></div></div>    
</body>
</html>