<html>
<head>
<title>Analysis of Car Sales with ANOVA in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">汽车销售的方差分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analysis-of-car-sales-with-anova-in-r-a62546d8fa41?source=collection_archive---------20-----------------------#2021-09-09">https://towardsdatascience.com/analysis-of-car-sales-with-anova-in-r-a62546d8fa41?source=collection_archive---------20-----------------------#2021-09-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="615a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">确定各组之间的销售差异</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5a288cda6fd33fbbdd1d5316d2184eec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0cIF3NIlswegQvLZe8teg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:照片由<a class="ae ky" href="https://pixabay.com/users/oskaline-11884/" rel="noopener ugc nofollow" target="_blank">奥斯卡琳</a>拍摄，来自<a class="ae ky" href="https://pixabay.com/photos/car-vehicle-sports-car-auto-63930/" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a></p></figure><p id="7246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用ANOVA(方差分析)模型的主要目的是确定组间均值是否存在差异。</p><p id="4221" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然t检验能够确定两个均值之间是否存在差异，但如果存在几个组，则需要进行更广泛的检验。</p><p id="ba7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，我们将了解如何实现ANOVA模型来分析汽车销售数据。</p><h1 id="7fd4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">背景</h1><p id="0cfe" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该分析是在<a class="ae ky" href="https://www.kaggle.com/gagandeep16/car-sales" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的汽车销售数据集上进行的。</p><p id="0875" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该分析的目的是确定基于<strong class="lb iu">车型</strong>和<strong class="lb iu">原产国</strong>的汽车组之间的发动机尺寸、马力和燃油效率等因素是否不同。</p><p id="f7dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当只使用一个分类变量时，使用单向ANOVA来确定影响。</p><p id="480b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">双向方差分析用于确定跨多个类别的影响(也称为因子方差分析),以及是否存在<strong class="lb iu">交互影响</strong>,即因素对因变量的<a class="ae ky" href="https://pages.uoregon.edu/stevensj/interaction.pdf" rel="noopener ugc nofollow" target="_blank">综合影响</a>,而不是单独考虑它们。</p><p id="8a59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是数据集的概述:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/e988041b188da6ebde0ede9b0c72c339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KEqXreTHP3j4zFbNx3yldQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:RStudio输出</p></figure><p id="253b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，对于制造商列，数据集中提供了50个不同的类别(或因子)。为了减少因素的数量，增加了称为<strong class="lb iu">国家</strong>的第二个因素，制造商根据其原产国进行分组。例如，奥迪和大众生产的所有汽车都被归为德国制造，而现代和丰田生产的所有汽车都被归为日本制造，等等。</p><h1 id="ba6b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">单向方差分析</h1><p id="de33" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如前所述，在这种情况下，将使用单向方差分析来确定以下变量在车辆类型和制造商所在国家之间是否存在显著的平均值差异:</p><ul class=""><li id="ace3" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">功率性能因数</li><li id="9276" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">发动机尺寸</li><li id="a0ad" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">马力</li><li id="71d3" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">燃料容量</li><li id="72b8" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">燃料效率</li></ul><p id="4edb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们运行ANOVAs并分析结果。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="34cb" class="nm lw it ni b gy nn no l np nq">&gt; one.way &lt;- aov(Power_perf_factor ~ vehicle_type, data = mydata)<br/>&gt; summary(one.way)<br/>              Df Sum Sq Mean Sq F value Pr(&gt;F)<br/>vehicle_type   1      0     0.1       0   0.99<br/>Residuals    153  97352   636.3               <br/>2 observations deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Engine_size ~ vehicle_type, data = mydata)<br/>&gt; summary(one.way)<br/>              Df Sum Sq Mean Sq F value Pr(&gt;F)   <br/>vehicle_type   1  11.34  11.338   11.06 0.0011 **<br/>Residuals    154 157.81   1.025                  <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1<br/>1 observation deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Horsepower ~ vehicle_type, data = mydata)<br/>&gt; summary(one.way)<br/>              Df Sum Sq Mean Sq F value Pr(&gt;F)<br/>vehicle_type   1     11      11   0.003  0.954<br/>Residuals    154 498303    3236               <br/>1 observation deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Fuel_capacity ~ vehicle_type, data = mydata)<br/>&gt; summary(one.way)<br/>              Df Sum Sq Mean Sq F value Pr(&gt;F)    <br/>vehicle_type   1  836.4   836.4   85.49 &lt;2e-16 ***<br/>Residuals    154 1506.6     9.8                   <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1<br/>1 observation deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Fuel_efficiency ~ vehicle_type, data = mydata)<br/>&gt; summary(one.way)<br/>              Df Sum Sq Mean Sq F value   Pr(&gt;F)    <br/>vehicle_type   1    928   928.0    75.1 6.21e-15 ***<br/>Residuals    152   1878    12.4                     <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1<br/>3 observations deleted due to missingness</span></pre><p id="22fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，对于数据集中的车辆类型(指定为客车或轿车)，结果对于<strong class="lb iu">马力</strong>或<strong class="lb iu">功率性能系数</strong>并不重要，即这些变量的平均值并没有显示出统计上的显著差异，这取决于车辆是被分类为<strong class="lb iu">客车</strong>还是<strong class="lb iu">轿车</strong>。</p><p id="8ac2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们来看看这些变量的平均值是否因国家而异。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="7207" class="nm lw it ni b gy nn no l np nq">&gt; one.way &lt;- aov(Power_perf_factor ~ Country, data = mydata)<br/>&gt; summary(one.way)<br/>             Df Sum Sq Mean Sq F value Pr(&gt;F)<br/>Country       4   4851  1212.7   1.967  0.102<br/>Residuals   150  92501   616.7               <br/>2 observations deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Engine_size ~ Country, data = mydata)<br/>&gt; summary(one.way)<br/>             Df Sum Sq Mean Sq F value  Pr(&gt;F)   <br/>Country       4  14.56   3.641   3.556 0.00838 **<br/>Residuals   151 154.59   1.024                   <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1<br/>1 observation deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Horsepower ~ Country, data = mydata)<br/>&gt; summary(one.way)<br/>             Df Sum Sq Mean Sq F value Pr(&gt;F)<br/>Country       4  14798    3699   1.155  0.333<br/>Residuals   151 483516    3202               <br/>1 observation deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Fuel_capacity ~ Country, data = mydata)<br/>&gt; summary(one.way)<br/>             Df Sum Sq Mean Sq F value Pr(&gt;F)<br/>Country       4   10.7    2.67   0.173  0.952<br/>Residuals   151 2332.3   15.45               <br/>1 observation deleted due to missingness<br/><br/>&gt; one.way &lt;- aov(Fuel_efficiency ~ Country, data = mydata)<br/>&gt; summary(one.way)<br/>             Df Sum Sq Mean Sq F value Pr(&gt;F)<br/>Country       4   11.3   2.826   0.151  0.962<br/>Residuals   149 2795.0  18.758               <br/>3 observations deleted due to missingness</span></pre><p id="16a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，除了<strong class="lb iu">发动机尺寸</strong>之外，F统计的p值对于所有发动机尺寸来说都是不显著的，这意味着根据制造商的国家不同，平均发动机尺寸在统计上存在显著差异。</p><p id="c229" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得注意的是，使用ANOVA的一个限制是，测试将仅表明组间的平均差异是否具有统计显著性——它们不会特别揭示<strong class="lb iu">哪个</strong>组对平均差异负责。</p><p id="f0ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可能会观察到不同国家的平均发动机尺寸不同，但是ANOVA本身无法告诉我们与其他国家的车辆相比，哪个国家的制造商的平均发动机尺寸更大。</p><h1 id="b8cd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">双向方差分析</h1><p id="abfc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">此外，单向方差分析的局限性在于它不能检验交互作用的影响。例如，车辆类型和制造国家可能不会单独影响车辆的马力，但是当这两个因素结合在一起时呢？</p><p id="c227" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这方面，双向方差分析用于1)检验多个因素对因变量的影响，以及2)组合这些因素的影响，即交互作用的影响。</p><p id="f8cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我们将运行的四个模型(包括交互效应):</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="b4f0" class="nm lw it ni b gy nn no l np nq">model_1 = lm(Engine_size ~ vehicle_type + Country + vehicle_type*Country, data = mydata)</span><span id="8de3" class="nm lw it ni b gy nr no l np nq">model_2 = lm(Fuel_efficiency ~ vehicle_type + Country + vehicle_type*Country, data = mydata)</span><span id="b82b" class="nm lw it ni b gy nr no l np nq">model_3 = lm(Fuel_capacity ~ vehicle_type + Country + vehicle_type*Country, data = mydata)</span><span id="545a" class="nm lw it ni b gy nr no l np nq">model_4 = lm(Sales_in_thousands ~ vehicle_type + Country + vehicle_type*Country, data = mydata)</span></pre><p id="6604" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对四个模型中的每一个进行双向ANOVA测试:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="291d" class="nm lw it ni b gy nn no l np nq">library(car)<br/>Anova(model_1, type = "II")<br/>Anova(model_2, type = "II")<br/>Anova(model_3, type = "II")<br/>Anova(model_4, type = "II")</span></pre><p id="c017" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0187" class="nm lw it ni b gy nn no l np nq">&gt; Anova(model_1, type = "II")<br/>Note: model has aliased coefficients<br/>      sums of squares computed by model comparison<br/>Anova Table (Type II tests)</span><span id="e893" class="nm lw it ni b gy nr no l np nq">Response: Engine_size<br/>                      Sum Sq  Df F value   Pr(&gt;F)   <br/>vehicle_type          10.219   1 10.4870 0.001484 **<br/>Country               13.444   4  3.4492 0.009989 **<br/>vehicle_type:Country   0.159   2  0.0814 0.921836   <br/>Residuals            144.211 148                    <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="edd3" class="nm lw it ni b gy nr no l np nq">&gt; Anova(model_2, type = "II")<br/>Note: model has aliased coefficients<br/>      sums of squares computed by model comparison<br/>Anova Table (Type II tests)</span><span id="2fbc" class="nm lw it ni b gy nr no l np nq">Response: Fuel_efficiency<br/>                      Sum Sq  Df F value    Pr(&gt;F)    <br/>vehicle_type          997.09   1 81.5442 9.305e-16 ***<br/>Country                80.39   4  1.6436    0.1664    <br/>vehicle_type:Country   12.65   2  0.5171    0.5973    <br/>Residuals            1785.22 146                      <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="a16d" class="nm lw it ni b gy nr no l np nq"><br/>&gt; Anova(model_3, type = "II")<br/>Note: model has aliased coefficients<br/>      sums of squares computed by model comparison<br/>Anova Table (Type II tests)</span><span id="2d98" class="nm lw it ni b gy nr no l np nq">Response: Fuel_capacity<br/>                      Sum Sq  Df  F value    Pr(&gt;F)    <br/>vehicle_type          888.24   1 104.4075 &lt; 2.2e-16 ***<br/>Country                62.56   4   1.8383    0.1245    <br/>vehicle_type:Country  184.94   2  10.8693 3.941e-05 ***<br/>Residuals            1259.10 148                       <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="0fa5" class="nm lw it ni b gy nr no l np nq">&gt; Anova(model_4, type = "II")<br/>Note: model has aliased coefficients<br/>      sums of squares computed by model comparison<br/>Anova Table (Type II tests)</span><span id="3b5e" class="nm lw it ni b gy nr no l np nq">Response: Sales_in_thousands<br/>                     Sum Sq  Df F value   Pr(&gt;F)   <br/>vehicle_type          24865   1  6.3332 0.012909 * <br/>Country               49466   4  3.1497 0.016097 * <br/>vehicle_type:Country  45149   2  5.7497 0.003932 **<br/>Residuals            585007 149                    <br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></pre><p id="d404" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，对于车型<strong class="lb iu"> 4 </strong>，<strong class="lb iu">车型</strong>和<strong class="lb iu">国家</strong>之间的交互作用在统计上是显著的。</p><p id="22e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这表明销售价值受到车型和制造商所在国家的显著影响。而且，这两个变量也是相互作用的。</p><p id="fccd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">举一个假设的例子，我们可能会发现日本的乘用车销量较高，但德国的乘用车销量较低。换句话说，我们不能简单地得出结论，车辆类型和销售之间的关系在不同国家将保持不变——相互作用的存在表明它们可能不同。</p><p id="e1eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu"> sjPlot </strong> <a class="ae ky" href="https://cran.r-project.org/web/packages/sjPlot/vignettes/plot_interactions.html" rel="noopener ugc nofollow" target="_blank">库</a>，我们可以进一步查看交互效果。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="8002" class="nm lw it ni b gy nn no l np nq">library(sjPlot)<br/>plot_model(model_4, type = "pred", terms = c("vehicle_type", "Country"))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/486f3cd07928f30c68a0af97c50994d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*WM7FZJaAXOFpVRXmZGmWAA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:RStudio输出</p></figure><p id="ac3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，不同车型的销售价值差异很大。例如，在德国，汽车的销售范围要比乘用车大得多。</p><p id="f527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，日本的乘用车销售价格中值高于轿车。</p><h1 id="a77f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="10d4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">总之，我们已经看到了如何使用单因素和双因素方差分析来分析均值之间的差异，在这种情况下，使用的是汽车销售数据集。</p><p id="26b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还看了一下:</p><ul class=""><li id="9fd6" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">使用方差分析的局限性</li><li id="dcc3" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">如何使用双向方差分析来检验变量之间的交互作用</li><li id="6503" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">使用<strong class="lb iu"> sjPlot </strong>库在视觉上检查交互效果</li></ul><p id="6bf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的宝贵时间，非常感谢您的任何问题或反馈。你也可以在michael-grogan.com的<a class="ae ky" href="https://www.michael-grogan.com/" rel="noopener ugc nofollow" target="_blank">找到更多我的内容。</a></p><p id="87bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nt">免责声明:本文是在“原样”的基础上编写的，没有担保。它旨在提供数据科学概念的概述，不应被解释为专业建议。本文中的发现和解释是作者的发现和解释，不被本文中提到的任何第三方认可或隶属于任何第三方。作者与本文提及的任何第三方无任何关系。</em></p></div></div>    
</body>
</html>