<html>
<head>
<title>Training Models to Detect Credit Card Frauds with Amazon SageMaker Autopilot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用亚马逊SageMaker自动驾驶仪检测信用卡欺诈的训练模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/training-models-to-detect-credit-card-frauds-with-amazon-sagemaker-autopilot-d49a6b667b2e?source=collection_archive---------14-----------------------#2021-03-21">https://towardsdatascience.com/training-models-to-detect-credit-card-frauds-with-amazon-sagemaker-autopilot-d49a6b667b2e?source=collection_archive---------14-----------------------#2021-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c58e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">亚马逊Sagemaker Autopilot如何帮助你快速训练模型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/77d1855d8697e4749a699e293c4420d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DxyTlgEpFb4srULQ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">米卡·鲍梅斯特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3d38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">典型的数据科学项目生命周期经历许多阶段。第一阶段是理解业务和数据，随后是数据准备、模型训练、模型评估和生产部署。这些阶段并不简单。它们乏味、重复，并且仅限于少数有技能的个人，如研究人员、数据科学家和ML工程师。</p><p id="6d6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实际上，数据科学家<a class="ae kv" href="https://cloudzone.io/what-is-automl-and-why-consider-it/" rel="noopener ugc nofollow" target="_blank">花大量时间做重复性的</a>任务，比如清理、寻找和准备用于训练模型的数据。其中一些重复性的任务可以自动化。</p><p id="da10" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对智能系统的需求持续增长，然而大多数组织缺乏资源来满足需求。许多企业都在争夺人工智能(AI)领域的稀缺人才，这一事实只会让情况变得更糟。</p><p id="b927" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有这些结合在一起使AutoML变得必不可少。AutoML允许你将ML自动化并应用于商业问题。它为那些没有理论知识的人提供了AI开发的途径。</p><p id="6eb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章将着眼于亚马逊的AutoML产品(亚马逊SageMaker Autopilot ),并应用它来训练一个检测信用卡欺诈的模型。</p><p id="15fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你正在寻找这篇文章所用代码的Jupyter笔记本的链接，请点击<a class="ae kv" href="https://github.com/abiodunjames/CreditCardFraudWithSageMakerAutopilot/blob/master/FraudCaseNotebook.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="a8ea" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">亚马逊SageMaker自动驾驶仪</h1><p id="6a50" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://aws.amazon.com/about-aws/whats-new/2019/12/introducing-amazon-sagemaker-autopilot/" rel="noopener ugc nofollow" target="_blank">2019年宣布</a>，<a class="ae kv" href="https://medium.com/@samuelabiodun/training-a-model-to-detect-credit-card-fraud-with-amazon-sagemaker-autopilot-d49a6b667b2e" rel="noopener"> SageMaker Autopilot </a>是亚马逊的AutoML产品，允许你建立、训练端到端的ML模型。它通过浏览数据来简化您的任务，找到最适合您的数据的最佳算法，并为模型调整和训练准备数据。</p><p id="aeab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自动驾驶仪为每次试验生成笔记本，因为它试图为你的数据选择最佳算法。这些笔记本显示了数据是如何争论的，以及模型选择过程的细节。这些笔记本还提供指导材料，教你关于训练过程和如何训练你自己的实验。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/5a38dcee71b9febfc1f1e3f1eacb0872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VpmhOWpTOG4cR-LW6WFm3A.png"/></div></div></figure><h2 id="70a3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">亚马逊SageMaker自动驾驶仪的一些好处</h2><p id="2655" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">SageMaker Autopilot的一些额外优势包括:</p><ul class=""><li id="3df5" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">ML模型的自动训练</li><li id="bc83" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">自动特征工程</li><li id="3095" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">提供培训过程的可见性</li><li id="8c7f" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">如何挑选候选人的逐步说明</li><li id="0a6e" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">如果需要，您可以灵活地手动调整您的模型</li><li id="f11f" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">您可以从UI和SDK中使用它，从而为自动化留出空间。</li></ul><p id="6913" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然您可以使用AutoML来自动化机器学习(ML)过程以实现各种目的，如价格预测、流失预测、风险评估等。在本教程中，我们将使用亚马逊SageMaker自动驾驶仪来训练一个检测欺诈交易的模型。</p><h1 id="ce6e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">亚马逊SageMaker自动驾驶仪的自动模型训练</h1><p id="f498" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">欺诈交易有一些具体特征，可以通过学习将它们与合法交易区分开来。我不会在这篇文章中深入探讨这些特征。我们将使用托管在<a class="ae kv" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上的现有公共数据集。该数据集包含2013年9月欧洲持卡人的信用卡交易。</p><p id="43f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本教程的其余部分，我们将遵循下列步骤:</p><ol class=""><li id="baa5" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nq ni nj nk bi translated">在亚马逊SageMaker上创建一个笔记本</li><li id="9c4b" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nq ni nj nk bi translated">获取数据</li><li id="28a0" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nq ni nj nk bi translated">检查数据</li><li id="d637" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nq ni nj nk bi translated">准备数据</li><li id="209e" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nq ni nj nk bi translated">创建一个亚马逊SageMaker自动驾驶作业</li><li id="aa15" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nq ni nj nk bi translated">探索培训结果</li></ol><h2 id="35ed" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">在亚马逊SageMaker上创建新笔记本</h2><p id="9061" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">登录AWS云，创建一个新的笔记本。如果您没有帐户，您可以在这里创建一个新帐户<a class="ae kv" href="https://aws.amazon.com/resources/create-account/" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="0589" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">获取数据</h2><p id="cb53" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要将数据集下载到您的笔记本，请按照以下说明授予您的笔记本对Kaggle的访问权限。</p><ul class=""><li id="14d2" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">登录<a class="ae kv" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a></li><li id="2cd7" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">单击您的个人资料图片，然后从下拉菜单中单击帐户。</li><li id="4edd" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">向下滚动到API部分。</li><li id="bcdf" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">单击“创建新的API令牌”按钮，以JSON文件的形式下载一个新的令牌，该文件包含用户名和API密钥。</li><li id="12e1" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">将JSON文件复制到~/。kaggle/该目录如下面的代码示例所示</li></ul><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="59ba" class="mq lt iq ns b gy nw nx l ny nz">!mkdir ~/.kaggle</span><span id="9ead" class="mq lt iq ns b gy oa nx l ny nz">!echo '{"username":"your-user-name","key":"your-key"}' &gt;&gt; ~/.kaggle/kaggle.json </span><span id="79b4" class="mq lt iq ns b gy oa nx l ny nz">!chmod 600 /home/ec2-user/.kaggle/kaggle.json</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/67b76fda96fb17133c8cbda5023867f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Robq5Ux7D8rHHSkBJj77Uw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">授予Kaggle笔记本访问权限</p></figure><h2 id="37fb" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">检查数据</h2><p id="e3c5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">用panda加载CSV数据并检查数据。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="4f95" class="mq lt iq ns b gy nw nx l ny nz">!kaggle datasets download -d  "arockiaselciaa/creditcardcsv"</span><span id="cd85" class="mq lt iq ns b gy oa nx l ny nz">dataset_path = './creditcard.csv'</span><span id="5d2d" class="mq lt iq ns b gy oa nx l ny nz">import pandas as pd</span><span id="f1e2" class="mq lt iq ns b gy oa nx l ny nz">df = pd.read_csv(dataset_path)<br/>pd.set_option('display.max_columns', 500)<br/>pd.set_option('display.max_rows', 10)<br/>df</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/47ac68200b12b4414a054fc5829a4ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMW7VcxGDU6-EO2AeaMehw.png"/></div></div></figure><h2 id="c53f" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">准备数据集</h2><p id="bb74" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将做一些预处理。在此步骤中，我们将执行以下操作:</p><ul class=""><li id="2690" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">将数据分成训练和测试数据集</li><li id="2e7f" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">将拆分上传至s3时段</li></ul><p id="6748" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试数据将用于稍后执行推理。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="3c38" class="mq lt iq ns b gy nw nx l ny nz">df = df.drop(['Amount', 'Time'], axis = 1)<br/>train_data = df.sample(frac=0.8, random_state=200)<br/>test_data = df.drop(train_data.index)</span><span id="1e4b" class="mq lt iq ns b gy oa nx l ny nz">test_data_no_y = test_data.drop(columns=['Class'])<br/>test_data_no_y.head()</span></pre><p id="3a9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将训练数据集上传至s3</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="89e4" class="mq lt iq ns b gy nw nx l ny nz">train_file = 'train_data.csv'<br/>train_data.to_csv(train_file, index=False, header=True)<br/>train_path = session.upload_data(path=train_file, key_prefix=prefix + "/train")<br/>print(f"Upload file to {train_path}")</span></pre><p id="8014" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将对测试数据集做同样的事情</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="67fe" class="mq lt iq ns b gy nw nx l ny nz">test_file = 'test_data.csv'<br/>test_data_no_y.to_csv(test_file, index=False, header=False)<br/>test_path = session.upload_data(path=test_file, key_prefix=prefix + "/test")<br/>print(f"Upload file to {test_path}")</span></pre><h2 id="42f3" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">创建亚马逊SageMaker自动驾驶作业</h2><p id="3c92" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">为了找到性能最佳的模型，我们首先需要配置自动驾驶仪的工作、输入数据和输出数据。</p><p id="9714" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用下面的代码片段配置自动驾驶仪的工作</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="1855" class="mq lt iq ns b gy nw nx l ny nz">auto_ml_job_config = {<br/>        'CompletionCriteria': {<br/>            'MaxCandidates': 5<br/>        }<br/>    }</span><span id="aa5a" class="mq lt iq ns b gy oa nx l ny nz">input_data_config = [{<br/>      'DataSource': {<br/>        'S3DataSource': {<br/>          'S3DataType': 'S3Prefix',<br/>          'S3Uri': 's3://{}/{}/train'.format(bucket, prefix)<br/>        }<br/>      },<br/>      'TargetAttributeName': 'Class'<br/>    }<br/>  ]</span><span id="35bb" class="mq lt iq ns b gy oa nx l ny nz">output_data_config = {<br/>    'S3OutputPath': 's3://{}/{}/output/'.format(bucket, prefix)<br/>  }</span><span id="8949" class="mq lt iq ns b gy oa nx l ny nz">from time import gmtime, strftime, sleep<br/>timestamp_suffix = strftime('%d-%H-%M-%S', gmtime())</span><span id="e652" class="mq lt iq ns b gy oa nx l ny nz">auto_ml_job_name = f'automl-fraudcase-{timestamp_suffix}'<br/>print(f"AutoMLJobName:{auto_ml_job_name}")</span></pre><p id="f9ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们创建实际的自动驾驶仪的工作</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="35ca" class="mq lt iq ns b gy nw nx l ny nz">role = get_execution_role()<br/>sm = boto3.Session().client(service_name='sagemaker',region_name=region)<br/>sm.create_auto_ml_job(AutoMLJobName=auto_ml_job_name,<br/>                      InputDataConfig=input_data_config,<br/>                      OutputDataConfig=output_data_config,<br/>                      AutoMLJobConfig=auto_ml_job_config,<br/>                      RoleArn=role)</span></pre><p id="8745" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SageMaker Autopilot分析数据集，以开发一个应在数据上尝试的ML管道列表。它还对数据执行要素工程，例如对每个数据集要素执行要素变换。最后，它执行模型调整，选择性能最好的管道。</p><p id="667d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用<a class="ae kv" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sagemaker.html#SageMaker.Client.describe_auto_ml_job" rel="noopener ugc nofollow" target="_blank"><em class="od">describe _ auto _ ml _ job</em>API</a>将信息返回给SageMaker自动驾驶仪的作业。</p><p id="ab5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将利用<em class="od"> describe_auto_ml_jon </em> API来监控正在运行的作业的进度，如下面的代码所示:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="342f" class="mq lt iq ns b gy nw nx l ny nz">print('JobStatus  Secondary Status')</span><span id="7a57" class="mq lt iq ns b gy oa nx l ny nz">print('-------------------------------------')<br/>describe_response = sm.describe_auto_ml_job(AutoMLJobName=auto_ml_job_name)<br/>print(f"{describe_response['AutoMLJobStatus']} - {describe_response['AutoMLJobSecondaryStatus']}")</span><span id="2512" class="mq lt iq ns b gy oa nx l ny nz">job_run_status = describe_response['AutoMLJobStatus']<br/>      <br/>while job_run_status not in ('Failed', 'Completed', 'Stopped'):<br/>      <br/>      describe_response = sm.describe_auto_ml_job(AutoMLJobName=auto_ml_job_name)<br/>      job_run_status = describe_response['AutoMLJobStatus']</span><span id="2551" class="mq lt iq ns b gy oa nx l ny nz">print(f"{describe_response['AutoMLJobStatus']} - {describe_response['AutoMLJobSecondaryStatus']}")<br/>      sleep(30)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/a016aab0837027b889315404fd09cb3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7j7ocpTcKyX_xRnvy6mfg.png"/></div></div></figure><h2 id="79e9" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated"><strong class="ak">使用最佳候选人</strong>进行批量推断</h2><p id="f605" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在训练了一些模型之后，这里，我们将使用SageMaker自动驾驶仪提供的最佳候选来执行批量推理工作。步骤如下:</p><ul class=""><li id="545b" class="nc nd iq ky b kz la lc ld lf ne lj nf ln ng lr nh ni nj nk bi translated">从最佳候选中创建模型</li><li id="43c0" class="nc nd iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">使用Amazon SageMaker自动驾驶作业利用批量推理</li></ul><p id="42fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用最佳候选项创建模型，如下所示:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="5c05" class="mq lt iq ns b gy nw nx l ny nz">model_name = 'automl-fraudcase-model-' + timestamp_suffix</span><span id="f8ed" class="mq lt iq ns b gy oa nx l ny nz">model = sm.create_model(Containers=best_candidate['InferenceContainers'],<br/>                            ModelName=model_name,<br/>                            ExecutionRoleArn=role)</span><span id="ad4a" class="mq lt iq ns b gy oa nx l ny nz">print('Model ARN corresponding to the best candidate is : {}'.format(model['ModelArn']))</span></pre><p id="6521" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个匹配转换作业:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="44ca" class="mq lt iq ns b gy nw nx l ny nz">transform_job_name = 'automl-fraudcase-transform-' + timestamp_suffix</span><span id="4eae" class="mq lt iq ns b gy oa nx l ny nz">transform_input = {<br/>        'DataSource': {<br/>            'S3DataSource': {<br/>                'S3DataType': 'S3Prefix',<br/>                'S3Uri': test_path<br/>            }<br/>        },<br/>        'ContentType': 'text/csv',<br/>        'CompressionType': 'None',<br/>        'SplitType': 'Line'<br/>    }</span><span id="aef9" class="mq lt iq ns b gy oa nx l ny nz">transform_output = {<br/>        'S3OutputPath': 's3://{}/{}/inference-results'.format(bucket, prefix),<br/>    }</span><span id="9d8b" class="mq lt iq ns b gy oa nx l ny nz">transform_resources = {<br/>        'InstanceType': 'ml.m5.4xlarge',<br/>        'InstanceCount': 1<br/>    }</span><span id="ad52" class="mq lt iq ns b gy oa nx l ny nz">sm.create_transform_job(TransformJobName = transform_job_name,<br/>                        ModelName = model_name,<br/>                        TransformInput = transform_input,<br/>                        TransformOutput = transform_output,<br/>                        TransformResources = transform_resources<br/>)</span></pre><p id="3ac0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，您可以看到Autopilot试图为您的数据找到最佳算法时生成的模型列表，如下所示:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="ba89" class="mq lt iq ns b gy nw nx l ny nz">candidates = sm.list_candidates_for_auto_ml_job(AutoMLJobName=auto_ml_job_name, SortBy='FinalObjectiveMetricValue')['Candidates']<br/>index = 1<br/>for candidate in candidates:<br/>  print(f"{str(index)} {candidate['CandidateName']} {str(candidate['FinalAutoMLJobObjectiveMetric']['Value'])}")<br/>  index += 1</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/b2fac9e9b3f9e62da3e23a24f9f2f017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ycSrFr5QJQOsoaoV5p_ig.png"/></div></div></figure><h2 id="2201" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">生成的笔记本</h2><p id="553e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">亚马逊SageMaker Autopilot生成笔记本，让你深入了解训练过程以及模型是如何选择的，如前所述。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/0a89da7be5452bbbb087772f9f272d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXyHsUudsOS3Ri3nLS1WUg.png"/></div></div></figure><p id="9fa5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里找到生成的笔记本<a class="ae kv" href="https://github.com/abiodunjames/CreditCardFraudWithSageMakerAutopilot/tree/master/output/model/automl-fraudcase-21-10-06-37/sagemaker-automl-candidates/pr-1-bfb21b0c8b8347ebb3402853908b18c1df4ad627cb764fd1918a382b94/notebooks" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="af21" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">参考</h2><p id="2b3c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">信用卡欺诈数据集</a> <br/> <a class="ae kv" href="https://github.com/aws/amazon-sagemaker-examples" rel="noopener ugc nofollow" target="_blank">亚马逊SageMaker示例</a></p></div></div>    
</body>
</html>