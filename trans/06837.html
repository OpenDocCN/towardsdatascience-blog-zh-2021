<html>
<head>
<title>Understanding Multicollinearity and How to Detect it in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解多重共线性以及如何在Python中检测多重共线性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/everything-you-need-to-know-about-multicollinearity-2f21f082d6dc?source=collection_archive---------2-----------------------#2021-06-21">https://towardsdatascience.com/everything-you-need-to-know-about-multicollinearity-2f21f082d6dc?source=collection_archive---------2-----------------------#2021-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="763d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">它是什么，它从哪里来，为什么不好，以及如何处理它。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/07fad338d000891b6891e6b7e78561be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DIf5lqGrxB7crvANvkTj-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Amir-abbas Abdolali 在<a class="ae ky" href="https://unsplash.com/s/photos/twins?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><blockquote class="kz la lb"><p id="6da9" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">请务必点击</strong> <a class="ae ky" href="https://terenceshin.medium.com/membership" rel="noopener"> <strong class="lf iu">订阅此处</strong> </a> <strong class="lf iu">或我的</strong> <a class="ae ky" href="https://terenceshin.substack.com/embed" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">个人简讯</strong> </a> <strong class="lf iu">千万不要错过另一篇关于数据科学指南、技巧和提示、生活经验等的文章！</strong></p></blockquote><h1 id="3a9c" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">介绍</h1><p id="2caf" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">在接下来的几篇文章中，我想写一些与<strong class="lf iu">回归分析</strong>相关的真正强大的主题。在很长一段时间里，我不认为线性回归有什么大不了的——我只是认为它是最简单的机器学习模型，只不过是一条最佳拟合线。</p><p id="e329" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">然而，随着我对回归分析和它所能提供的东西了解得越来越多，我意识到有很多强大的工具和技巧是大多数人不知道的。</p><p id="3b1a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">所以，作为开始，我想谈谈多重共线性。具体来说，我要涵盖:</p><ol class=""><li id="44e9" class="mz na it lf b lg lh lj lk mt nb mv nc mx nd ly ne nf ng nh bi translated">什么是多重共线性</li><li id="2d59" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly ne nf ng nh bi translated">什么导致多重共线性</li><li id="d40c" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly ne nf ng nh bi translated">为什么它对线性回归模型不好</li><li id="12c5" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly ne nf ng nh bi translated">如何检测和消除多重共线性</li><li id="b4e0" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly ne nf ng nh bi translated">如何检测Python中的多重共线性</li></ol><p id="33be" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">说了这么多，让我们开始吧！</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="74e3" class="lz ma it bd mb mc nu me mf mg nv mi mj jz nw ka ml kc nx kd mn kf ny kg mp mq bi translated">什么是多重共线性？</h1><p id="fbc7" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated"><strong class="lf iu">多重共线性</strong>(或共线性)当回归模型中的一个独立变量与另一个独立变量线性相关时发生。</p><p id="e72f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">例如，如果我们在回归模型中使用“<strong class="lf iu">年龄</strong>和“<strong class="lf iu">年轮数</strong>”来预测树的重量。</p><p id="227f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">因为树的年龄和树的年轮数(通常每年一个年轮)之间有很高的相关性，所以多重共线性将出现在该模型中。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><blockquote class="kz la lb"><p id="9996" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">请务必点击</strong> <a class="ae ky" href="https://terenceshin.medium.com/membership" rel="noopener"> <strong class="lf iu">订阅此处</strong> </a> <strong class="lf iu">或我的</strong> <a class="ae ky" href="https://terenceshin.substack.com/embed" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">个人简讯</strong> </a> <strong class="lf iu">千万不要错过另一篇关于数据科学指南、技巧和提示、生活经验等的文章！</strong></p></blockquote></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="2bdf" class="lz ma it bd mb mc nu me mf mg nv mi mj jz nw ka ml kc nx kd mn kf ny kg mp mq bi translated">什么原因导致多重共线性？</h1><p id="0685" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">为了理解为什么多重共线性不好，我们必须看看回归系数(或模型参数)是如何估计的。这一部分涉及到一点线性代数，但是如果你不感兴趣，可以跳过这一部分。</p><p id="86fd" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated"><strong class="lf iu"> <em class="le">注:跳过这一部分也不用担心，只要把重点放在为什么多重共线性不好以及如何消除多重共线性上就可以了。:)</em>T5】</strong></p><p id="38a2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">请注意，回归系数是指每个变量的“斜率”,在方程y = B0 + B1x+ B2x2中，B1和B2是回归系数。请记住，线性回归模型的要点是找到代表数据的最佳回归系数。</p><p id="3aa7" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">为了找到最佳回归系数，我们希望找到使平方误差最小的值。做了一点数学计算后，你可以用下面的等式找到最佳参数(B1，B2，…，Bp):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c50e55fb9a1ef1a343898244859b10ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*x4K_bB-tDGPAxLlmIqvR6w.png"/></div></figure><p id="a074" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">其中B_hat是包含所有单个回归系数的向量，X是由预测变量组成的<strong class="lf iu">设计矩阵</strong>。</p><p id="78e1" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">注意，为了估计B_hat，我们在方程中假设(XTX)是可逆的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/8c63fa8ffa7e022a0da49bdbfba635f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mn7NmOuLQvFzJGtB3SuE3w.png"/></div></div></figure><p id="84e3" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">如果X的列彼此线性相关(即，如果存在多重共线性)，XTX是不可逆的，这将导致几个后果，您将在下一节中看到。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="66c4" class="lz ma it bd mb mc nu me mf mg nv mi mj jz nw ka ml kc nx kd mn kf ny kg mp mq bi translated">多重共线性产生的问题</h1><p id="25be" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">概括地说，为了正确估计多元回归模型的回归系数，XTX必须是可逆的。如果XTX是不可逆的，这意味着X的列彼此线性相关，并且存在多重共线性。</p><p id="eaa2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">最终，多重共线性的存在会导致几个问题:</p><ol class=""><li id="9b60" class="mz na it lf b lg lh lj lk mt nb mv nc mx nd ly ne nf ng nh bi translated">如果其中一个x变量的其中一个值仅稍有改变，则拟合的回归系数(hat)将会显著改变。</li><li id="aeca" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly ne nf ng nh bi translated">估计系数的方差将被夸大，这意味着难以检测统计显著性。此外，有可能F统计量是显著的，但单个t统计量不是显著的。</li><li id="9250" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly ne nf ng nh bi translated">最终，多重共线性会降低预测的准确性。对于给定的模型，潜在的假设是预测变量之间的关系以及它们与目标变量的关系是相同的。但是，当存在多重共线性时，这种情况不太可能出现。</li></ol></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="fb08" class="lz ma it bd mb mc nu me mf mg nv mi mj jz nw ka ml kc nx kd mn kf ny kg mp mq bi translated">如何检测和消除多重共线性</h1><p id="1378" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">检测模型中多重共线性的一种简单方法是对每个预测变量使用称为<strong class="lf iu">方差膨胀因子</strong>或<strong class="lf iu"> VIF </strong>的东西。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ed1230778c6448df5795bf6e52888d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*FCyP_2vjy4iN5-JBWJa5Rg.png"/></div></figure><p id="fb7d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">VIF测量模型中只有该变量的给定回归系数的方差与模型中所有变量的给定回归系数的方差之比。</p><p id="b588" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">VIF为1(最小可能VIF)意味着测试的预测值与其他预测值不相关。VIF为1(最小可能VIF)意味着测试的预测值与其他预测值不相关。</p><p id="56a7" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">VIF越高，</p><ul class=""><li id="6c81" class="mz na it lf b lg lh lj lk mt nb mv nc mx nd ly oc nf ng nh bi translated">一个预测值与其他预测值的相关性越大</li><li id="761e" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly oc nf ng nh bi translated">标准误差被夸大得越多</li><li id="7b6e" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly oc nf ng nh bi translated">置信区间越大</li><li id="2483" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly oc nf ng nh bi translated">系数被评估为统计显著的可能性越小</li></ul><p id="bf10" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">可接受的VIF小于10和1/1-R模型的最大值(见下文):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/5cb28fcf7f2c98fc01f740473cc8ee13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*E5tXH3l_vmTWuBTds1ws6g.png"/></div></figure><h1 id="c0e8" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">如何用Python实现VIF</h1><p id="0842" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">举个例子，我要用<a class="ae ky" href="https://www.kaggle.com/camnugent/california-housing-prices" rel="noopener ugc nofollow" target="_blank"> Kaggle的加州房价数据集</a>。</p><p id="2416" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">首先，我导入了所有相关的库和数据:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="a092" class="oj ma it of b gy ok ol l om on">import pandas as pd<br/>import numpy as np<br/>from statsmodels.stats.outliers_influence import variance_inflation_factor</span></pre><p id="6aa6" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">接下来，为了简单起见，我只选择了3列作为我的特征(X变量),并删除了所有的空值和无穷大值:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="f041" class="oj ma it of b gy ok ol l om on">df = pd.read_csv('housing.csv')<br/>df = df[~df.isin([np.nan, np.inf, -np.inf]).any(1)]<br/>X_variables = df[['total_rooms','total_bedrooms','median_income']]</span></pre><p id="7fd8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">最后，我计算了X变量的VIF:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="c309" class="oj ma it of b gy ok ol l om on">vif_data = pd.DataFrame()<br/>vif_data["feature"] = X_variables.columns<br/>vif_data["VIF"] = [variance_inflation_factor(X_variables.values, i) for i in range(len(X_variables.columns))]</span></pre><p id="96d8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">就这样，我们得到了最后的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/f3b9518b8da3b9c70b651ad8088927c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*SsS1bohA2AKU2tX_rtJncA.png"/></div></figure><p id="0511" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">直觉上，这完全说得通。房间总数和卧室总数远远高于VIF阈值，表明这些变量之间存在高度共线性。我们可以直观地理解这一点，因为房间数和卧室数之间有很强的相关性(卧室越多，房间越多，反之亦然)。</p><h1 id="973c" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">感谢阅读！</h1><blockquote class="kz la lb"><p id="95c9" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">请务必点击</strong> <a class="ae ky" href="https://terenceshin.medium.com/membership" rel="noopener"> <strong class="lf iu">订阅此处</strong> </a> <strong class="lf iu">或我的</strong> <a class="ae ky" href="https://terenceshin.substack.com/embed" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">个人简讯</strong> </a> <strong class="lf iu">千万不要错过另一篇关于数据科学指南、技巧和提示、生活经验等的文章！</strong></p></blockquote><p id="aefe" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">我希望您发现这很有用，并且您学到了一些新东西！多重共线性是回归分析中一个极其重要的概念，因此它绝对是一个需要理解的重要概念。</p><p id="acad" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">不确定接下来要读什么？我为你挑选了另一篇文章:</p><div class="op oq gp gr or os"><a rel="noopener follow" target="_blank" href="/40-statistics-interview-problems-and-answers-for-data-scientists-6971a02b7eee"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">数据科学家的40个统计面试问题和答案</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">为你的面试复习统计知识的资源！</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg ks os"/></div></div></a></div><p id="7e78" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated"><strong class="lf iu">又一个！</strong></p><div class="op oq gp gr or os"><a rel="noopener follow" target="_blank" href="/all-probability-distributions-explained-in-six-minutes-fe57b1d49600"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">六分钟内解释所有概率分布</h2><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg ks os"/></div></div></a></div><h1 id="d0d6" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">特伦斯·申</h1><ul class=""><li id="b208" class="mz na it lf b lg mr lj ms mt pi mv pj mx pk ly oc nf ng nh bi translated"><strong class="lf iu"> <em class="le">如果你喜欢这个，</em> </strong> <a class="ae ky" href="https://medium.com/@terenceshin" rel="noopener"> <strong class="lf iu"> <em class="le">跟我上媒</em> </strong> </a> <strong class="lf iu"> <em class="le">了解更多</em> </strong></li><li id="e8ff" class="mz na it lf b lg ni lj nj mt nk mv nl mx nm ly oc nf ng nh bi translated"><strong class="lf iu"> <em class="le">有兴趣合作？让我们连线上</em></strong><a class="ae ky" href="https://www.linkedin.com/in/terenceshin/" rel="noopener ugc nofollow" target="_blank"><strong class="lf iu"><em class="le">LinkedIn</em></strong></a></li></ul></div></div>    
</body>
</html>