<html>
<head>
<title>MLOps: Building a Feature Store? Here are the top things to keep in mind</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MLOps:建立一个功能商店？以下是需要记住的几件事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mlops-building-a-feature-store-here-are-the-top-things-to-keep-in-mind-d0f68d9794c6?source=collection_archive---------2-----------------------#2021-09-07">https://towardsdatascience.com/mlops-building-a-feature-store-here-are-the-top-things-to-keep-in-mind-d0f68d9794c6?source=collection_archive---------2-----------------------#2021-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="1ecc" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/notes-from-industry" rel="noopener" target="_blank">行业笔记</a></h2><div class=""/><div class=""><h2 id="42f9" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">一个功能商店应该有3个主要构件，并提供10个主要功能。这使得要素库能够改进原始数据的处理和编目方式，从而加快数据科学家的周转时间。</h2></div><p id="155c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">由<a class="ae lk" href="https://www.linkedin.com/in/pronojitsaha/" rel="noopener ugc nofollow" target="_blank">普罗诺吉特·萨哈</a> &amp; <a class="ae lk" href="https://www.linkedin.com/in/arnab-bose-phd-6369531/" rel="noopener ugc nofollow" target="_blank">阿纳·博斯博士</a></p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/5e01f8d96958f813083b749cdd516d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VA_tXEtY_U0LDBvcLKiJzg.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图1:特征存储数据流(作者图片)</p></figure><p id="bb7d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在我们关于特性商店的第一篇文章<a class="ae lk" href="https://bit.ly/mlops-feature-stores" rel="noopener ugc nofollow" target="_blank">中，我们定义了它是什么，为什么需要它，以及它如何填补MLOps生命周期中的一个重要空白。从上图中可以看出，特征存储有三层，转换(接收&amp;过程数据并创建特征)、存储(存储创建的特征&amp;的元数据)和服务(使存储的特征可用)。在本文中，我们将了解商店层应该具备哪些主要组件。我们还将了解在构建功能商店或评估供应商提供的任何现有功能商店时应该记住的主要功能。在下一篇文章中，我们将探讨如何使用各种技术来实现这三个层和功能。订阅</a><a class="ae lk" href="https://pronojit.medium.com/about" rel="noopener">此处的</a>以获得相同的通知。</p><h1 id="0ca3" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">功能存储:主要组件</h1><p id="598f" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">功能商店的商店层应该具有的三个主要组件是:</p><ol class=""><li id="79d1" class="my mz iq kq b kr ks ku kv kx na lb nb lf nc lj nd ne nf ng bi translated">一个<strong class="kq ja">离线特征库</strong>，用于提供大批量特征，以(1)创建训练/测试数据集，以及(2)将特征用于训练作业和/或批量应用评分/推理作业。这些要求通常在超过一分钟的延迟时得到满足。离线商店通常实现为分布式文件系统(ADLS、S3等)或数据仓库(红移、雪花、大查询、Azure Synapse等)。例如，在优步的米开朗基罗调色板功能商店中，它从lambda architecture获得灵感，使用HDFS的HIVE实现。</li><li id="3c0f" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">一个<strong class="kq ja">在线特征存储库</strong>，用于提供单行特征(一个<em class="nm">特征向量</em>)作为个体预测在线模型的输入特征。这些要求通常以几秒或几毫秒的延迟来满足。在线商店理想地实现为键值存储(例如Redis、Mongo、Hbase、Cassandra等)。)用于快速查找，具体取决于等待时间要求。</li><li id="b483" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">一个<strong class="kq ja">特征注册表</strong>，用于存储所有具有血统的特征的元数据，供两个离线&amp;在线特征存储使用。它基本上是一个实用程序，帮助了解商店中所有可用的功能以及它们是如何生成的信息。此外，用于下游应用/模型的一些特征搜索/推荐能力可以被实现为特征注册表的一部分，以使得能够容易地发现特征。</li></ol><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nn"><img src="../Images/f1be7118ad7ad350bba8bb55a9c22277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5eGAmhJVnnP-nZD5KrSTTQ.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图2:特征库框架(图片来自ML的特征库，2021)</p></figure><h1 id="e2fd" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">FeatureOps:功能库的主要功能</h1><p id="41db" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">在我们的<a class="ae lk" href="https://bit.ly/mlops-feature-stores" rel="noopener ugc nofollow" target="_blank">上一篇文章</a>中，我们将特性操作确定为当前MLOps生命周期中的缺口。FeatureOps的缺失导致数据科学家一次又一次地重复创建相同的功能，从而大大增加了上市时间。FeatureOps使数据科学家能够使用功能库执行下面列出的功能，从而缩短他们的开发时间，并促进团队协作。现在让我们来看看这些功能。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div class="gh gi no"><img src="../Images/59da26d07507d0dcf722be9adaf0e2f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*gOuLXYCK6XxfAeK9iw6VTQ.png"/></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图3:特征存储功能(作者图片)</p></figure><h2 id="7c35" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">1.特征数据验证</h2><p id="67fe" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">功能存储应该支持定义用于检查数据完整性的数据验证规则。这些包括但不限于，检查值是否在有效范围内，检查值是否唯一/不为空，以及检查描述性统计数据是否在定义的范围内。可以集成到功能商店中的验证工具的示例有<a class="ae lk" href="https://medium.com/analytics-vidhya/data-quality-assurance-with-great-expectations-and-kubeflow-pipelines-d83449fbaa81" rel="noopener">远大前程</a>(任何环境)<a class="ae lk" href="https://www.tensorflow.org/tfx/data_validation/get_started" rel="noopener ugc nofollow" target="_blank"> TFX数据验证</a>(深度学习环境)<a class="ae lk" href="https://github.com/awslabs/deequ" rel="noopener ugc nofollow" target="_blank"> Deequi </a>(大数据环境)。</p><h2 id="1307" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">2.功能连接</h2><p id="fcac" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">对于不同的模型，需要重用不同训练/测试数据集中的特征。大部分在线下商店实施，而不是在线商店，因为这是一个昂贵的过程。</p><h2 id="fdfc" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">3.创建训练/测试数据集</h2><p id="3f13" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">数据科学家应该能够使用要素存储来查询、探索、转换和连接要素，以生成用于数据版本化系统的训练/测试数据集。</p><h2 id="80c9" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">4.输出数据格式</h2><p id="9101" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">特征库应该为数据科学家提供以适合ML建模的格式输出数据的选项(例如，TensorFlow的TFRecord，PyTorch的NPY)。数据仓库/SQL目前缺乏这种能力。这一功能将使数据科学家在培训过程中多走一步。</p><h2 id="bec9" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">5.时间操作</h2><p id="3ef2" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">跨定义的时间粒度(每秒、每小时、每天、每周等)的自动特征版本化将允许数据科学家查询在给定时间点的特征。在下列情况下，这将很有帮助:</p><ol class=""><li id="49a8" class="my mz iq kq b kr ks ku kv kx na lb nb lf nc lj nd ne nf ng bi translated">创建培训/测试数据时(例如，培训数据是2010-2018年的数据，而测试数据是2019-2020年的数据)</li><li id="b4a2" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">对功能进行更改(例如，回滚功能的错误提交)</li><li id="3042" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">比较功能的统计数据并查看它们如何随时间变化(功能监控)</li><li id="8e84" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">回到过去并获取特征值。例如，由模型做出的预测也可以存储在特征存储中，这些预测的结果(基本事实)也可以存储在特征存储中。如果6个月前做出的预测的实际结果/标签现在可用，那么我们需要首先查找6个月前用于生成该结果的特征值，然后用该新结果/标签对其进行标记，以在需要时触发模型的重新训练。</li></ol><h2 id="f64a" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">6.特征可视化</h2><p id="90a5" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">要素存储应支持开箱即用的要素数据可视化，以查看数据分布、要素之间的关系和聚合统计数据(最小值、最大值、平均值、唯一类别、缺失值等)。这将有助于数据科学家快速了解特性，并做出使用特定特性的更好决策。</p><h2 id="662e" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">7.特征管道</h2><p id="e61e" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">要素存储应可选择定义具有定时触发器的要素管线，以便在将来自不同来源的输入数据存储到要素存储之前对其进行转换和聚合。这种特征流水线(通常在新数据到达时运行)可以以不同于训练流水线的节奏运行。</p><h2 id="3aaa" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">8.功能监控</h2><p id="5191" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">特征存储应该能够监控特征以识别特征漂移或数据漂移。可以对实时生产数据计算统计数据，并与特征存储中的先前版本进行比较，以跟踪培训服务偏差。例如，如果特征的平均或标准偏差从生产/实况数据到存储在特征存储上的训练数据有相当大的变化，则重新训练模型可能是谨慎的。在我们之前关于模型监控的文章<a class="ae lk" href="https://bit.ly/PRONOjit-mlops" rel="noopener ugc nofollow" target="_blank">中强调的许多概念，在这里</a>也可以用来支持特性监控。</p><h2 id="6c9e" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">9.特色搜索/推荐</h2><p id="7a73" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">一个特征库应该索引所有的特征及其元数据，并使其便于用户查询检索(如果可能，基于自然语言)。这将确保特性不会在堆中丢失，并提高它们的可重用性。这通常由特性注册中心来完成(如前一节所述)。</p><p id="a5b3" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">此外，通过基于项目中已包含功能的某些属性和元数据推荐可能的功能，功能存储可以增强现有功能的可见性。这让初级到中级的数据科学家具备了经验丰富的高级数据科学家通常具备的洞察力，从而提高了数据科学团队的整体效率。</p><h2 id="37f9" class="np mc iq bd md nq nr dn mh ns nt dp ml kx nu nv mn lb nw nx mp lf ny nz mr iw bi translated">10.特征治理</h2><p id="fd33" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">如果没有适当的治理，功能库很快就会变成功能实验室，或者更糟，变成功能沼泽。治理策略会影响使用功能存储的各个团队的工作流程和决策。特征存储治理包括以下方面:</p><ol class=""><li id="a30e" class="my mz iq kq b kr ks ku kv kx na lb nb lf nc lj nd ne nf ng bi translated">实施访问控制，以决定谁有权使用哪些功能</li><li id="3d78" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">确定功能所有权，即与某人一起维护和更新功能的责任</li><li id="ea0a" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">限制可用于训练特定类型模型的特征类型</li><li id="dae7" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">通过审核模型结果以检查偏差/道德，提高对特征数据的信任和信心</li><li id="957e" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">通过利用功能沿袭来跟踪功能的来源、生成方式以及最终如何流入业务中的下游报告和分析，从而保持透明度</li><li id="46ff" class="my mz iq kq b kr nh ku ni kx nj lb nk lf nl lj nd ne nf ng bi translated">了解适用于功能数据的内部政策和法规要求以及外部合规性要求，并对其进行适当保护</li></ol><h1 id="c5fd" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated"><strong class="ak">数据科学家工作流程中的功能存储使用情况</strong></h1><p id="ab58" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">下图描绘了前面提到的3个主要功能存储组件(红框)和上述10个主要功能(蓝框)在典型数据科学家的ML工作流程中不同时间点的使用情况。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oa"><img src="../Images/5d81f5ba88b2d30a4276761eec38a284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpIIbT8_420pMQkHp6Y3EQ.png"/></div></div><p class="lx ly gj gh gi lz ma bd b be z dk translated">图4:DS工作流程中的特性存储组件和主要功能(图片由作者提供)</p></figure><h1 id="9b05" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">结论</h1><p id="b438" class="pw-post-body-paragraph ko kp iq kq b kr mt ka kt ku mu kd kw kx mv kz la lb mw ld le lf mx lh li lj ij bi translated">特征库通过抽象在ML训练和推理中获取、转换、存储和使用特征所需的大量工程工作，使数据科学家的工作更加方便和高效。它还支持组织的丰富数据发现和治理，从而释放其生成的每个数据字节的价值。希望利用这一点并决定购买/租赁/构建功能商店的组织应该考虑本文中提到的3个主要组件和10个主要功能，以从其实现中获得最大价值。</p></div></div>    
</body>
</html>