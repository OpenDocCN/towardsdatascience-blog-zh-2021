<html>
<head>
<title>How to Dockerize an Existing Flask Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对接现有的Flask应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-dockerize-an-existing-flask-application-115408463e1c?source=collection_archive---------8-----------------------#2021-04-14">https://towardsdatascience.com/how-to-dockerize-an-existing-flask-application-115408463e1c?source=collection_archive---------8-----------------------#2021-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b70e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松运行烧瓶应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9bb708532e3570d60279612ef97f7a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6dLk2QpCduhqVQ1_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图为<a class="ae ky" href="https://unsplash.com/@wezlar11?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">迪安·普</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="53cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">在</span>这篇文章中，我将解释如何对现有的<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a>应用程序进行Dockerize。我将使用我的一个Python <a class="ae ky" href="https://github.com/lifeparticle/python-flask" rel="noopener ugc nofollow" target="_blank">项目</a>进行演示。通过使用Dockerized Flask应用程序，其他开发人员可以轻松地运行该项目，而无需任何环境管理，这对于节省时间和精力来说非常重要。而且，开发者可以专注于开发。如果你是Docker的新手，那么阅读下面的帖子，我在那里介绍了一些基础知识。</p><div class="me mf gp gr mg mh"><a rel="noopener follow" target="_blank" href="/how-to-mount-a-directory-inside-a-docker-container-4cee379c298b"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd iu gy z fp mm fr fs mn fu fw is bi translated">如何在Docker容器中挂载目录</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">专注于编写代码，无需担心环境管理</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ks mh"/></div></div></a></div></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="d0c5" class="nd ne it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">设置</h1><p id="5d53" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">首先，你需要安装<a class="ae ky" href="https://docs.docker.com/engine/install/" rel="noopener ugc nofollow" target="_blank"> Docker </a>并从<a class="ae ky" href="https://github.com/lifeparticle/python-flask" rel="noopener ugc nofollow" target="_blank"> GitHub </a>下载一个git库。对于这个设置，我使用的是macOS。</p><p id="e8e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我将创建一个Docker映像，它包含Python和web应用程序框架Flask作为依赖项。让我们分解一下<a class="ae ky" href="https://github.com/lifeparticle/python-flask/blob/main/Dockerfile" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Dockerfile </strong> </a>文件的各个成分。</p><pre class="kj kk kl km gt oa ob oc bn od oe bi"><span id="14c3" class="of ne it ob b be og oh l oi oj">FROM python:3.9.1<br/><br/>ADD . /python-flask<br/>WORKDIR /python-flask<br/>RUN pip install -r requirements.txt</span></pre><p id="1d45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了定义父图像，我们需要使用<code class="fe ok ol om ob b">From</code>命令。这里我们使用的是Docker Hub上预建的官方图片<a class="ae ky" href="https://hub.docker.com/_/python" rel="noopener ugc nofollow" target="_blank"> Python </a>。要将当前文件夹中的所有内容添加到图像中名为<strong class="lb iu"> python-flask </strong>的目录中，我们需要使用<code class="fe ok ol om ob b">ADD</code>命令。之后，我们将使用<code class="fe ok ol om ob b">WORKDIR</code>命令将工作目录设置为<strong class="lb iu"> python-flask </strong>。最后，使用pip，我们将安装应用程序的依赖项:Flask。</p><p id="465f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我将创建一个Docker合成文件，使用我们刚刚创建的Docker映像运行Docker容器。下面我们来分解一下<a class="ae ky" href="https://github.com/lifeparticle/python-flask/blob/main/docker-compose.yml" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">docker-compose . yml</strong></a>文件的各个成分。</p><pre class="kj kk kl km gt oa ob oc bn od oe bi"><span id="cbfe" class="of ne it ob b be og oh l oi oj">version: "3.8"<br/>services:<br/>  app:<br/>    build: .<br/>    command: python main.py<br/>    ports:<br/>      - "5000:5000"<br/>    volumes:<br/>      - .:/python-flask</span></pre><p id="33c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<strong class="lb iu"> docker-compose.yml </strong>文件中，我们有version、services、app、build、command、ports和volumes标签。<strong class="lb iu">版本</strong>标签用于定义合成文件格式。查看<a class="ae ky" href="https://docs.docker.com/compose/compose-file/" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多信息。<strong class="lb iu"> services </strong>标签用于定义我们希望应用程序使用的服务。对于我们的应用程序，我们只有一个名为<strong class="lb iu"> app </strong>的服务。<strong class="lb iu"> build </strong>命令将使用我们之前创建的Docker文件构建我们的Docker映像。<strong class="lb iu">命令</strong>标签用于运行main.py文件。端口标签用于定义主机和容器端口。它将主机上的端口5000映射到容器上的端口5000。因为默认情况下，Flask运行在端口5000上。最后，<strong class="lb iu"> volumes </strong>标签用于将文件夹从主机挂载到容器。</p><p id="69a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将从<strong class="lb iu"> docker-compose.yml </strong>文件所在的同一个目录运行下面的命令。<code class="fe ok ol om ob b">docker compose up</code>命令将启动并运行整个应用程序。</p><pre class="kj kk kl km gt oa ob oc bn od oe bi"><span id="4eaf" class="of ne it ob b be og oh l oi oj">docker compose up</span></pre><p id="acae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！我们现在正在Docker容器中成功运行Flask应用程序。现在，您可以通过访问URL<a class="ae ky" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/</a>通过您最喜欢的web浏览器访问Flask应用程序。</p><p id="7920" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在运行<code class="fe ok ol om ob b">docker ps</code>来查看所有正在运行的容器。这里，我有一个。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/56cd45ef6ee92fcedcf57377f17c71e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NESLlIAoceux_ENp_BwVAA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">docker ps</p></figure><p id="96fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们来分解一下<a class="ae ky" href="https://github.com/lifeparticle/python-flask/blob/main/main.py" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> main.py </strong> </a>文件的个别成分。</p><pre class="kj kk kl km gt oa ob oc bn od oe bi"><span id="6d5b" class="of ne it ob b be og oh l oi oj">from flask import Flask<br/>app = Flask(__name__)<br/><br/>@app.route('/')<br/>def hello_world():<br/> return 'Hello World'<br/><br/>if __name__ == '__main__':<br/> app.run(host="0.0.0.0", debug=True)</span></pre><p id="d577" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们导入Flask类，然后创建该类的一个实例。之后，使用<code class="fe ok ol om ob b">route()</code> decorator，我们告诉Flask基于URL触发<code class="fe ok ol om ob b">hello_world()</code>函数。最后，我们有代码的入口点，在这里我们使用<code class="fe ok ol om ob b">run()</code>方法运行Flask应用程序。第一个参数是<code class="fe ok ol om ob b">host=”0.0.0.0"</code>，它使应用程序在所有公共IP上都可用。第二个参数是<code class="fe ok ol om ob b">debug=True</code>将启用调试模式。你可以从<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/quickstart/#debug-mode" rel="noopener ugc nofollow" target="_blank">这里</a>阅读更多关于Flask应用和调试的<a class="ae ky" href="https://flask.palletsprojects.com/en/1.1.x/quickstart/#a-minimal-application" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="f05b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你知道了如何在Docker容器中运行Flask应用程序。我希望这能帮助你开始使用Flask和Docker。编码快乐！</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="9c8e" class="nd ne it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">相关帖子</h1><div class="me mf gp gr mg mh"><a rel="noopener follow" target="_blank" href="/how-to-run-a-python-script-using-a-docker-container-ea248e618e32"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd iu gy z fp mm fr fs mn fu fw is bi translated">如何使用Docker容器运行Python脚本</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">轻松运行Python</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="oo l ms mt mu mq mv ks mh"/></div></div></a></div></div></div>    
</body>
</html>