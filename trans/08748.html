<html>
<head>
<title>Learn SQL Server Management Studio — Part 10: Export Query Data by Email as .CSV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解SQL Server Management Studio —第10部分:通过电子邮件导出查询数据。战斗支援车</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-sql-server-management-studio-part-10-export-tables-by-email-as-csv-29bf2d990656?source=collection_archive---------27-----------------------#2021-08-12">https://towardsdatascience.com/learn-sql-server-management-studio-part-10-export-tables-by-email-as-csv-29bf2d990656?source=collection_archive---------27-----------------------#2021-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="606e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你在派对上开心的技能！循序渐进。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/53c012f3be7acd4a69a6737e89a46d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D0bFUJ-kXOhPUkA2"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·泽兹奇在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="5e61" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在最后几集里…</h1><p id="5fbc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你好。欢迎来到SQL和SQL Server Studio系列教程的第10期。有一个简单的目标:让你熟悉和适应这个工具和语言。“这有什么关系？”我知道你在问。事实证明，好奇心和副业往往是被新项目选中甚至获得新工作的关键。事实上，您已经使用了一个重要的工具，比如SQL Server Studio，并且编写了一些SQL查询，这将会给您一个清晰的开端。</p><ul class=""><li id="ec4d" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><strong class="lt iu">在第1集</strong>中，我将向您展示<strong class="lt iu">如何设置我们的环境和本地服务器</strong> — <a class="ae ky" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-part-1-step-by-step-setup-63428650a1e0">第1部分逐步设置SQL Server Studio </a></li><li id="d50f" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第2集</strong>中，我们将讲述<strong class="lt iu">如何创建自己的数据库、表</strong>、<strong class="lt iu">和</strong>关于<strong class="lt iu">命名约定的重要注释— </strong>、<a class="ae ky" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-5cd24bb1a87c">第二部分数据库、表&amp;命名约定</a></li><li id="13dd" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第三集</strong>中，我们介绍了<strong class="lt iu"> CRUD操作</strong>和<strong class="lt iu">主键和外键</strong> — <a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-3-crud-operations-primary-foreign-keys-9d884b32ad70">第三部分CRUD操作，主键&amp;外键</a></li><li id="2a39" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第4集</strong>中，我们讨论了<strong class="lt iu">模式&amp;的主要规范化步骤</strong> — <a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-4-schemas-normalization-80bcd6a5258">第4部分模式&amp;规范化</a></li><li id="1fd9" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第5集</strong>中，我们覆盖了<strong class="lt iu">存储过程&amp;调度</strong>，这是一个真正的野兽。我怎么强调这将如何促进和自动化你的日常(数据)生活都不为过。<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-5-stored-procedures-scheduling-88fd9788d314">第五部分存储过程&amp;调度</a></li><li id="e641" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第6集</strong>中，我们介绍了用于ETL 的<strong class="lt iu"> SSIS包，并回顾了如何在两个数据库之间以及一个数据库与Excel之间导入和导出数据。<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-6-ssis-packages-9438dbc90437">第六部SSIS套餐简介</a></strong></li><li id="4f68" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">在第7集中，我们<strong class="lt iu">将SQL Studio连接到PowerBI </strong>并构建我们的第一个视觉效果。<a class="ae ky" href="http://part%207%20connect%20to%20powerbi%20%26%20first%20visuals/" rel="noopener ugc nofollow" target="_blank">第7部分连接到PowerBI &amp;第一视觉效果</a>。</li><li id="74e3" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><strong class="lt iu">在第8集</strong>中，我们<strong class="lt iu">利用SQL视图</strong>的强大功能，这是一个简单的轻量级工具，用于组合和检索复杂的表。你不会相信没有他们你怎么活下去。<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-8-leverage-the-views-206fbcef3957">第8部分利用观点</a></li><li id="b23b" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">在第9集中，我们利用临时表，在存储过程中临时存储和检索数据。找出中间结果并以表格形式缓存数据以备后用是非常有用的。在<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-9-temporary-tables-f69aee616833">第九部分临时表格</a>中了解更多信息</li></ul><p id="cbcf" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">别忘了回来😉。</p><h1 id="2d60" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">期待什么？</h1><p id="07d0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在查看了视图和临时表之后，是时候深入了解一个特性了，这个特性不会引起太多的关注，但会被证明非常有用。在本教程结束时，您将会感到能够在SQL过程中利用报表生成的强大功能。让我们直接跳进来吧！</p><h1 id="9486" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="13c2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有时，尽管您的数据显示在精美的PowerBI报告上，但用户仍然需要访问原始数据。生的意思是。例如csv。虽然在那个<em class="ng">著名的“什么都有”表</em>上写一个快速查询是很有礼貌的(剧透:根本没有这回事)，但是如果用户频繁地请求，这可能会变得令人不知所措。一种解决方案是安排一个作业，并在其上附加一个包含所需信息的. csv文档。</p><p id="3c86" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">幸运的是，有一个有用的函数，可以通过调整一组参数来获得该报告。解决方案不是现成的，它需要一点创造力，但是你会发现实现起来很简单。</p><h1 id="6736" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">通过电子邮件将SQL数据导出为CSV格式</h1><p id="a378" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们假设您的SQL Studio环境已经启动并正在运行。如果您需要帮助，这里有一个分步指南:<a class="ae ky" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-part-1-step-by-step-setup-63428650a1e0">第1部分SQL Server Studio的分步设置</a>。</p><p id="c9a5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">对于本教程，我们将利用存储过程和SSMS调度功能，有些部分可能会很仓促，您可以在这里找到更多信息:<a class="ae ky" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-5-stored-procedures-scheduling-88fd9788d314">第5部分存储过程&amp;调度</a></p><p id="f308" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们将利用的表非常简单，由“名字”和“姓氏”组成</p><ol class=""><li id="361c" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm nh mv mw mx bi translated">让我们创建一个过程。SSMS提供的典型骨架是:</li></ol><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="ec61" class="nn la it nj b gy no np l nq nr">CREATE PROCEDURE &lt;Procedure_Name, sysname, ProcedureName&gt;<br/>AS<br/>BEGIN<br/>SELECT &lt;@Param1, sysname, @p1&gt;, &lt;@Param2, sysname, @p2&gt;<br/>END<br/>GO</span></pre><p id="53fc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们的案例中不需要的一些样板代码已经被删除。</p><p id="c46a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">2.我们从声明一个参数&lt;<em class="ng"> @query </em> &gt;开始，并把它的类型指定为NVARCHAR(MAX)</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="07ec" class="nn la it nj b gy no np l nq nr">CREATE PROCEDURE &lt;Procedure_Name, sysname, ProcedureName&gt;<br/>AS<br/>BEGIN<br/><strong class="nj iu">DECLARE @query NVARCHAR(MAX)</strong></span></pre><p id="a077" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">3.然后我们开始定义参数&lt;<em class="ng">@查询</em> &gt;:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="22d6" class="nn la it nj b gy no np l nq nr">SET @query = N'....'</span></pre><p id="cb86" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">N将下面的字符串定义为NVARCHAR，</p><p id="1445" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">4.然后，我们设置下面的语句，防止消息通知我们受查询影响的行数。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="0718" class="nn la it nj b gy no np l nq nr">SET @query = N'<br/>SET NOCOUNT ON</span></pre><p id="d824" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">由于上述原因，我们不会在CSV摘录中看到这些内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/e1d6757e04a7d5b111ef7305d0a49735.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*txiXtp5mcNO_KQpTz1PnIg.png"/></div></figure><p id="f517" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">5.后来出现了众所周知的SELECT语句，为了尊重字符串格式，使用了一组双单引号。对于我们虚构的包含[FirstName]和[LastName]列的表，这会给出:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="293c" class="nn la it nj b gy no np l nq nr">SET @query = N'<br/>SET NOCOUNT ON<br/>SELECT <br/>''FirstName'' as FirstName,<br/>''LastName'' as LastName</span></pre><p id="cf58" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">请注意，在这种情况下，我们没有引用表，我们只是准备CSV导出的标题。</p><p id="d6c8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">6.然后，我们将上述语句的结果与第二个语句产生的数据(即表中的数据)结合起来:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="70fd" class="nn la it nj b gy no np l nq nr">UNION</span><span id="b86a" class="nn la it nj b gy nt np l nq nr">SELECT<br/>[FirstName] AS [FirstName],<br/>[LastName] AS [LastName]<br/>FROM [myDatabase].[dbo].[Users]</span></pre><p id="d390" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">7.然后，我们通过关闭NOCOUNT语句来关闭这个字符串</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="38f5" class="nn la it nj b gy no np l nq nr">SET NOCOUNT OFF'</span></pre><p id="5737" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">8.因此，第一部分看起来像这样:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="f74a" class="nn la it nj b gy no np l nq nr">CREATE PROCEDURE &lt;Procedure_Name, sysname, ProcedureName&gt;<br/>AS<br/>BEGIN</span><span id="fdb7" class="nn la it nj b gy nt np l nq nr">DECLARE @query NVARCHAR(MAX)</span><span id="6528" class="nn la it nj b gy nt np l nq nr">SET @query = N'<br/>SET NOCOUNT ON</span><span id="c9ce" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">SELECT <br/>''FirstName'' as FirstName,<br/>''LastName'' as LastName</strong></span><span id="d7d4" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">UNION</strong></span><span id="a9c6" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">SELECT<br/>[FirstName] AS [FirstName],<br/>[LastName] AS [LastName]<br/>FROM [myDatabase].[dbo].[Users]<br/>SET NOCOUNT OFF'</strong></span></pre><p id="664b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">9.在这个阶段，尝试运行从“DECLARE”开始并以“SET NOCOUNT OFF”语句结束的代码是一个很好的做法。因为它是字符串变量的一部分，任何打字错误、多余或丢失的逗号都不会被SSMS IDE高亮显示。</p><p id="050d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">要测试它，复制以粗体突出显示的部分，并将其粘贴到一个新屏幕上。对于第一个select语句，从列名的每一端删除一个单引号。然后运行该语句。它应该会返回表。</p><p id="1298" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">10.然后，我们将利用SSMS函数发送一封电子邮件，并提供参数信息，将这些数据添加为CSV附件。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="f455" class="nn la it nj b gy no np l nq nr">EXEC msdb.dbo.sp_send_dbmail</span><span id="005d" class="nn la it nj b gy nt np l nq nr">@profile_name= 'Reporting Team',</span><span id="d09f" class="nn la it nj b gy nt np l nq nr">@recipients= 'max@medium.org',</span><span id="e210" class="nn la it nj b gy nt np l nq nr">@subject= 'Names CSV export',</span><span id="f88f" class="nn la it nj b gy nt np l nq nr">@body= 'Hello, &lt;br&gt;&lt;br&gt; Please find attached your CSV export &lt;br&gt;&lt;br&gt; Reporting Team',</span><span id="5619" class="nn la it nj b gy nt np l nq nr">@body_format = 'HTML',</span></pre><p id="3a27" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">第一部分很简单，我们提供了概要文件名称、收件人、主题、正文……如果需要的话，大部分参数都可以添加变量。在我们的例子中，我们提供了一些硬编码的虚拟值。添加您的电子邮件地址，以确保您将获得该文件。</p><p id="e9c6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">接下来是有趣的部分:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="28c3" class="nn la it nj b gy no np l nq nr">@query = @query,</span><span id="ca71" class="nn la it nj b gy nt np l nq nr">@attach_query_result_as_file = 1,</span><span id="2fd1" class="nn la it nj b gy nt np l nq nr">@query_attachment_filename = 'ExportResults.csv',</span><span id="9db1" class="nn la it nj b gy nt np l nq nr">@query_result_separator = ',',</span><span id="cacc" class="nn la it nj b gy nt np l nq nr">@exclude_query_output = 1,</span><span id="5d0d" class="nn la it nj b gy nt np l nq nr">@query_result_header = 1,</span><span id="5d6b" class="nn la it nj b gy nt np l nq nr">@query_no_truncate = 1,</span><span id="0fc2" class="nn la it nj b gy nt np l nq nr">@query_result_no_padding = 0,</span><span id="9354" class="nn la it nj b gy nt np l nq nr">@query_result_width = 8192</span><span id="8a5d" class="nn la it nj b gy nt np l nq nr">END</span></pre><p id="f48c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">在上面，我们首先向查询参数提供NVARCHAR字符串，并定义将附加一个文件及其名称。然后我们可以定义分隔符。其他参数确保导出的CSV精简、干净，具有最大宽度且没有填充。</p><p id="b98c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">因此，概括地说，我们在这个过程中的整个代码是:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="5545" class="nn la it nj b gy no np l nq nr">CREATE PROCEDURE &lt;Procedure_Name, sysname, ProcedureName&gt;<br/>AS<br/>BEGIN</span><span id="a85b" class="nn la it nj b gy nt np l nq nr">DECLARE @query NVARCHAR(MAX)</span><span id="1138" class="nn la it nj b gy nt np l nq nr">SET @query = N'<br/>SET NOCOUNT ON</span><span id="361e" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">SELECT <br/>''FirstName'' as FirstName,<br/>''LastName'' as LastName</strong></span><span id="c265" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">UNION</strong></span><span id="28d9" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">SELECT<br/>[FirstName] AS [FirstName],<br/>[LastName] AS [LastName]<br/>FROM [myDatabase].[dbo].[Users]<br/>SET NOCOUNT OFF'</strong></span><span id="af32" class="nn la it nj b gy nt np l nq nr">EXEC msdb.dbo.sp_send_dbmail<br/>@profile_name= 'Reporting Team',<br/>@recipients= 'max@medium.org',<br/>@subject= 'Names CSV export',</span><span id="a1ac" class="nn la it nj b gy nt np l nq nr">@body= 'Hello, &lt;br&gt;&lt;br&gt; Please find attached your CSV export &lt;br&gt;&lt;br&gt; Reporting Team',</span><span id="71b9" class="nn la it nj b gy nt np l nq nr">@body_format = 'HTML',<br/>@query = @query,<br/>@attach_query_result_as_file = 1,<br/>@query_attachment_filename = 'ExportResults.csv',<br/>@query_result_separator = ',',<br/>@exclude_query_output = 1,<br/>@query_result_header = 1,<br/>@query_no_truncate = 1,<br/>@query_result_no_padding = 0,<br/>@query_result_width = 8192</span><span id="42ab" class="nn la it nj b gy nt np l nq nr">END</span></pre><p id="3e38" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">让我们从头到尾选择代码并运行它…一封附有文件的电子邮件应该正在进行中！</p><h2 id="d2cb" class="nn la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">公地臭虫</h2><p id="2a8e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">上面的内容可能非常强大，但实现起来需要一些耐心，因为错误可能隐藏在我们开始时声明的查询字符串中，而这些通常不会被SSMS IDE发现。</p><ul class=""><li id="cb18" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">单引号太少或太多，例如</li></ul><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="be5b" class="nn la it nj b gy no np l nq nr">''FirstName' as FirstName,</span></pre><ul class=""><li id="5b26" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">逗号太多或缺失(尤其是在UNION语句之前复制粘贴了大量并调整了行的情况下)，例如</li></ul><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="ccfe" class="nn la it nj b gy no np l nq nr">''FirstName' as FirstName,<br/>''LastName'' as LastName,<br/>UNION</span></pre><ul class=""><li id="d41e" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">应该转换为VARCHAR的日期时间格式，例如</li></ul><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="a1b3" class="nn la it nj b gy no np l nq nr"><strong class="nj iu">-- REPLACE THIS</strong></span><span id="f68c" class="nn la it nj b gy nt np l nq nr">...<br/>[BirthDate],<br/>...</span><span id="fd91" class="nn la it nj b gy nt np l nq nr"><strong class="nj iu">-- BY THIS</strong></span><span id="d565" class="nn la it nj b gy nt np l nq nr">...<br/>CAST([BirthDate] AS VARCHAR),<br/>...</span></pre><ul class=""><li id="bdc1" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">确保SELECT语句两边的列数相同，</li><li id="d972" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">再三检查所有提到的列是否确实是您正在查询的表的一部分——这很明显，但仍有可能发生。</li></ul><p id="b695" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如果你还是卡住了:</p><ul class=""><li id="2dd2" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">深呼吸，也许休息一下，</li><li id="70a6" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">从一两列开始，把它做好，然后向上移动到更多列</li><li id="87c7" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">不停地测试，测试，测试😉。</li></ul><p id="14dd" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">一旦得到控制，您就可以将这个过程包含在一个预定的作业中，并通过电子邮件通知您的用户他们很快就会收到该报告🎉。</p><h1 id="54f6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最后的话和接下来会发生什么</h1><p id="17ec" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">暂时就这样吧！我希望您更有信心创建和利用SQL过程来基于底层查询生成和导出CSV文件，然后通过电子邮件将它们发送给用户。</p><ul class=""><li id="2059" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">它可以很好地替代或补充您现有的数据可视化报告，</li><li id="9e6a" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">它可以用作审计工具或证据，每周导出数据库中任何给定时间点的内容，</li><li id="8e9f" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">如果连接到无代码或低代码工具，它也可以被利用，触发器将启动这个SQL过程并向用户提供数据。</li></ul><p id="5790" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">感谢您的阅读，请告诉我您的想法，或者是否有我应该涉及的话题。与此同时，请随时订阅并关注我。下次见！</p><h1 id="737b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">快乐编码🎉！</h1></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="3234" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">感谢阅读！喜欢这个故事吗？<a class="ae ky" href="https://medium.com/@maximegodfroid/membership" rel="noopener"> <strong class="lt iu">加入媒介</strong> </a>可完整访问我的所有故事。</p></div></div>    
</body>
</html>