<html>
<head>
<title>Spotify Artist Recommender</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spotify艺术家推荐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/spotify-artist-recommender-7950af1fe20a?source=collection_archive---------27-----------------------#2021-04-28">https://towardsdatascience.com/spotify-artist-recommender-7950af1fe20a?source=collection_archive---------27-----------------------#2021-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5e51" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用余弦相似度轻松构建智能推荐系统</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2bbf5cd7d9b4087d9892a803639a2956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoZbzny9-ez6V-7RTCEnJg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/photos/music-on-your-smartphone-spotify-1796117" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="3c3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用程序和服务中的推荐系统不再是一个“好东西”。用户现在已经习惯于将此功能作为标准。音频流、视频流、广告、搜索引擎、博客等。仅举几个例子。</p><p id="aa6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说到推荐系统，有一些常见的技术。我最喜欢的技巧是“<strong class="lb iu">余弦相似度</strong>”。很容易理解，速度也很快。即使没有数据科学背景，这个概念也不应该太难理解。</p><p id="7d81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本概念如下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/46bc4d90a65b2b9b6c097838a0b02ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QADpglleZzFIwc9ghGxbGQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d08f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">画出你想要比较的项目的数字表示(上面的A和B ),然后计算点之间的<strong class="lb iu">余弦距离</strong>。背后的理论是距离越小，它们越相似。</p><h1 id="a0dc" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">让我们看一个例子…</h1><h2 id="0262" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">步骤1:确定项目范围</h2><p id="a73b" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">创建一个推荐系统，在Spotify上找到相似的艺术家。</p><h2 id="ea6a" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">第二步:收集数据</h2><p id="c576" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">我在<a class="ae ky" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上下载了数据集“<a class="ae ky" href="https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks" rel="noopener ugc nofollow" target="_blank">Spotify Dataset 1922–2021，~600k曲目</a>”。我将使用的文件名为“<a class="ae ky" href="https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks?select=data_by_artist_o.csv" rel="noopener ugc nofollow" target="_blank"> data_by_artist_o.csv </a>”。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="94b7" class="mo lx it ng b gy nk nl l nm nn">import pandas as pd<br/>import numpy as np</span><span id="9207" class="mo lx it ng b gy no nl l nm nn">from sklearn.metrics.pairwise import cosine_similarity<br/>from sklearn.preprocessing import StandardScaler</span><span id="c867" class="mo lx it ng b gy no nl l nm nn">df_artists = pd.read_csv('./data_by_artist_o.csv', encoding='utf-8')</span><span id="6df3" class="mo lx it ng b gy no nl l nm nn">df_artists.shape</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/c5f860a981fe500957148a96c2f308b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*SuIKHU_nBm8YwVK1CTdk6A.png"/></div></figure><p id="d204" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个数据集有28680首歌曲，有11个特征/列。</p><h2 id="4c67" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">步骤3:清理数据</h2><p id="2e4e" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">数据实际上已经处于很好的状态，没有任何空值。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="ff84" class="mo lx it ng b gy nk nl l nm nn">df_artists.isnull().sum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/e0f5df93f4d0f4b586be72bff238d04b.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*xOq3w8ocTQlYVCYOuZJhnA.png"/></div></div></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="96d9" class="mo lx it ng b gy nk nl l nm nn">df_artists.info()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/01acefbcc9300fdb6a9f3b9f87eaa6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bM25zfc3ClPDZHzl1EC93Q.png"/></div></div></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="3895" class="mo lx it ng b gy nk nl l nm nn">df_artists.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/f24b3ab68db88ce6cb9fa19e9ffdcd49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSi00M2sPWoKAc-6H6rY6w.png"/></div></div></figure><p id="c25d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几个特征是非数字的或者没有真正增加多少价值，所以我们将删除它们。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="04ed" class="mo lx it ng b gy nk nl l nm nn">df_artists.drop(columns={'genres', 'key', 'mode', 'count'}, inplace=True)</span><span id="09fb" class="mo lx it ng b gy no nl l nm nn">df_artists.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/56bb350f3649344636e86be7d38e3eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fr4UIbMYpOL5dSvn8v3RAQ.png"/></div></div></figure><p id="2f89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在面临的问题是，所有这些描述性特征的比例都不同。我们需要对数据进行缩放，以便它们都具有可比性。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="761c" class="mo lx it ng b gy nk nl l nm nn">ss = StandardScaler()</span><span id="dc8e" class="mo lx it ng b gy no nl l nm nn">df_artists_scaled = ss.fit_transform(df_artists)<br/>df_artists_scaled = pd.DataFrame(data=df_artists_scaled, index=df_artists.index, columns=df_artists.columns)</span><span id="ed62" class="mo lx it ng b gy no nl l nm nn">df_artists_scaled.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/5b98e267e9724f23c5be6c5dc67ba03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlQ1IVqN_abvDRme8oGMJw.png"/></div></div></figure><p id="1167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您现在看到的，这些特性都在-1到1的范围内。</p><h2 id="15e1" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">步骤4:探索性数据分析(EDA)</h2><p id="6a2c" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">让我们看看“<strong class="lb iu">艾德·希兰</strong>”作为艺术家是如何工作的。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="0a7d" class="mo lx it ng b gy nk nl l nm nn">artist_array = np.array(df_artists_scaled.T['Ed Sheeran']).reshape(1,-1)<br/>artist_dataset_array = df_artists_scaled.drop(index='Ed Sheeran').values<br/>cosine_similarity(artist_array, artist_dataset_array)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/52331db6de5739ca226f6c68d1544405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Acxgh0zxkBCyuoRJZ6q5uA.png"/></div></div></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="61db" class="mo lx it ng b gy nk nl l nm nn">df_Ed_Sheeran = df_artists.drop(index='Ed Sheeran').copy()<br/>df_Ed_Sheeran['cosim_score'] = cosine_similarity(artist_array, artist_dataset_array).reshape(-1,1)</span><span id="a42b" class="mo lx it ng b gy no nl l nm nn">df_Ed_Sheeran</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/b42c6a9833a283ea97c85f6b0d131db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mxROL9hGPHl_-ZroY7lWUg.png"/></div></div></figure><p id="a729" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看最后新创建的“<strong class="lb iu"> cosim_score </strong>”。这向我们展示了该艺术家与其他艺术家的相似性，使用了“<strong class="lb iu">余弦相似度</strong>”。</p><p id="56e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在有了为自己创建一个方便的函数的构件。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="8fb5" class="mo lx it ng b gy nk nl l nm nn">def get_cosim_artist_df(artist_name, df, n):<br/>    ss = StandardScaler()</span><span id="828f" class="mo lx it ng b gy no nl l nm nn">    df_scaled = ss.fit_transform(df)<br/>    df = pd.DataFrame(data=df_scaled, index=df.index)<br/>    <br/>    artist_array = np.array(df.T[artist_name]).reshape(1,-1)<br/>    dataset_array = df.drop(index=artist_name).values<br/>    <br/>    cosim_scores = cosine_similarity(artist_array, dataset_array).flatten()</span><span id="b03e" class="mo lx it ng b gy no nl l nm nn">artist_names_array = df.drop(index=artist_name).index.values<br/>    <br/>    df_result = pd.DataFrame(<br/>        data = {<br/>            'artist'               : artist_names_array,<br/>            'cosim_' + artist_name : cosim_scores,<br/>        }<br/>    )<br/>    <br/>    df_result = df_result.sort_values(by='cosim_' + artist_name, ascending=False).head(n)    <br/>    return df_result.reset_index(drop=True)</span></pre><p id="5a51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看它的实际效果…</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="91ee" class="mo lx it ng b gy nk nl l nm nn">get_cosim_artist_df('Ed Sheeran', df_artists, 20)</span></pre><p id="852d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们新创建的函数，与“<strong class="lb iu">艾德·希兰</strong>”相似的前20位艺人…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/e4759a8ade612296eb59cc02d565da62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*28RoTp483B2gSDsyfnjcDA.png"/></div></figure><p id="5c6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不得不承认我不认识名单上的大多数艺术家。我打开Spotify，听了余弦相似度超过93%的前三名，我认为它做得相当好。想知道你在评论中的想法会很有趣。</p><h2 id="0b3e" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">结论</h2><p id="b038" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">这种技术不仅限于音频和视频流，这可能是第一个想到的用例。只要你能把你的数据组织成一个数据透视表，这就可以了。我再给你举一个例子供你思考。假设您有一个网站，您想向您的用户推荐页面或文档。您可以创建一个数据透视表，将页面名称或文档标题作为索引(行)，还可以创建一个“标签”列表作为列。如果标签描述了页面或文档，你可以将它标记为0或1，或者如果一些标签比其他标签更重要，甚至可以标记为权重。然后你运行它通过完全相同的过程，因为它会像魅力一样工作。</p><p id="0fca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，我写了一些其他的文章，我想你可能会感兴趣。我正在通过例子解释各种机器学习概念。</p><div class="ny nz gp gr oa ob"><a href="https://levelup.gitconnected.com/predicting-titanic-survivors-using-ml-8570ef4e89e8" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">用最大似然法预测泰坦尼克号幸存者</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op ks ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://levelup.gitconnected.com/predicting-house-sale-prices-using-ml-30b829fd9556" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">用最大似然法预测房价</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ok l"><div class="oq l om on oo ok op ks ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://levelup.gitconnected.com/categorising-using-machine-learning-5601baf9a05e" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">使用机器学习进行分类</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">我通过荣誉退休一直在哥伦比亚工程学习应用机器学习。这是一个5个月的课程，我…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ok l"><div class="or l om on oo ok op ks ob"/></div></div></a></div><p id="e850" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你觉得这篇文章有趣并且有用。如果您想随时了解情况，请不要忘记关注我，注册我的<a class="ae ky" href="https://whittle.medium.com/subscribe" rel="noopener">电子邮件通知</a>。</p><h1 id="2d25" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">迈克尔·惠特尔</h1><ul class=""><li id="f832" class="os ot it lb b lc na lf nb li ou lm ov lq ow lu ox oy oz pa bi translated"><strong class="lb iu"> <em class="pb">如果你喜欢这个，请</em> </strong> <a class="ae ky" href="https://whittle.medium.com/" rel="noopener"> <strong class="lb iu"> <em class="pb">跟我上媒</em> </strong> </a></li><li id="faa0" class="os ot it lb b lc pc lf pd li pe lm pf lq pg lu ox oy oz pa bi translated"><strong class="lb iu"> <em class="pb">更多有趣的文章，请</em> </strong> <a class="ae ky" href="https://medium.com/trading-data-analysis" rel="noopener"> <strong class="lb iu"> <em class="pb">关注我的刊物</em> </strong> </a></li><li id="b195" class="os ot it lb b lc pc lf pd li pe lm pf lq pg lu ox oy oz pa bi translated"><strong class="lb iu"> <em class="pb">有兴趣合作吗？</em> </strong> <a class="ae ky" href="https://www.linkedin.com/in/miwhittle/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="pb">我们上领英</em> </strong> </a>连线吧</li><li id="57cf" class="os ot it lb b lc pc lf pd li pe lm pf lq pg lu ox oy oz pa bi translated"><strong class="lb iu"> <em class="pb">支持我和其他媒体作者</em> </strong> <a class="ae ky" href="https://whittle.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="pb">在此报名</em> </strong> </a></li><li id="872e" class="os ot it lb b lc pc lf pd li pe lm pf lq pg lu ox oy oz pa bi translated"><strong class="lb iu"> <em class="pb">请别忘了为文章鼓掌:)←谢谢！</em>T3】</strong></li></ul></div></div>    
</body>
</html>