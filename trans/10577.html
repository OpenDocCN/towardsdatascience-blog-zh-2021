<html>
<head>
<title>Billiards with Fred the Frequentist and Bayer the Bayesian [Bayer wins :)]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">台球与弗雷德的常客和拜耳的贝叶斯[拜耳赢:)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/billiards-with-fred-the-frequentist-and-bayer-the-bayesian-bayer-wins-7bc95b24a7ef?source=collection_archive---------14-----------------------#2021-10-09">https://towardsdatascience.com/billiards-with-fred-the-frequentist-and-bayer-the-bayesian-bayer-wins-7bc95b24a7ef?source=collection_archive---------14-----------------------#2021-10-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bf99" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我在这里讨论贝叶斯自己的一个实验，它强调了贝叶斯方法的美丽、优雅和正确性，即使频率主义方法给出了不正确的结果。</h2></div><p id="1c02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在1763年死后发表的论文[1]中，Bayes展示了一个例子，其中Frequentist点估计给出了不正确的结果(与实验不匹配)，而Bayes分析给出了与实验匹配的优雅解决方案。本文中的问题确切问题陈述是文献[1][2][3]中的陈述的推广。</p><p id="c6f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我讨论了这个例子，并用colab笔记本[4]链接了推导和蒙特卡罗模拟。</p><h1 id="a479" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">设置</h1><p id="7445" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">不可否认，这个设置有点做作，但我们可以忽略它。让我们在宽度为1的桌子上打一场台球。卡罗尔进来，随机地打了一个台球，当它落在离一面墙p的距离后，她把它藏在了窗帘后面。然后爱丽丝和鲍勃，不知道球的位置，射击他们自己的球，如果一个球落在卡罗尔的球的左边，爱丽丝赢了这一轮(所以概率是p)，如果它在卡罗尔的球的右边结束，那么鲍勃赢了这一轮(所以概率是(1-p))。先得6分的人赢得比赛。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ly"><img src="../Images/102196de2c4e6065be7ed25c655210c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6SOTOBxnjiEHZKJ4"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">图片由<a class="ae mo" href="https://unsplash.com/@kkalerry" rel="noopener ugc nofollow" target="_blank"> Klara Kulikova </a>提供</p></figure><p id="3658" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一些见不得人的角色正在观看这场游戏，当鲍勃在K杆时赢得了nB回合时，他们叫来了常客弗雷德来赌这场游戏。他们请常客弗雷德预测鲍勃赢得比赛的概率。在给了弗雷德频繁主义者多次尝试解决问题，他悲惨地失败了，这些人物听到贝叶斯统计，并邀请你，拜尔贝叶斯显示你的把戏包里有什么。</p><h1 id="662f" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">常客弗雷德如何尝试解决方案</h1><p id="1b63" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">常客Fred首先通过查看Alice获胜的分数来估计p的点数</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/b53ee9639287b70166041c769a28539c.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*ZgNir2Ya_DhXyGfzJw1jAg.png"/></div></figure><p id="3899" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意nA+nB=K。</p><p id="1af7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这之后，Frequentist简单地计算Bob在11-K剩余游戏中赢得至少6-nB的概率(游戏数量永远不能超过11。说服你自己这个论点。)</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi mq"><img src="../Images/55fd6febc7934ebda3254b563f8c05ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*544jqeEYMmRirS7Z_1SbqA.png"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">常客弗雷德对鲍勃获胜概率的回答</p></figure><p id="9125" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们以后会看到他错得有多离谱。</p><h1 id="bc44" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">拜耳贝叶斯如何拯救世界</h1><p id="ca7b" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">在这一点上，你被叫来尝试你的贝叶斯手在这个问题上。你采取了一种非常不同的方法。你知道这一点(如果你不知道这一点，那么你应该考虑一下和/或阅读一下条件概率)</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/3859f323a919e050cb56091b251fd469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*ToOw_wR-kfNrL2ip8rAL2w.png"/></div></figure><p id="9c4a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里发生的是，我们对p的所有可能值进行积分，因为我们不知道它是什么。模型中的这种参数称为讨厌参数。</p><p id="fe47" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在既然Carol均匀采样P P(P)= 1。出于可读性的考虑，我在这里不做数学计算，推导过程可以在我下面引用的github笔记本中找到。</p><p id="b6c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后的表述是</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ms"><img src="../Images/83acc452f93a4d6745d9446eee8aac92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mg-jYFTq9XY3w1MU7Dejpw.png"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">鲍勃获胜概率的贝叶斯答案</p></figure><h1 id="08cf" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">实验</h1><p id="32d0" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">哪个答案是正确的？这是一个非常容易模拟的问题，已经在下面的笔记本中完成了。让我展示几个例子。</p><p id="be78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先注意，如果K=0，那么nB =0，虽然直觉上答案是0.5，Bob会赢，但常客Fred说这是未定义的！</p><p id="b79d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在K=1，2，3，4，5的另一个极端，如果K=nb，Frequentist的点估计给出p=0和PF(B)=1，所以他肯定Bob会赢，但稍加思考就会发现这是不正确的。</p><p id="a4b9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">甚至连常客弗雷德也认为两个答案都不正确，但他不知道该怎么办，而是继续坚持认为其他答案是正确的。</p><p id="431d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，弗雷德不仅在上面两个例子中是错误的，他还经常错误(双关语！).下面比较不同的K和nb，贝叶斯答案如何总是匹配MC(人们看到的小的不匹配来自MC采样中的有限大小效应),并且频率主义者的答案总是错误的，除了当nb=K/2时。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/280eae059179651a47a7c9f26e7c4b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*ET7ko0TE8fAoWfbtBJSI7w.png"/></div></figure><p id="7bbf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">K和nb的其他值的结果可以在上面引用的笔记本[4]中找到。</p><h1 id="dd1a" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">帮助常客弗雷德认识他的错误[高级]</h1><p id="3580" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">那么，常客弗雷德做错了什么？为什么他经常得到错误的答案？让我们再来看看Bayer the Bayesian是如何处理讨厌的参数P的，它可以是从P(p)中提取的任何值(在这种情况下恰好是均匀的)，然后对结果进行积分。另一方面，frequent ist Fred取p=(K-nB)/K，这是P(D|p)的<em class="mt">最大似然估计量</em>，并将其插入P(B|p，D)。现在，这将在可能性非常尖锐的情况下工作(这就是我们物理学家所说的狄拉克δ函数)。然而，事实证明情况并非如此。同行的物理学家将会看到这里与路径积分有很大的相似之处，在量子力学中，对所有路径求和，但在经典极限中，只有一条路径对路径积分有贡献。用这个类比，频率主义者弗雷德在一个问题中使用了经典极限，他应该做量子力学。</p><h1 id="ddab" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">更快的方法</h1><p id="be77" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">在经历了所有的困难之后，让我指出，有一种更简单的方法可以实现这一点，那就是我们所做的是对二项数据的<a class="ae mo" href="https://en.wikipedia.org/wiki/Posterior_predictive_distribution" rel="noopener ugc nofollow" target="_blank">后验预测分布</a>求和，即Bob的相关获胜次数的<a class="ae mo" href="https://en.wikipedia.org/wiki/Beta-binomial_distribution" rel="noopener ugc nofollow" target="_blank">贝塔二项分布</a>。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi mv"><img src="../Images/963599c7c1c3668dcc9b6ad4e6926398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3EeYoExnDRogfj0gNMKkrQ.png"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">鲍勃以文明的方式获胜的概率的贝叶斯答案。</p></figure><h1 id="1804" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">结论</h1><p id="3e59" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">贝叶斯方法更直观，因此更难出错。虽然常客们显然也能得到正确的答案，但要做到这一点却困难得多。虽然关于贝叶斯和频率主义者的哲学辩论将持续很长时间，但在实践层面上，贝叶斯是你最好的选择。</p><h1 id="45a1" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">参考资料:</h1><ol class=""><li id="c52a" class="mw mx iq kh b ki lt kl lu ko my ks mz kw na la nb nc nd ne bi translated">T.贝叶斯。一篇解决机会主义中一个问题的论文。伦敦皇家学会哲学汇刊53(0):370–418，1763</li><li id="7eee" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated">艾迪先生。什么是贝叶斯统计？。自然生物技术22:1177–1178，2004</li><li id="8329" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated">关于使用Python的贝叶斯统计的非常好的介绍。我自己的例子是对这个例子的概括，最初的引用来自贝叶斯<a class="ae mo" href="https://arxiv.org/pdf/1411.5018.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1411.5018.pdf</a></li><li id="b101" class="mw mx iq kh b ki nf kl ng ko nh ks ni kw nj la nb nc nd ne bi translated">我的笔记本<a class="ae mo" href="https://github.com/borundev/DNN_Lectures/blob/master/Bayesian_Pool.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/borundev/DNN _讲座/blob/master/Bayesian _ pool . ipynb</a></li></ol></div></div>    
</body>
</html>