<html>
<head>
<title>Deriving the Normal Equation for Ordinary Least Squares.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推导普通最小二乘法的正规方程。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ordinary-least-squares-ols-deriving-the-normal-equation-8da168d740c?source=collection_archive---------16-----------------------#2021-07-12">https://towardsdatascience.com/ordinary-least-squares-ols-deriving-the-normal-equation-8da168d740c?source=collection_archive---------16-----------------------#2021-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4c59" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这将比你想象的要简单。</h2></div><p id="21e4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">OLS无疑是最基本的机器学习算法之一。这个想法真的很简单，给定一个数据集，该算法寻求找到超平面，该超平面使从超平面到数据集中每个点的<strong class="ki ir">偏移</strong>的、<strong class="ki ir">平方和</strong>最小化。</p><p id="bf14" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">慢慢读最后一句话，考虑超平面</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/052123535b03cacf9a05369b1e420170.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*SU6TcMHaAaYI5lBcSBG7KA.png"/></div></figure><p id="3ab1" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们可以将损失函数推导为</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/fa9c7c24f4ed8ab09367898637ff7285.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*8QTjHWcAmiuHy--ClGfufw.png"/></div></figure><p id="fea4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">其中<strong class="ki ir"> ( <em class="ll"> x </em> ᵢ <em class="ll">，y </em> ᵢ) </strong>为数据集中的一个元素(观察值)<em class="ll"> m </em>为其长度。</p><p id="96f9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">足够幸运的是，这只有一个极小值，也就是说有一个唯一的</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/609648575d93ed620908417505b44a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*6tprWv7tYNYyZbcWOM1NPg.png"/></div></figure><p id="669d" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这绝对最小化了数量，前提是<em class="ll"> m &gt; n，</em>否则我们的数据集非常小，损失明显为零，没有唯一的极小值。</p><p id="e3e7" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这篇文章的存在理由是为了推导出OLS问题的封闭解，也称为正规方程，为此，我们将使用一点矩阵微积分(以及一些矩阵代数),这将使我们的推导过程更加简单。</p><p id="862f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">特别是，我们会对以下身份感兴趣:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/eb70dbb6bad79ed0d5fda0757e9b6e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*ZaLPndumH8zpIQJL0GnMXQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">你可以在维基百科的矩阵微积分页面上找到这个</p></figure><p id="8bf1" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">其涉及相对于向量对标量进行微分，并且可用于通过向量微分恒等式导出<a class="ae ls" href="https://www.youtube.com/watch?v=A5mUplxPvVY&amp;list=PLhcN-s3_Z7-YS6ltpJhjwqvHO1TYDbiZv&amp;index=6" rel="noopener ugc nofollow" target="_blank">许多其他</a>标量。现在很清楚，设置A=I和v=u 我们得到</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/5b4f7113fbfef5f287dbb5b84290f04a.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*vmclqs6Za0cCh3GtOOzMZA.png"/></div></div></figure><p id="7750" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">尽管从基本原理出发推导这个恒等式并不困难，但在寻找封闭形式或与其他算法(如迭代加权最小二乘法和最小绝对偏差)相关的迭代方案时，前面给出的一般恒等式将被证明更加有用，因此最好将其作为起点。现在让我们和OLS一起行动吧。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ly"><img src="../Images/7f5acd87e0aacaf869d6c006010756bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lxnj88gFP_zSiUJ3B3_rw.jpeg"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">照片由<a class="ae ls" href="https://unsplash.com/@shubhamsharan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">舒巴姆·莎兰</a>在<a class="ae ls" href="https://unsplash.com/s/photos/calculus?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="6b60" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">让我们从写作开始</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/fa9c7c24f4ed8ab09367898637ff7285.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*8QTjHWcAmiuHy--ClGfufw.png"/></div></figure><p id="2a5a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如同</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/94d41acd2e4c7da85b2a4178fabf3bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*kcueRb2jXB7s9reHIAUPyw.png"/></div></figure><p id="2eab" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">注意J看起来没有那么弯曲，为了进一步用矩阵形式写出来，我们有</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/74bc545c624608be6192fc41527c6893.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*Yg4GbeuCHzn5si8xOwXUTw.png"/></div></figure><p id="3a90" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><em class="ll">其中Y </em>是一个列向量，所有的<em class="ll"> yᵢ' </em>都在我们的数据集中，并且每个对应的行向量<em class="ll"> xᵢ </em>都位于矩阵<em class="ll"> X. T </em>中。为了最小化这样的损失函数，我们需要将它(标量)相对于θ(向量)进行微分，并将其设置为零。</p><p id="db83" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">利用这个身份，我们有了</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/e5299a73cdedfc3a9fce532ca26275c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*zMeCanbZ1Va-7A0LpKW3Bw.png"/></div></figure><p id="5ec4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">右边的项通过分布微分算子，以<em class="ll"> Y </em>和<em class="ll"> X </em>为常数，得到<em class="ll"> -X </em></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/159057596fa08ad63bd95f9ec18b2f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*RsLSQeVL25lI5UDda7eXSQ.png"/></div></figure><p id="f887" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">两边都除以-2，然后交换两边，我们得到</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi md"><img src="../Images/629fc5b499657e6d51631911b1a16100.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*h7brn4rWFtAJ411oQ1VipQ.png"/></div></figure><p id="fec3" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">使用基本的矩阵代数</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi me"><img src="../Images/75cbdac60d67ad151dff6b69ce7c6113.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*iwL6bitI3U-Qm1QcjzOg7A.png"/></div></figure><p id="0797" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">最后求解θ来完善我们得到的结果</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/701cb63e5d36ecce625e4c40879888a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*-znX2CsTOdtgPu4qX_sSPw.png"/></div></figure><p id="7200" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这就是标准方程。给定一个数据集，它归结为简单地构造矩阵<em class="ll"> X </em>和向量<em class="ll"> Y </em>，然后插入封闭形式，以简单地找到最佳地最小化损失函数的超平面的系数，也就是说，一旦我们有θ，我们就可以使用该超平面</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/052123535b03cacf9a05369b1e420170.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*SU6TcMHaAaYI5lBcSBG7KA.png"/></div></figure><p id="f021" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">基于特征<em class="ll"> x，</em>的值来推断<em class="ll"> y </em>的合适值，这总体上是一个合适的机器学习模型，特别是如果你的数据集幸运地遵循或接近线性趋势。</p><p id="5bcb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">希望这篇文章对你有所帮助，也希望你考虑给它一些掌声作为回报。下次见，再见。</p><p id="137e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">参考资料:</p><p id="a3eb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">[1]:舒巴姆莎兰。(2019年6月21日)。搜索了“微积分”。<a class="ae ls" href="https://unsplash.com/photos/Z-fq3wBVfMU" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/Z-fq3wBVfM</a></p></div></div>    
</body>
</html>