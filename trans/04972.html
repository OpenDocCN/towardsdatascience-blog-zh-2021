<html>
<head>
<title>3x times faster Pandas with PyPolars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带PyPolars的熊猫速度快3倍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3x-times-faster-pandas-with-pypolars-7550e605805e?source=collection_archive---------3-----------------------#2021-05-01">https://towardsdatascience.com/3x-times-faster-pandas-with-pypolars-7550e605805e?source=collection_archive---------3-----------------------#2021-05-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f2ae" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用PyPolars库加速您的熊猫工作流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bb72613b1fc4b20a1b23155565393379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEueG5SK4GkXh9zsNo17Gg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@punttim?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">蒂姆·高</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4f49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是数据科学家用来处理数据的最重要的Python包之一。Pandas库主要用于数据探索和可视化，因为它带有大量内置函数。Pandas无法处理大规模数据集，因为它无法在CPU的所有核心之间扩展或分布其进程。</p><p id="0695" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了加快计算速度，可以利用CPU的所有内核来加快工作流程。有各种各样的开源库，包括Dask、Vaex、Modin、Pandarallel、PyPolars等，它们可以在CPU的多个内核上并行化计算。在本文中，我们将讨论PyPolars库的实现和使用，并将其性能与Pandas库进行比较。</p><h1 id="56f6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">PyPolars是什么？</h1><p id="04ed" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">PyPolars是一个类似熊猫的开源Python数据框库。PyPolars利用CPU的所有可用内核，因此执行计算的速度比Pandas更快。PyPolars有一个类似熊猫的API。它是用rust和Python包装器编写的。</p><blockquote class="ms"><p id="90f4" class="mt mu it bd mv mw mx my mz na nb lu dk translated">理想情况下，当数据对熊猫来说太大而对Spark来说又太小时，就使用PyPolars</p></blockquote><h2 id="476a" class="nc lw it bd lx nd ne dn mb nf ng dp mf li nh ni mh lm nj nk mj lq nl nm ml nn bi translated">PyPolars是如何工作的？</h2><p id="8621" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">PyPolars库有两个API，一个是Eager API，一个是Lazy API。Eager API和熊猫的很像，执行完成后马上产生结果类似熊猫。Lazy API非常类似于Spark，在Spark中，在执行查询时会形成一个映射或计划。然后，在CPU的所有核心上并行执行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d79d85e6628eb7152cf80c1eccb40324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QjVD0WFCRlZJCLL8SSxKGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，PyPolars API的</p></figure><p id="b450" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PyPolars基本上是作为python绑定到Polars库的。PyPolars库最好的部分是它与Pandas的API相似性，这使得开发人员更容易使用它。</p><h2 id="a870" class="nc lw it bd lx nd np dn mb nf nq dp mf li nr ni mh lm ns nk mj lq nt nm ml nn bi translated">安装:</h2><p id="2d6b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">PyPolars可以使用以下命令从PyPl安装:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="e333" class="nc lw it nv b gy nz oa l ob oc"><strong class="nv iu">pip install py-polars</strong></span></pre><p id="477f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并使用以下命令导入库</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="12ed" class="nc lw it nv b gy nz oa l ob oc"><strong class="nv iu">import pypolars as pl</strong></span></pre><h2 id="5ef0" class="nc lw it bd lx nd np dn mb nf nq dp mf li nr ni mh lm ns nk mj lq nt nm ml nn bi translated">基准时间限制:</h2><blockquote class="od oe of"><p id="fcaa" class="kz la og lb b lc ld ju le lf lg jx lh oh lj lk ll oi ln lo lp oj lr ls lt lu im bi translated">为了进行演示，我使用了一个包含2500万个实例的大型数据集(~6.4Gb)。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/635e021955fcb72a0ba9df3a8e006acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DJ28uvzxWUcF7FViFS0wJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，熊猫和Py-Polars基本操作的基准时间数</p></figure><p id="8b6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于使用Pandas和PyPolars库的一些基本操作的上述基准时间数，我们可以观察到PyPolars几乎比Pandas快2到3倍。</p><p id="815e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道PyPolars有一个与熊猫非常相似的API，但仍然没有涵盖熊猫的所有功能。例如，PyPolars中没有<code class="fe ol om on nv b"><strong class="lb iu">.describe()</strong></code> <strong class="lb iu"> </strong>函数，我们可以使用<code class="fe ol om on nv b"><strong class="lb iu">df_pypolars.to_pandas().describe()</strong></code></p><h2 id="c250" class="nc lw it bd lx nd np dn mb nf nq dp mf li nr ni mh lm ns nk mj lq nt nm ml nn bi translated">用法:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(作者代码)</p></figure><h1 id="299b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论:</h1><p id="ec81" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们对PyPolars库做了一个简单的介绍，包括它的实现、用法，以及将它的基准时间数与Pandas的一些基本操作进行比较。请注意，PyPolars的工作方式非常类似于Pandas，PyPolars是一个高效的内存库，因为它所支持的内存是不可变的。</p><p id="8cdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人们可以通过浏览文档来详细了解这个库。有各种各样的其他开源库可以并行处理Pandas操作并加速这个过程。阅读下面提到的<a class="ae ky" rel="noopener" target="_blank" href="/4-libraries-that-can-parallelize-the-existing-pandas-ecosystem-f46e5a257809">文章</a>了解4个这样的图书馆:</p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/4-libraries-that-can-parallelize-the-existing-pandas-ecosystem-f46e5a257809"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">4个库可以并行处理现有的Pandas生态系统</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">使用这些框架通过并行处理来分配Python工作负载</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ks ot"/></div></div></a></div><h1 id="9d28" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考资料:</h1><p id="0761" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">[1] Polars文档和GitHub库:【https://github.com/ritchie46/polars T4】</p><blockquote class="ms"><p id="ef7a" class="mt mu it bd mv mw mx my mz na nb lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>