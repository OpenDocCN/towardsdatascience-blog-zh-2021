<html>
<head>
<title>Step by step create SQL tables in a relational database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逐步在关系数据库中创建SQL表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/step-by-step-sql-table-creation-in-a-relational-database-554926d9ce3c?source=collection_archive---------14-----------------------#2021-03-22">https://towardsdatascience.com/step-by-step-sql-table-creation-in-a-relational-database-554926d9ce3c?source=collection_archive---------14-----------------------#2021-03-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2e1e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">初学者教程，学习创建带有主键和外键的关系表的艺术</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/6d726a3193bed3c18d725a363aa12702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7jceOvZ5rsGofkd5tBrEQ.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@dipstories?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">迪米特拉·佩帕</a>在<a class="ae kz" href="https://unsplash.com/s/photos/tables?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a733" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">大量SQL教程向您展示了如何查询和连接数据库中的表，以提取有用的信息。这些教程基于<strong class="lc iu">假设已经创建了表，并且表之间的关系已经建立… </strong>对于从零开始的人来说，情况并非如此！本文将展示如何从空白脚本开始。我们将建立一个非常简单的数据库，其中有三个相互关联的表:病人-医生-医院。</p><h2 id="f434" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">您将在本文中发现:</h2><ul class=""><li id="1836" class="mp mq it lc b ld mr lg ms lj mt ln mu lr mv lv mw mx my mz bi translated">如何在SQL中创建表</li><li id="9352" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">如何在表中添加唯一标识符</li><li id="5f87" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">如何使用主键和外键关联表</li><li id="733e" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">如何用真实数据填充表格</li></ul></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="be4c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果您还不是会员，请在此获得您的中级会员资格<a class="ae kz" href="https://medium.com/@alejandra.vlerick/membership" rel="noopener">！</a></p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h2 id="3a2f" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">需要了解的几个有用的首字母缩写词:</h2><p id="4eb3" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated"><strong class="lc iu">什么是RDBs: </strong>关系数据库(<strong class="lc iu"> RDB </strong>)是由表、记录和列组成的多个数据集的集合。</p><p id="398c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">什么是SQL: </strong> SQL是一种用于编程的特定领域语言，旨在管理关系数据库管理系统中的数据</p><p id="1a40" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">什么是表:</strong>在关系数据库中保存数据的数据库对象</p><h2 id="be5a" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated"><strong class="ak">用户故事</strong></h2><p id="1b67" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">一个人走进医院，马上就会被联系到一个医生。当发现一种疾病或状况时，病人会得到一种药物并被送回家。至少这是我们今天要讨论的最好的情况。同样，每个医生在医院的特定部门工作。显然，一个医生可以为多家医院甚至多个部门工作，但是对于这个用例，我们将假设只有一个可能的值。</p><p id="c58d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">因此，我们可以说<strong class="lc iu">病人表链接到医生表，医生表链接到医院表</strong>。间接地，病人通过分配给他们的医生与医院有联系。</p><h2 id="96c6" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">在开始创建表的代码和语法之前，让我们看一下最终结果。</h2><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi np"><img src="../Images/373f01925e5e98ca90a0b36fc3813c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jBSUcN2ZImprbMbD-u6H2g.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">存储在关系数据库中的表及其</p></figure><h2 id="62e9" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated"><strong class="ak">第一步:创建表格</strong></h2><p id="7e09" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">在SQL语言中，我们使用以下语法创建一个表:</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="2a74" class="lw lx it nr b gy nv nw l nx ny">create table patient<br/> (<br/>    name varchar,<br/>    lastname varchar,<br/>    hospital int,<br/>    id serial,<br/>    primary_doctor int<br/> );<br/> <br/> create unique index patient_id_uindex<br/>    on patient (id);<br/> <br/> alter table patient<br/>    add constraint patient_pk<br/>       primary key (id);</span></pre><h2 id="0ea3" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">让我们将代码分解成小的逻辑步骤:</h2><p id="eece" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">该查询有三个主要部分:</p><ol class=""><li id="8ee9" class="mp mq it lc b ld le lg lh lj nz ln oa lr ob lv oc mx my mz bi translated"><strong class="lc iu"> <em class="od">创建表格</em> </strong></li></ol><p id="e4ae" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这将创建一个表，其中包含我们希望该表包含的所有列和存储的信息类型。首先给列一个名称，然后给它们存储一个<strong class="lc iu">数据类型</strong>。<strong class="lc iu"> Integer </strong>，<strong class="lc iu"> serial </strong>(顺序整数)，varchar(一串字/秒)。</p><p id="4d67" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">2.<strong class="lc iu"> <em class="od">创建唯一索引</em> </strong></p><p id="c1cf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这表明在第一步中刚刚创建的列<strong class="lc iu"> <em class="od"> id </em> </strong>只能取<strong class="lc iu">唯一值</strong>。这是什么意思？任何两个患者都不能有相同的标识符。将这个约束添加到病人的id中是有意义的，否则同名的人可能会混淆。</p><p id="eee7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">3.<strong class="lc iu"> <em class="od">涂改表</em> </strong></p><p id="66c1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最后，我们取同一个<strong class="lc iu"> <em class="od"> id </em> </strong>列，我们给它分配<strong class="lc iu">主键</strong>的角色。当一列中的值是唯一的并且是整数形式时，我们只能将该列指定为主键。在我们的例子中，“patient_pk”代表患者主键。</p><p id="e32c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">SQL表不需要主键，但它是保持数据整洁和跟踪每个条目的有用功能。</p><p id="0526" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对医院和医生表重复相同的过程。</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="2788" class="lw lx it nr b gy nv nw l nx ny">create table doctor<br/> (<br/>    name varchar,<br/>    hospital varchar,<br/>    id serial<br/> );<br/><br/><br/>create unique index doctor_id_uindex<br/>   on doctor (id);<br/><br/>alter table doctor<br/>   add constraint doctor_pk<br/>      primary key (id);</span></pre><p id="f653" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">创建存储医院信息的表:</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="99db" class="lw lx it nr b gy nv nw l nx ny">create table hospital<br/>(<br/>   name varchar,<br/>   id serial<br/>);<br/><br/>create unique index hospital_id_uindex<br/>   on hospital (id);<br/><br/>alter table hospital<br/>   add constraint hospital_pk<br/>      primary key (id);</span></pre><h1 id="7fbb" class="oe lx it bd ly of og oh mb oi oj ok me jz ol ka mh kc om kd mk kf on kg mn oo bi translated"><strong class="ak">第二步:通过<em class="ki">外键</em>和主键</strong>关联表</h1><p id="4b62" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">目前，我们只有三个相互独立的表，不知道其他表的存在。让我们通过添加<strong class="lc iu"> <em class="od">外键</em> </strong>来设置表之间的关系。</p><p id="17e1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这方面的代码如下:</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="0ad5" class="lw lx it nr b gy nv nw l nx ny">alter table patient<br/>   add constraint patient_doctor_id_fk<br/>      foreign key (primary_doctor) references doctor (id);</span></pre><h2 id="6b07" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">让我们把它分成三个步骤:</h2><p id="073b" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">1.<strong class="lc iu"> Alter table </strong>:由于表已经被创建，我们需要改变它的当前状态来添加一个外键。</p><p id="470c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">2.<strong class="lc iu">添加约束</strong>:用于指定表格中数据的规则。这就是我们给将要做的事情命名的地方。在这种情况下，添加一个外键。</p><p id="e05f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">3.<strong class="lc iu">外键</strong>:这里我们指定我们取列"<em class="od"> primary_doctor </em>"并将其与doctor表中的"<em class="od"> id </em>"列相关联。这样，当我们向某个医生添加一个患者时，这两个表会立即链接起来，我们可以在输入患者时搜索医生信息，反之亦然。</p><p id="c746" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">类似地，要链接医生表和医院表:</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="52d7" class="lw lx it nr b gy nv nw l nx ny">alter table doctor<br/><br/>   add constraint doctor_hospital_id_fk<br/><br/>      foreign key (hospital) references hospital (id);</span></pre><h1 id="257f" class="oe lx it bd ly of og oh mb oi oj ok me jz ol ka mh kc om kd mk kf on kg mn oo bi translated">用真实的医院、患者和医生信息填充表格</h1><p id="1b4c" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">当开始填充数据时，我们需要非常注意填充的顺序。至少对于这个初级教程来说，我建议您从填充医院表开始，然后是医生，最后是病人。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi op"><img src="../Images/c7741da49aef9cf68491bace21437628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uK5IsXyo_GvpNMt7L4h9cw.png"/></div></div></figure><p id="80ae" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这样做的原因是因为在查看表之间的关系时，医院可以自己袖手旁观。当我们添加新医院时，不需要其他患者或医生的信息。而医生和病人之间存在依赖关系。</p><h2 id="1f08" class="lw lx it bd ly lz ma dn mb mc md dp me lj mf mg mh ln mi mj mk lr ml mm mn mo bi translated">向表中添加新医院</h2><p id="7efc" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">在本例中，我们需要提供的唯一值是医院名称/位置。<em class="od"> id </em>列由SQL在后台自动填充。第一个条目将具有id =1，并且每个新条目增加1。</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="2e15" class="lw lx it nr b gy nv nw l nx ny">INSERT INTO hospital (location) VALUES ('Johns Hopkins')</span></pre><p id="ebf8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在我们有了一家医院，我们可以在医生表中添加一名医生。在这里，我们提供医生的姓名、工作部门和医院的id。这是直接引用医院的表。在本例中，id = 1，因此我们引用上面创建的约翰霍普金斯医院。</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="edee" class="lw lx it nr b gy nv nw l nx ny">INSERT INTO doctor (full_name, department, hospital) VALUES ('alex','dermatology', 1)</span></pre><p id="2553" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最后我们可以插入到患者表中。就像我们对于医生一样，第一列表示每个患者的特征值，最后我们添加与该患者相关联的医生的id。</p><pre class="kk kl km kn gt nq nr ns nt aw nu bi"><span id="2a86" class="lw lx it nr b gy nv nw l nx ny">INSERT INTO patient (name, age, gender, entry_date, primary_doctor) VALUES ('james','85', 'M', '01/01/1982', 1 )</span></pre><p id="8016" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">就是这样！</strong>确保在添加新患者和新医生时，只插入表中已经存在的外键值。当表中只注册了3名医生时，不要创建主医生id = 7的患者…</p><h1 id="601c" class="oe lx it bd ly of og oh mb oi oj ok me jz ol ka mh kc om kd mk kf on kg mn oo bi translated">一些陷阱:</h1><ul class=""><li id="06b6" class="mp mq it lc b ld mr lg ms lj mt ln mu lr mv lv mw mx my mz bi translated">一个病人有多个医生会怎么样？</li><li id="7e5e" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">一个医生在多家医院工作会怎么样？</li><li id="b34e" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">病人定期去医院会怎么样？</li></ul><p id="9214" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们是否将它们注册到一个新行中，并因此分配一个新的惟一id？我们是否将多个条目与同一个患者/医生相关联？但是，这如何与唯一主键约束保持一致呢？</p><p id="e6ab" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对于更高级的SQL用户来说，这些都是非常好的问题。现在，我鼓励您用一些简单的例子创建自己的小表结构。</p><h1 id="b5b1" class="oe lx it bd ly of og oh mb oi oj ok me jz ol ka mh kc om kd mk kf on kg mn oo bi translated">让你开始的想法</h1><p id="e4c9" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">使用上面提供的代码尝试这些关系。这是真正测试您对SQL和关系数据库的理解的最佳方式。祝你好运！</p><ul class=""><li id="edbf" class="mp mq it lc b ld le lg lh lj nz ln oa lr ob lv mw mx my mz bi translated">学生—教师—教室</li><li id="2677" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">足球运动员—球队—进球</li><li id="5903" class="mp mq it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">产品—商店—购买</li></ul><h1 id="adde" class="oe lx it bd ly of og oh mb oi oj ok me jz ol ka mh kc om kd mk kf on kg mn oo bi translated">非常感谢你的阅读！</h1><p id="7118" class="pw-post-body-paragraph la lb it lc b ld mr ju lf lg ms jx li lj nm ll lm ln nn lp lq lr no lt lu lv im bi translated">更多类似的文章，请点击在<a class="ae kz" href="https://towardsdatascience.com/medium.com/@alejandra.vlerick" rel="noopener" target="_blank">媒体上找到我。</a></p><p id="1885" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果您有任何关于如何改进的<strong class="lc iu">问题</strong>、<strong class="lc iu">建议</strong>或<strong class="lc iu">想法</strong>，请在下面留下评论或通过LinkedIn <a class="ae kz" href="https://www.linkedin.com/in/alejandra-g-283595b8" rel="noopener ugc nofollow" target="_blank">这里</a>取得联系。</p></div></div>    
</body>
</html>