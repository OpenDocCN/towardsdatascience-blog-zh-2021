<html>
<head>
<title>Fit Non-Linear Relationship Using Generalized Additive Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用广义加性模型拟合非线性关系</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fit-non-linear-relationship-using-generalized-additive-model-53a334201b5d?source=collection_archive---------18-----------------------#2021-11-17">https://towardsdatascience.com/fit-non-linear-relationship-using-generalized-additive-model-53a334201b5d?source=collection_archive---------18-----------------------#2021-11-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="42e8" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">利用pyGAM包</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/b25d11f63c1f4a8be6bc53ca79c12930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K8k3vk0mBrUiWB4tj2dq2Q.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://unsplash.com/photos/s03sK2VLNpc" rel="noopener ugc nofollow" target="_blank"> unsplash </a></p></figure><blockquote class="la lb lc"><p id="7afd" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">简介</strong></p></blockquote><p id="2abf" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">各种变量之间的真实世界关系大多是非线性的，理解这种关系对于最佳预测是至关重要的。谁有这种关系的洞察力，谁就能正确预测市场，并为任何低迷做好准备。它不仅对商业分析至关重要，对临床研究、社会研究、工程应用等也同样重要。在本文中，我将向读者介绍广义可加模型(GAM)的实现，并与线性、多项式和样条回归模型进行比较。读者就能理解它对正确预测未来趋势的重要性。</p><blockquote class="la lb lc"><p id="2c8d" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">简要背景</strong></p></blockquote><p id="c4a7" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">线性和多项式回归是回归分析的基础。对于非线性关系，多项式拟合工作得非常好，并且当存在对过度拟合的优化时，可以预见下一个数据点。过度拟合是机器学习爱好者的噩梦。当多项式过度拟合局部数据点时，它在进行预测时会变得混乱。基本上，过度拟合的模型不能正确预测，并且在应用测试数据时表现不佳。在这些情况下，线性模型可以是一个很好的替代品，并且可以降低误差。对于回归模型，还有其他问题，如异方差。如果有人感兴趣，我还有另外一篇文章。</p><div class="md me gq gs mf mg"><a rel="noopener follow" target="_blank" href="/heteroscedasticity-in-regression-model-21d9f5a93e59"><div class="mh ab fp"><div class="mi ab mj cl cj mk"><h2 class="bd iv gz z fq ml fs ft mm fv fx it bi translated">回归模型中的异方差性</h2><div class="mn l"><h3 class="bd b gz z fq ml fs ft mm fv fx dk translated">使用统计模型检查异方差性</h3></div><div class="mo l"><p class="bd b dl z fq ml fs ft mm fv fx dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu kt mg"/></div></div></a></div><p id="b3bf" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">先说多项式和样条回归的利弊。多项式回归是非线性曲线拟合的基本分析方法。其背后的数学比简单的线性回归更复杂，但比样条回归更简单。多项式回归受到<a class="ae kz" href="https://en.wikipedia.org/wiki/Runge%27s_phenomenon" rel="noopener ugc nofollow" target="_blank">龙格效应</a>的影响，即数据集的端点与模型不同步，当应用回归时，结果变化很大。当在模型中使用高阶多项式时，这种现象尤其明显。多项式回归的一个更复杂的版本是样条回归。这种方法首先识别中间节点，然后使用数据点找到节点之间的最佳拟合。当使用3节时，这些点通常是第25、50和75个百分点。读者可以阅读下面的文章，以获得更多关于样条回归的见解。</p><div class="md me gq gs mf mg"><a rel="noopener follow" target="_blank" href="/simply-spline-regression-polynomials-between-knots-3d007523ad99"><div class="mh ab fp"><div class="mi ab mj cl cj mk"><h2 class="bd iv gz z fq ml fs ft mm fv fx it bi translated">简单样条回归:节点间的多项式</h2><div class="mn l"><h3 class="bd b gz z fq ml fs ft mm fv fx dk translated">使用python的statsmodels库</h3></div><div class="mo l"><p class="bd b dl z fq ml fs ft mm fv fx dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="mv l mr ms mt mp mu kt mg"/></div></div></a></div><p id="8fc1" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">一种更灵活的建模技术是广义加性模型，它可以在不指定节点位置的情况下部署。维基百科对它的定义如下:</p><blockquote class="mw"><p id="614a" class="mx my iu bd mz na nb nc nd ne nf lz dk translated">一种广义线性模型，其中线性响应变量线性依赖于某些预测变量的未知光滑函数，人们的兴趣集中在对这些光滑函数的推断上。</p></blockquote><figure class="nh ni nj nk nl ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ng"><img src="../Images/5d4f056612a5d71bfd1e61749049a1c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DVmLgTorz7_l-vlNEGKWog.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">来源:<a class="ae kz" href="https://en.wikipedia.org/wiki/Generalized_additive_model" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="a3a3" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">简而言之，这里的结果不是加权和，而是一些任意函数的和。在本文中，我将展示使用多项式、样条和GAM拟合非线性关系的区别。</p><blockquote class="la lb lc"><p id="eaa1" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">数据集</strong></p></blockquote><p id="1697" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">出于用python实现的目的，我将利用来自Kaggle的<a class="ae kz" href="https://www.kaggle.com/mathchi/study-polynomial-regression/data" rel="noopener ugc nofollow" target="_blank">鱼数据集</a>。给定变量之间存在非线性关系。数据集可供公众使用，许可在这里描述<a class="ae kz" href="https://www.kaggle.com/mathchi/study-polynomial-regression/notebook" rel="noopener ugc nofollow" target="_blank"/>(Apache 2.0)。</p><blockquote class="la lb lc"><p id="8975" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">使用pyGAM实现</strong></p></blockquote><p id="0fa8" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">首先，需要安装pyGAM包。鱼的数据提供了鱼的重量和宽度之间的下列相关性。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nm"><img src="../Images/c1c4eb21eb18589664c56e5fe231b874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*kmWQeZsG8Av1Mhcw91ELlQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><p id="fab8" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我有兴趣使用多项式拟合、样条拟合和GAM来拟合这种非线性依赖关系。</p><blockquote class="la lb lc"><p id="0add" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">多项式回归</strong></p></blockquote><p id="be66" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">感兴趣的变量之间的关系非常明显。鱼的宽度越大，鱼的重量就越重。数据可以线性拟合，但标准误差会很高。此外，由于数据集的性质，还会存在异方差。这似乎是一种锥形关系，数据的变化最初非常紧密，但后来，偏差变得很大。让我们用二阶多项式来拟合这个模型。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj np"><img src="../Images/63cace2db185f48ca8d5f9e7f90c1ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQowBz59CdAwC0j_wpc5MA.png"/></div></div></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nm"><img src="../Images/3c022d585cc5bd45c6b8811c2fe60c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*ltJA19ksI1HvM6D1K1kwHA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">二阶多项式拟合。作者图片</p></figure><p id="41ca" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">看起来曲线很适合给定的数据。这种趋势似乎在增加，无论宽度值有多高，由于二阶相关性，重量也会高很多。但是，情况总是这样吗？一条宽9厘米的鱼的重量是~1700克吗？我们能做出更好的模型吗？</p><blockquote class="la lb lc"><p id="8566" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">样条回归</strong></p></blockquote><p id="5840" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">让我们使用3个自由度和节点之间的二阶多项式在同一数据集上实现样条回归。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nq"><img src="../Images/a41ebb760975da4733b4cc5f293d7386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCsA1XmJkeb3QVBUBVBD0A.png"/></div></div></figure><p id="7f2b" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">与多项式回归相比，拟合稍好，因为R平方值增加了。下图显示的拟合与上面的多项式模型非常相似。这种配件在较高的一侧具有某种展平效果。在较低的一边，它表现不好，因为趋势是向上的。如果鱼的宽度小于1厘米，它的重量不能高于1厘米宽的鱼。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/8a88ec747558b7aee5cc11bcf11917e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*GVejKZU1FlQ7Gvc7PUci3A.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">样条回归。作者图片</p></figure><blockquote class="la lb lc"><p id="75cc" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">广义可加模型</strong></p></blockquote><p id="6c52" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在这种方法中，我们不需要定义结。这种决策具有灵活性，多项式字符串会自动绑定在一起。这可以使用pyGAM包来实现。当使用线性拟合时，我们得到以下结果。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ns"><img src="../Images/ae38eb32c06ec09aeb01457e3107328f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*RJQs9KhDEU_af42pzqo3zA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">线性游戏</p></figure><p id="4708" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">该模型不会像多项式模型那样高估较高的数据点。让我们用20条样条曲线进行多项式拟合。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nn no l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nt"><img src="../Images/c817c3c9b8099e6cc6e0b7be55238630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*qoIktzPLbUBxT7tKjCCRjA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">用20条样条曲线GAM。作者图片</p></figure><p id="da3f" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">在上述所有方法中，最后一个数字最符合数据。例如，如果我们想知道一条1.7厘米宽的鱼的重量，预测会更准确。对于使用GAM的多项式拟合，标准误差将更小。</p><blockquote class="la lb lc"><p id="e70e" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">结论</strong></p></blockquote><p id="069e" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated">我们讨论了多项式和样条回归，并与GAM进行了比较。使用GAM时，无需手动指定结。这为拟合提供了更大的灵活性，因为它会自动用给定数量的样条拟合多项式。这基本上是过程的自动化，其中不需要选择中间点作为结。在实现回归模型时必须足够小心，应该比较不同的方法并调整超参数以获得最佳结果。</p><p id="667d" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://mdsohelmahmood.github.io/2021/11/17/GAM.html" rel="noopener ugc nofollow" target="_blank"> Github页面链接</a></p><blockquote class="la lb lc"><p id="a283" class="ld le lf lg b lh li jv lj lk ll jy lm ln lo lp lq lr ls lt lu lv lw lx ly lz in bi translated"><strong class="lg iv">参考:</strong></p></blockquote><p id="e625" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://pygam.readthedocs.io/en/latest/notebooks/tour_of_pygam.html" rel="noopener ugc nofollow" target="_blank"> pyGAM文档</a></p><p id="ce31" class="pw-post-body-paragraph ld le iu lg b lh li jv lj lk ll jy lm ma lo lp lq mb ls lt lu mc lw lx ly lz in bi translated"><a class="ae kz" href="https://www.kaggle.com/mathchi/study-polynomial-regression/data" rel="noopener ugc nofollow" target="_blank"> Fish数据集</a></p></div></div>    
</body>
</html>