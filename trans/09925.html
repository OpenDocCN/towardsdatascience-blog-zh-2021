<html>
<head>
<title>How to build a Machine Learning (ML) based Predictive System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立基于机器学习的预测系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-ml-based-predictive-system-to-predict-the-satisfaction-level-of-airlines-f0780dbdbc87?source=collection_archive---------18-----------------------#2021-09-18">https://towardsdatascience.com/machine-learning-ml-based-predictive-system-to-predict-the-satisfaction-level-of-airlines-f0780dbdbc87?source=collection_archive---------18-----------------------#2021-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2b97" class="pw-subtitle-paragraph jo ip iq bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">开发预测模型的实用数据科学指南，该模型将客户分为两类满意度</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/103dfe2dd85caf823fd74da21d03db5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EnaP2yeq4u1odmmBsS5urg.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">奥斯汀·迪斯特尔在<a class="ae kw" href="https://unsplash.com/photos/wD1LRb9OeEo" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的图片</p></figure><h1 id="8824" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">简介</strong></h1><p id="4a69" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">我们都知道客户满意度是提升公司业绩的关键，但是组织仍然努力利用不断增长的数据可用性来满足客户。在这篇文章中，我说明了如何使用机器学习和数据科学技术来评估和评价客户满意度。我将介绍开发客户驱动的预测模型的必要步骤，从<em class="ml">问题框架</em>开始，到<em class="ml">数据探索</em> <em class="ml">分析</em>，<em class="ml">数据转换</em>，<em class="ml"> ML培训，以及建议</em>。</p><p id="6177" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">该数据集是从标题为“航空乘客满意度”的<a class="ae kw" href="https://www.kaggle.com/teejmahal20/airline-passenger-satisfaction" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中提取的。</p><h1 id="3c7c" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">问题识别</strong></h1><p id="4cb4" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">我首先阐明项目中要解决的业务问题。事实上，航空业一直面临着改变客户偏好的技术颠覆。如今，客户越来越希望享受安全的体验，为他们提供多样化而个性化的产品(普华永道，2021)。因此，对组织来说，区分满意和不满意的个人，并确定决定顾客满意度的特征是至关重要的。</p><h1 id="28b3" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated">定义目标</h1><p id="09ab" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">通过这个项目，我旨在展示如何:<br/>、探索和可视化数据、<br/>、为机器学习准备数据、<br/>、训练和微调预测算法、<br/>、提取重要特征、<br/>、推荐创新的数据驱动技术。</p><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="6445" class="mw ky iq ms b gy mx my l mz na">#import packages and modules</span><span id="1646" class="mw ky iq ms b gy nb my l mz na">#data manipulation <br/>import pandas as pd<br/>import os</span><span id="c123" class="mw ky iq ms b gy nb my l mz na">#data visualisation <br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="93bd" class="mw ky iq ms b gy nb my l mz na">#machine learning <br/>from sklearn.model_selection import train_test_split<br/>from sklearn.preprocessing import LabelEncoder<br/>from sklearn.pipeline import Pipeline<br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.compose import ColumnTransformer<br/>from sklearn.preprocessing import OneHotEncoder<br/>from sklearn.impute import SimpleImputer<br/>from sklearn.metrics import classification_report <br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.svm import SVC<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.model_selection import RandomizedSearchCV</span></pre><h1 id="4091" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">数据清理和转换</strong></h1><p id="f29e" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">第二个任务是执行数据争论。幸运的是，数据集不需要大量清理。但是，我必须将一些变量的数据类型转换成分类，删除不必要的列，并检测丢失的值，这些变量包括客户类型、类别、满意度、性别和旅行类型。此外，我创建了两个新变量来支持稍后阶段的数据分析；下面列出了这两个变量:<br/> - <strong class="lr ir"> over_all rating: </strong>计算所有数字变量的平均值，从顾客反馈中取5分<br/> - <strong class="lr ir"> total_delay: </strong>，合计到达和离开的延误时间。</p><p id="c7fd" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">数据清理部分的代码如下所示。</p><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="d167" class="mw ky iq ms b gy mx my l mz na">#Load the data<br/>def load_data(data_path,filename):<br/>    data_path = os.path.join(data_path, filename)<br/>    return pd.read_csv(data_path)</span><span id="d377" class="mw ky iq ms b gy nb my l mz na">Airlines = load_data('/project/',"Airlines.csv") #change the path</span><span id="5af6" class="mw ky iq ms b gy nb my l mz na">#inspect the data <br/>Airlines.head()</span><span id="940c" class="mw ky iq ms b gy nb my l mz na">#get the data info<br/>Airlines.info()</span><span id="c251" class="mw ky iq ms b gy nb my l mz na">#check the shape of the data-frame<br/>Airlines.shape </span><span id="f9bc" class="mw ky iq ms b gy nb my l mz na">#check for missing values<br/>Airlines.isna()</span><span id="7cf9" class="mw ky iq ms b gy nb my l mz na">#check for duplicated values<br/>Airlines.duplicated() </span><span id="9b15" class="mw ky iq ms b gy nb my l mz na">#create a data cleaning function<br/>def data_cleaning(<br/>    Airlines:pd.DataFrame<br/>              )-&gt;pd.DataFrame:<br/>    Airlines['Gender'] = Airlines['Gender'].astype('category')<br/>    Airlines['Type of Travel'] = Airlines['Type of Travel'].astype('category')<br/>    Airlines['Customer Type'] = Airlines['Customer Type'].astype('category')<br/>    Airlines['Class'] = Airlines['Class'].astype('category')<br/>    Airlines['satisfaction'] = Airlines['satisfaction'].astype('category')<br/>    Airlines.drop("Unnamed: 0", axis =1, inplace= True)<br/>    return Airlines.info()</span><span id="8d1e" class="mw ky iq ms b gy nb my l mz na">#call the cleaning function <br/>data_cleaning(Airlines)</span><span id="a7c2" class="mw ky iq ms b gy nb my l mz na">#create a new variable : over_all rating <br/>Airlines['overall_rating'] = round((Airlines['Inflight wifi service']+ Airlines['Departure/Arrival time convenient'] +<br/>Airlines['Ease of Online booking'] + Airlines['Gate location'] + Airlines['Food and drink']+ Airlines['Online boarding'] + <br/>Airlines['Seat comfort'] + Airlines['Inflight entertainment'] + Airlines['On-board service'] + Airlines['Leg room service'] + <br/>Airlines['Baggage handling'] + Airlines['Checkin service'] + Airlines['Inflight service'] + Airlines['Cleanliness'])/14,1)</span><span id="f08b" class="mw ky iq ms b gy nb my l mz na">#create a new variable : total delay <br/>Airlines['Total_Delay'] = (Airlines['Departure Delay in Minutes']+ <br/>                                    Airlines['Arrival Delay in Minutes'])</span><span id="9fa6" class="mw ky iq ms b gy nb my l mz na">#inspect the data frame again to check the new columns<br/>Airlines.head()</span></pre><h1 id="fae3" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="a00c" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">在这一节中，我将探索数据集并展示数据可视化，以查明变量之间的关系。</p><blockquote class="nc nd ne"><p id="730c" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">我检查汇总统计数据，并为数据集的数值变量创建直方图，如下面的代码所示。</p></blockquote><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="76a8" class="mw ky iq ms b gy mx my l mz na">numeric_variables = list(Airlines.select_dtypes(include=['int64', 'float64'])) #select the numeric variables</span><span id="57d4" class="mw ky iq ms b gy nb my l mz na">Airlines[numeric_variables].describe().apply(lambda x:round(x,2)).T #apply describe method</span><span id="2b80" class="mw ky iq ms b gy nb my l mz na">histograms = Airlines[numeric_variables].hist(bins =10, xlabelsize=10, ylabelsize=10, grid=False, sharey= True, figsize = (15,15)) #create the histograms</span></pre><blockquote class="nc nd ne"><p id="79f1" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">然后我研究了满意度和阶级类别之间的关系。</p></blockquote><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="0514" class="mw ky iq ms b gy mx my l mz na"><strong class="ms ir">#First Visual: Satisfaction and Class Category </strong></span><span id="7971" class="mw ky iq ms b gy nb my l mz na">by_cat_class = Airlines.groupby(['Class', 'satisfaction']) </span><span id="a8f9" class="mw ky iq ms b gy nb my l mz na">by_cat_class.size() #get the size of the dataframe <br/>ax = by_cat_class.size().unstack().plot(kind='barh', color = ['aqua', 'grey']) #unstack and plot </span><span id="b7a0" class="mw ky iq ms b gy nb my l mz na">ax.set_title('Travel Class and Satisfaction', size =14) #title <br/>plt.xticks(fontsize=12)<br/>plt.yticks(fontsize=12)<br/>ax.set_xlabel('Number of Customers', fontsize = 14) #set the x_label <br/>ax.set_ylabel('Class Category', fontsize = 14); #set the y_label</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ffa3d126725837a81bfa9d0a16d4613a.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*talND9LLzioWFDflw8WQHA.png"/></div></figure><p id="87e7" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">该图显示，商业客户最满意，而生态客户最不满意。最重要的是，80%的eco客户都不满意。这表明该服务的提供并不符合不同阶层的偏好，而且只对商务阶层给予了更多的关注。</p><blockquote class="nc nd ne"><p id="f0f4" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">我还调查了总延迟时间、总体评分和满意度之间的关系。</p></blockquote><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="ea80" class="mw ky iq ms b gy mx my l mz na"><strong class="ms ir">#Second Visual: Total Delay, Overall Rating, and Satisfaction </strong></span><span id="421e" class="mw ky iq ms b gy nb my l mz na">plt.figure(figsize = (8,6)) #figure size <br/>sns.set(rc= {"font.size":14, "axes.titlesize":14, "axes.labelsize":14}) </span><span id="92cc" class="mw ky iq ms b gy nb my l mz na">m = sns.relplot(x="overall_rating", y="Total_Delay",hue ='satisfaction', data=Airlines); #define graph variables </span><span id="8a4f" class="mw ky iq ms b gy nb my l mz na">plt.title('Total Delay, Overall rating, and Satisfaction') <br/>plt.xlabel('Total_Delay') # set x_label<br/>plt.ylabel('Overall_Rating'); #set y_label</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/401ba607894cd636388fe9613ff8570a.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*lark3S36ANgrSMw82u03Og.png"/></div></figure><p id="9eab" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">很明显，总延迟会影响满意度，因此延迟时间越短，平均评分越高，客户越满意。</p><blockquote class="nc nd ne"><p id="2321" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">我还会检查年龄是否会影响顾客的满意度。</p></blockquote><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="5095" class="mw ky iq ms b gy mx my l mz na"><strong class="ms ir">#Third Visual: Age and Satisfaction</strong></span><span id="1fea" class="mw ky iq ms b gy nb my l mz na">#Discretize the overall_ratings into buckets<br/>overall = Airlines['Age']<br/>labels = pd.cut(overall, [0, 18, 35, 50, 65 , 80])<br/>grouped = Airlines.groupby(['satisfaction', labels]) <br/>grouped.size().unstack(0) #unstack</span><span id="de64" class="mw ky iq ms b gy nb my l mz na">#sum group amounts<br/>bucket_sums = grouped.overall_rating.sum().unstack(0)</span><span id="7d98" class="mw ky iq ms b gy nb my l mz na">#normalize within buckets <br/>normed_sums = bucket_sums.div(bucket_sums.sum(axis=1), axis=0)</span><span id="b96b" class="mw ky iq ms b gy nb my l mz na">#plot the discretized ratings buckets and satisfaction<br/>plot = normed_sums.plot(kind='barh', stacked=True, color= ['aqua','cadetblue'] )</span><span id="e857" class="mw ky iq ms b gy nb my l mz na">plot.legend(loc="upper center",ncol=2,borderaxespad=0.,bbox_to_anchor=(1.05, 1))<br/>plot.set_title('Satisfaction and Age', size =14)<br/>plot.set_xlabel('Proportion of Customers', fontsize = 14)<br/>plot.set_ylabel('Age Bucket', fontsize =14);</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/2fa0869e8ecc5a3afc97a56e36fe1964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*3adlb-nC2bM78Kgw-gV2OA.png"/></div></figure><p id="74b8" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">图表显示年龄在18岁以下和65岁以上的顾客满意度最低。航空公司应该考虑为成年人和老顾客提供个性化服务。</p><blockquote class="nc nd ne"><p id="c6f1" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">根据探索性分析，我们可以推断旅行等级、总延误时间和年龄正在影响顾客的满意度。</p></blockquote><h1 id="6677" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">数据准备</strong></h1><p id="8b1f" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">在这个阶段，我为ML模型准备数据。以下是应该遵循的总结步骤:<br/>。分别以80/20的比率将数据分割为训练集和测试集<br/>。将因变量“满意度”编码为{0:'不满意'，1:'满意' } <br/>。建立完整的管道，以估算和标准化数据，并对分类变量进行编码。</p><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="25fe" class="mw ky iq ms b gy mx my l mz na">#train_test split<br/>Airlines_1 = Airlines.copy() #make a copy of the data<br/>train_set, test_set = train_test_split(Airlines_1, test_size=0.2, random_state=42) #split the training (0.8) and test (0.2)<br/>test_set.head() #inspect the test data</span><span id="4908" class="mw ky iq ms b gy nb my l mz na">#drop the dependent variable from the train_set <br/>x_train = train_set.drop("satisfaction", axis=1) #train set <br/>y_train= train_set['satisfaction'] #train dependent variable<br/>x_test = test_set.drop("satisfaction", axis=1) #test set <br/>y_test = test_set['satisfaction'] #test dependent variable</span><span id="edbe" class="mw ky iq ms b gy nb my l mz na">#define numeric and categorical variables<br/>numeric_variables = list(Airlines.select_dtypes(include=['int64', 'float64']))<br/>categorical_variables = ['Gender', 'Customer Type', 'Type of Travel', 'Class']</span><span id="9ea6" class="mw ky iq ms b gy nb my l mz na">#encode the dependent variable: satisfaction<br/>labelencoder_y = LabelEncoder()<br/>y_train = labelencoder_y.fit_transform(y_train)</span><span id="d8ac" class="mw ky iq ms b gy nb my l mz na">#build a pipeline for numeric and categorical data</span><span id="d301" class="mw ky iq ms b gy nb my l mz na">num_pipeline = Pipeline([('imputer', SimpleImputer(strategy="median")),<br/>('std_scaler', StandardScaler()),]) #numeric pipeline</span><span id="2760" class="mw ky iq ms b gy nb my l mz na">full_pipeline = ColumnTransformer([<br/>("num", num_pipeline, numeric_variables  ),<br/>("cat", OneHotEncoder(),categorical_variables),]) #full pipeline</span><span id="ca4b" class="mw ky iq ms b gy nb my l mz na">#apply the pipeline<br/>x_train = full_pipeline.fit_transform(x_train) </span><span id="d59c" class="mw ky iq ms b gy nb my l mz na">#Apply data transformation on test_set<br/>test_y = labelencoder_y.fit_transform(y_test) <br/>x_test = full_pipeline.fit_transform(x_test) </span><span id="97a2" class="mw ky iq ms b gy nb my l mz na">x_test #inspect</span></pre><h1 id="d166" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">预测建模和微调</strong></h1><p id="f72c" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">现在，在为训练准备好数据之后，我们应该选择ML模型。由于预测任务是二元分类，我将训练不同的监督ML算法，即逻辑回归、支持向量机和随机森林，来预测客户的满意度。我还会通过检查每个型号的分类报告来评估性能。</p><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="e428" class="mw ky iq ms b gy mx my l mz na">#Create a function to train the models<br/>def training_fnt(model, x_train, y_train):<br/>    model.fit(x_train , y_train ) #fit the model <br/>    y_predict = model.predict(x_train) #predict<br/>    print('Classification report: \n', classification_report(y_train ,y_predict)) #classification report </span><span id="b7c2" class="mw ky iq ms b gy nb my l mz na">#initiate the models <br/>log_model = LogisticRegression(max_iter=200, random_state=42)<br/>svm_model = SVC(gamma="auto", random_state=42) <br/>rf_model = RandomForestClassifier(random_state=42) </span><span id="3e60" class="mw ky iq ms b gy nb my l mz na">#call the function on each model separately <br/>training_fnt(log_model)<br/>training_fnt(svm_model)<br/>training_fnt(rf_model)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/018c6b6022a698877cafbcada4d94bc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*UZaGa3lpenSiQcQ6GWPwdA.png"/></div></figure><blockquote class="nc nd ne"><p id="0df0" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">根据分类报告，随机森林具有最高的准确性分数，因此，可以使用随机搜索将其列入微调的候选名单。</p></blockquote><p id="8217" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">然后，我使用随机搜索对随机森林进行微调。</p><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="36a8" class="mw ky iq ms b gy mx my l mz na">#use random search to fine-tune RandomForestClassifier</span><span id="0bba" class="mw ky iq ms b gy nb my l mz na">#define the model<br/>rnd_clf = RandomForestClassifier(random_state=42)'</span><span id="6632" class="mw ky iq ms b gy nb my l mz na">#define parameters <br/>search = [<br/>    {'n_estimators': [3, 10, 30], 'max_features': [2, 4, 6, 8], 'bootstrap': [False, True], 'max_depth': [2, 3, 4,8] }]</span><span id="06fa" class="mw ky iq ms b gy nb my l mz na">#set up the search search <br/>random_search  = RandomizedSearchCV(rnd_clf , search , cv=3,<br/>                           scoring='f1', return_train_score=True)<br/>#fit the search<br/>random_result_RF = random_search.fit(x_train , y_train)</span><span id="3b48" class="mw ky iq ms b gy nb my l mz na">#summarize results<br/>print("Best: %f using %s" % (random_result_RF.best_score_,random_result_RF.best_params_))</span></pre><p id="b7cb" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">随机搜索的结果是:</p><blockquote class="nc nd ne"><p id="c112" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">最佳:0.907877，使用{'n_estimators': 10，' max_features': 2，' max_depth': 8，' bootstrap': False}。</p></blockquote><p id="8ad9" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">建立这些参数后，我将最终模型拟合到测试集上，以评估在看不见的数据点上的性能。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nm"><img src="../Images/b91116cd58f050027354e8538c733ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQ7w6XD0n0-iPp1MAenGDw.png"/></div></div></figure><blockquote class="nc nd ne"><p id="5e2a" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">最终的模型在测试集上达到了93%的平均准确率。</p></blockquote><h1 id="ffe3" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated">特征抽出</h1><p id="a9c4" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">我还对从随机森林分类器中提取重要特征感兴趣。这些变量是客户感到满意时最看重的维度。</p><pre class="kh ki kj kk gt mr ms mt mu aw mv bi"><span id="55d8" class="mw ky iq ms b gy mx my l mz na">#extract the important features from the final model</span><span id="55ba" class="mw ky iq ms b gy nb my l mz na">new_rf_clf = final_model<br/>new_rf_clf.fit(x_train ,y_train) #fit the model<br/>feature_importances = new_rf_clf.feature_importances_ <br/>attributes = numeric_variables + categorical_variables <br/>feat_importances = sorted(zip(feature_importances, attributes), reverse=True) #create a sorted tuple </span><span id="1c41" class="mw ky iq ms b gy nb my l mz na">#visualize the feature importance of Random Forest<br/>df_rf = pd.DataFrame(data = feat_importances) #create a dataframe <br/>df_rf.columns = ['importance', 'feature'] #rename the columns<br/>df_rf.set_index('feature', inplace=True)#set the index <br/>fig, ax = plt.subplots(figsize=(10,6))<br/>df_rf.plot(ax=ax, kind='barh', color ='aqua') #define the plot </span><span id="767f" class="mw ky iq ms b gy nb my l mz na">plt.xticks(fontsize=13)<br/>plt.yticks(fontsize=13)<br/>ax.set_title('Important Features of the Random Forest Model', fontweight="bold", size =16) #set title <br/>ax.set_xlabel('Relative Importance', fontsize = 13)<br/>ax.set_ylabel('Feature', fontsize = 13);</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nn"><img src="../Images/f8593b07faadb90c68f824d329d598de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5ek5GW_1M4dIhMt4fmKUw.png"/></div></div></figure><blockquote class="nc nd ne"><p id="3205" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">Random Forest的重要功能包括:在线登机、Wi-Fi服务、在线预订和机上娱乐。</p></blockquote><h1 id="7167" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">结论</strong></h1><p id="0236" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">根据调查结果，我们得出结论，环保客户满意度最低，年龄、登机、在线预订、娱乐和Wifi服务是决定客户满意度的最明显特征。总的来说，我们的预测算法有93%的预测能力来对客户进行分类，并支持航空公司监控和评估服务绩效。</p><h1 id="d6e7" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated">建议和后续步骤</h1><p id="1d3b" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">最后，我可以推荐航空公司组织实施以下技术:</p><p id="1f0a" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">1-根据年龄类别为顾客设计个性化套餐，特别针对满意度最低的成年人和老年人，</p><p id="1e36" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">2-改善飞行中的WiFi接入和娱乐，</p><p id="6d3a" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">3-为浏览其网站和社交媒体平台的客户实施在线预订协助服务。</p><p id="4876" class="pw-post-body-paragraph lp lq iq lr b ls mm js lu lv mn jv lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">接下来的步骤应该集中在生产阶段，通过该阶段，可以使用新客户的数据部署和测试预测模型。</p><blockquote class="nc nd ne"><p id="8790" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">我希望你喜欢这篇文章，现在你有能力开发你的预测模型。</p><p id="2e40" class="lp lq ml lr b ls mm js lu lv mn jv lx nf mo ma mb ng mp me mf nh mq mi mj mk ij bi translated">敬请关注更多关于数据科学的有趣阅读和知识分享！</p></blockquote><h1 id="fe2c" class="kx ky iq bd kz la lb lc ld le lf lg lh jx li jy lj ka lk kb ll kd lm ke ln lo bi translated"><strong class="ak">参考文献:</strong></h1><p id="7621" class="pw-post-body-paragraph lp lq iq lr b ls lt js lu lv lw jv lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">[1]普华永道，<a class="ae kw" href="https://www.pwc.com/us/en/industries/transportation-logistics/tailwinds-airline-industry-trends.html" rel="noopener ugc nofollow" target="_blank">航空业的未来</a> (2018)，顺风:2018年航空业趋势</p></div></div>    
</body>
</html>